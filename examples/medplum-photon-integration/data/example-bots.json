{
  "resourceType": "Bundle",
  "type": "transaction",
  "entry": [
    {
      "fullUrl": "urn:uuid:12d816f9-021e-4c25-aa9f-8a9e8271fc39",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/typescript",
        "data": "aW1wb3J0IHsgQm90RXZlbnQsIGZvcm1hdERhdGUsIGdldFJlZmVyZW5jZVN0cmluZywgTWVkcGx1bUNsaWVudCwgUGF0Y2hPcGVyYXRpb24gfSBmcm9tICdAbWVkcGx1bS9jb3JlJzsKaW1wb3J0IHsgQWxsZXJneUludG9sZXJhbmNlLCBDb250YWN0UG9pbnQsIElkZW50aWZpZXIsIFBhdGllbnQsIFByYWN0aXRpb25lciB9IGZyb20gJ0BtZWRwbHVtL2ZoaXJ0eXBlcyc7CmltcG9ydCBmZXRjaCBmcm9tICdub2RlLWZldGNoJzsKCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKG1lZHBsdW06IE1lZHBsdW1DbGllbnQsIGV2ZW50OiBCb3RFdmVudDxQYXRpZW50Pik6IFByb21pc2U8dm9pZD4gewogIGNvbnN0IHBhdGllbnQgPSBldmVudC5pbnB1dDsKCiAgY29uc3QgUEhPVE9OX0tFWSA9IGV2ZW50LnNlY3JldHNbJ1BIT1RPTl9BUElfS0VZJ10/LnZhbHVlU3RyaW5nIGFzIHN0cmluZzsKCiAgY29uc3QgYWxsZXJnaWVzID0gYXdhaXQgbWVkcGx1bS5zZWFyY2hSZXNvdXJjZXMoJ0FsbGVyZ3lJbnRvbGVyYW5jZScsIHsKICAgIHBhdGllbnQ6IGdldFJlZmVyZW5jZVN0cmluZyhwYXRpZW50KSwKICB9KTsKCiAgY29uc3QgcGhvdG9uUXVlcnkgPSBgCiAgICAgIG11dGF0aW9uIGNyZWF0ZVBhdGllbnQoCiAgICAgICAgJGV4dGVybmFsSWQ6IElECiAgICAgICAgJG5hbWU6IE5hbWVJbnB1dCEKICAgICAgICAkZGF0ZU9mQmlydGg6IEFXU0RhdGUhCiAgICAgICAgJHNleDogU2V4VHlwZSEKICAgICAgICAkcGhvbmU6IEFXU1Bob25lIQogICAgICAgICRhbGxlcmdpZXM6IFtBbGxlcmdlbklucHV0XQogICAgICAgICRtZWRpY2F0aW9uSGlzdG9yeTogW01lZGljYXRpb25JbnB1dF0KICAgICAgKSB7CiAgICAgICAgY3JlYXRlUGF0aWVudCgKICAgICAgICAgIGV4dGVybmFsSWQ6ICRleHRlcm5hbElkCiAgICAgICAgICBuYW1lOiAkbmFtZQogICAgICAgICAgZGF0ZU9mQmlydGg6ICRkYXRlT2ZCaXJ0aAogICAgICAgICAgc2V4OiAkc2V4CiAgICAgICAgICBwaG9uZTogJHBob25lCiAgICAgICAgICBhbGxlcmdpZXM6ICRhbGxlcmdpZXMKICAgICAgICAgIG1lZGljYXRpb25IaXN0b3J5OiAkbWVkaWNhdGlvbkhpc3RvcnkKICAgICAgICApCiAgICAgIH0KICAgIGA7CgogIGNvbnN0IHZhcmlhYmxlcyA9IHsKICAgIGV4dGVybmFsSWQ6IHBhdGllbnQuaWQsCiAgICBuYW1lOiB7CiAgICAgIGZpcnN0OiBwYXRpZW50Lm5hbWU/LlswXS5naXZlbj8uWzBdLAogICAgICBsYXN0OiBwYXRpZW50Lm5hbWU/LlswXS5mYW1pbHksCiAgICB9LAogICAgZGF0ZU9mQmlydGg6IGZvcm1hdERhdGUocGF0aWVudC5iaXJ0aERhdGUpLAogICAgc2V4OiBnZXRTZXhUeXBlKHBhdGllbnQuZ2VuZGVyKSwKICAgIGdlbmRlcjogcGF0aWVudC5nZW5kZXIsCiAgICBlbWFpbDogZ2V0VGVsZWNvbSgnZW1haWwnLCBwYXRpZW50KSwKICAgIHBob25lOiBnZXRUZWxlY29tKCdwaG9uZScsIHBhdGllbnQpLAogICAgYWxsZXJnaWVzOiBmb3JtYXRQYXRpZW50QWxsZXJnaWVzKGFsbGVyZ2llcyksCiAgfTsKCiAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHsKICAgIHF1ZXJ5OiBwaG90b25RdWVyeSwKICAgIHZhcmlhYmxlcywKICB9KTsKCiAgY29uc3QgcmVzdWx0OiBhbnkgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkubmV1dHJvbi5oZWFsdGgvZ3JhcGhxbCcsIHsKICAgIG1ldGhvZDogJ1BPU1QnLAogICAgYm9keTogZGF0YSwKICAgIGhlYWRlcnM6IHsKICAgICAgYXV0aG9yaXphdGlvbjogUEhPVE9OX0tFWSwKICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgIH0sCiAgfSkKICAgIC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpKQogICAgLmNhdGNoKCgpID0+IGNvbnNvbGUubG9nKCdFcnJvciBzeW5jaW5nIHBhdGllbnQnKSk7CgogIGNvbnNvbGUubG9nKHJlc3VsdCk7CiAgYXdhaXQgdXBkYXRlUGF0aWVudChwYXRpZW50LCByZXN1bHQsIG1lZHBsdW0pOwp9Cgphc3luYyBmdW5jdGlvbiB1cGRhdGVQYXRpZW50KHBhdGllbnQ6IFBhdGllbnQsIHJlc3BvbnNlOiBhbnksIG1lZHBsdW06IE1lZHBsdW1DbGllbnQpOiBQcm9taXNlPHZvaWQ+IHsKICBjb25zdCBwYXRpZW50RGF0YSA9IHJlc3BvbnNlLmRhdGEuY3JlYXRlUGF0aWVudDsKICBjb25zdCBwaG90b25JZGVudGlmaWVyOiBJZGVudGlmaWVyID0gewogICAgc3lzdGVtOiAnaHR0cDovL3Bob3Rvbi5oZWFsdGgnLAogICAgdmFsdWU6IHBhdGllbnREYXRhLmlkLAogIH07CgogIGNvbnN0IGlkZW50aWZpZXJzOiBJZGVudGlmaWVyW10gPSBwYXRpZW50LmlkZW50aWZpZXIgPz8gW107CiAgaWRlbnRpZmllcnMucHVzaChwaG90b25JZGVudGlmaWVyKTsKCiAgY29uc3Qgb3AgPSBwYXRpZW50LmlkZW50aWZpZXIgPyAncmVwbGFjZScgOiAnYWRkJzsKCiAgY29uc3QgcGF0aWVudElkID0gcGF0aWVudC5pZCBhcyBzdHJpbmc7CiAgY29uc3Qgb3BzOiBQYXRjaE9wZXJhdGlvbltdID0gWwogICAgLy8gVGVzdCB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9ucwogICAgeyBvcDogJ3Rlc3QnLCBwYXRoOiAnL21ldGEvdmVyc2lvbklkJywgdmFsdWU6IHBhdGllbnQubWV0YT8udmVyc2lvbklkIH0sCiAgICB7IG9wLCBwYXRoOiAnL2lkZW50aWZpZXInLCB2YWx1ZTogaWRlbnRpZmllcnMgfSwKICBdOwoKICB0cnkgewogICAgYXdhaXQgbWVkcGx1bS5wYXRjaFJlc291cmNlKCdQYXRpZW50JywgcGF0aWVudElkLCBvcHMpOwogICAgY29uc29sZS5sb2coJ1N1Y2Nlc3MnKTsKICB9IGNhdGNoIChlcnIpIHsKICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICB9Cn0KCmZ1bmN0aW9uIGdldFNleFR5cGUoc2V4OiBQYXRpZW50WydnZW5kZXInXSk6ICdNQUxFJyB8ICdGRU1BTEUnIHwgJ1VOS05PV04nIHsKICBpZiAoc2V4ID09PSAnb3RoZXInIHx8IHNleCA9PT0gJ3Vua25vd24nKSB7CiAgICByZXR1cm4gJ1VOS05PV04nOwogIH0KICBpZiAoc2V4ID09PSAnZmVtYWxlJykgewogICAgcmV0dXJuICdGRU1BTEUnOwogIH0KICByZXR1cm4gJ01BTEUnOwp9CgpmdW5jdGlvbiBmb3JtYXRQYXRpZW50QWxsZXJnaWVzKAogIGFsbGVyZ2llczogQWxsZXJneUludG9sZXJhbmNlW10KKTogeyBvbnNldD86IHN0cmluZzsgYWxsZXJnZW46IHsgaWQ/OiBzdHJpbmc7IG5hbWU/OiBzdHJpbmc7IHJ4Y3VpPzogc3RyaW5nIH0gfVtdIHsKICBjb25zdCBwYXRpZW50QWxsZXJnaWVzID0gW107CiAgZm9yIChjb25zdCBhbGxlcmd5IG9mIGFsbGVyZ2llcykgewogICAgY29uc3Qgb25zZXQgPSBmb3JtYXREYXRlKGFsbGVyZ3kub25zZXREYXRlVGltZSk7CiAgICBjb25zdCBhbGxlcmdlbiA9IGFsbGVyZ3kuY29kZT8uY29kaW5nPy5maW5kKAogICAgICAoY29kZSkgPT4gY29kZS5zeXN0ZW0gPT09ICdodHRwOi8vd3d3Lm5sbS5uaWguZ292L3Jlc2VhcmNoL3VtbHMvcnhub3JtJwogICAgKTsKICAgIHBhdGllbnRBbGxlcmdpZXMucHVzaCh7CiAgICAgIG9uc2V0LAogICAgICBhbGxlcmdlbjogewogICAgICAgIGlkOiBhbGxlcmd5LmNvZGU/LmlkLAogICAgICAgIG5hbWU6IGFsbGVyZ2VuPy5kaXNwbGF5LAogICAgICAgIHJ4Y3VpOiBhbGxlcmdlbj8uY29kZSwKICAgICAgfSwKICAgIH0pOwogIH0KCiAgcmV0dXJuIHBhdGllbnRBbGxlcmdpZXM7Cn0KCi8vIGFzeW5jIGZ1bmN0aW9uIGZvcm1hdFBhdGllbnRNZWRpY2F0aW9uSGlzdG9yeShwYXRpZW50OiBQYXRpZW50LCBtZWRwbHVtOiBNZWRwbHVtQ2xpZW50KTogUHJvbWlzZTxhbnk+IHsKLy8gICBjb25zdCBtZWRpY2F0aW9uSGlzdG9yeSA9IFtdOwovLyAgIGNvbnN0IG1lZGljYXRpb25SZXF1ZXN0cyA9IGF3YWl0IG1lZHBsdW0uc2VhcmNoUmVzb3VyY2VzKCdNZWRpY2F0aW9uUmVxdWVzdCcsIHsKLy8gICAgIHBhdGllbnQ6IGdldFJlZmVyZW5jZVN0cmluZyhwYXRpZW50KSwKLy8gICB9KTsKCi8vICAgaWYgKCFtZWRpY2F0aW9uUmVxdWVzdHMpIHsKLy8gICAgIHJldHVybiB1bmRlZmluZWQ7Ci8vICAgfQoKLy8gICAvLyAvLyBjb25zdCBtZWRpY2F0aW9uRW50cmllcyA9ID8uZW50cnk7Ci8vICAgLy8gaWYgKCFtZWRpY2F0aW9uRW50cmllcykgewovLyAgIC8vICAgcmV0dXJuIHVuZGVmaW5lZDsKLy8gICAvLyB9CgovLyAgIGZvciAoY29uc3QgbWVkaWNhdGlvbiBvZiBtZWRpY2F0aW9uUmVxdWVzdHMpIHsKLy8gICAgIGNvbnN0IHByb3ZpZGVyID0gbWVkaWNhdGlvbi5yZXF1ZXN0ZXIKLy8gICAgICAgPyAoKGF3YWl0IG1lZHBsdW0ucmVhZFJlZmVyZW5jZShtZWRpY2F0aW9uLnJlcXVlc3RlcikpIGFzIFByYWN0aXRpb25lcikKLy8gICAgICAgOiB1bmRlZmluZWQ7Ci8vICAgICBjb25zdCBtZWRpY2F0aW9uQ29kZSA9IG1lZGljYXRpb24ubWVkaWNhdGlvbkNvZGVhYmxlQ29uY2VwdD8uY29kaW5nPy5maW5kKAovLyAgICAgICAoY29kZSkgPT4gY29kZS5zeXN0ZW0gPT09ICdodHRwOi8vd3d3Lm5sbS5uaWguZ292L3Jlc2VhcmNoL3VtbHMvcnhub3JtJwovLyAgICAgKTsKLy8gICAgIC8vIGNvbnN0IG1lZGljYXRpb25EZXRhaWxzID0gbWVkaWNhdGlvbi5tZWRpY2F0aW9uUmVmZXJlbmNlCi8vICAgICAvLyAgID8gYXdhaXQgbWVkcGx1bS5yZWFkUmVmZXJlbmNlKG1lZGljYXRpb24ubWVkaWNhdGlvblJlZmVyZW5jZSkKLy8gICAgIC8vICAgOiB1bmRlZmluZWQ7CgovLyAgICAgY29uc3QgcGhvdG9uTWVkaWNhdGlvbiA9IHsKLy8gICAgICAgbmFtZTogbWVkaWNhdGlvbkNvZGU/LmRpc3BsYXksCi8vICAgICAgIGNvZGVzOiB7Ci8vICAgICAgICAgcnhjdWk6IG1lZGljYXRpb25Db2RlPy5jb2RlLAovLyAgICAgICB9LAovLyAgICAgICB0eXBlOiAnUlgnLAovLyAgICAgfTsKCi8vICAgICBjb25zdCBkaXNwZW5zZSA9IG1lZGljYXRpb24uZGlzcGVuc2VSZXF1ZXN0OwoKLy8gICAgIC8vIGNvbnN0IHBob3RvblByZXNjcmlwdGlvbiA9IHsKLy8gICAgIC8vICAgcHJlc2NyaWJlcjogewovLyAgICAgLy8gICAgIG5hbWU6IHByb3ZpZGVyPy5uYW1lPy5bMF0gPyBmb3JtYXRIdW1hbk5hbWUocHJvdmlkZXIubmFtZVswXSkgOiAnJywKLy8gICAgIC8vICAgICBlbWFpbDogZ2V0VGVsZWNvbSgnZW1haWwnLCBwcm92aWRlciksCi8vICAgICAvLyAgICAgcGhvbmU6IGdldFRlbGVjb20oJ3Bob25lJywgcHJvdmlkZXIpLAovLyAgICAgLy8gICAgIGZheDogZ2V0VGVsZWNvbSgnZmF4JywgcHJvdmlkZXIpLAovLyAgICAgLy8gICAgIGFkZHJlc3M6IHByb3ZpZGVyPy5hZGRyZXNzPy5bMF0gPyBmb3JtYXRBZGRyZXNzKHByb3ZpZGVyPy5hZGRyZXNzWzBdKSA6ICcnLAovLyAgICAgLy8gICB9LAovLyAgICAgLy8gICBzdGF0ZTogZ2V0UHJlc2NyaXB0aW9uU3RhdGUobWVkaWNhdGlvbi5zdGF0dXMpLAovLyAgICAgLy8gICB0cmVhdG1lbnQ6IHsKLy8gICAgIC8vICAgICBuYW1lOiBtZWRpY2F0aW9uQ29kZT8uZGlzcGxheSwKLy8gICAgIC8vICAgICBjb2RlczogewovLyAgICAgLy8gICAgICAgcnhjdWk6IG1lZGljYXRpb25Db2RlPy5jb2RlLAovLyAgICAgLy8gICAgIH0sCi8vICAgICAvLyAgICAgdHlwZTogJ1JYJywKLy8gICAgIC8vICAgfSwKLy8gICAgIC8vICAgZGlzcGVuc2VRdWFudGl0eTogZGlzcGVuc2U/LmluaXRpYWxGaWxsPy5xdWFudGl0eT8udmFsdWUsCi8vICAgICAvLyAgIGRpc3BlbnNlVW5pdDogZGlzcGVuc2U/LmluaXRpYWxGaWxsPy5xdWFudGl0eT8udW5pdCwKLy8gICAgIC8vICAgcmVmaWxsc0FsbG93ZWQ6IGRpc3BlbnNlPy5udW1iZXJPZlJlcGVhdHNBbGxvd2VkLAovLyAgICAgLy8gICBpbnN0cnVjdGlvbnM6IG1lZGljYXRpb24uZG9zYWdlSW5zdHJ1Y3Rpb24/LlswXS5hZGRpdGlvbmFsSW5zdHJ1Y3Rpb24/LlswXS50ZXh0LAovLyAgICAgLy8gICBub3RlczogbWVkaWNhdGlvbi5ub3RlPy5bMF0udGV4dCwKLy8gICAgIC8vIH07CgovLyAgICAgbWVkaWNhdGlvbkhpc3RvcnkucHVzaChwaG90b25NZWRpY2F0aW9uKTsKLy8gICB9CgovLyAgIHJldHVybiBtZWRpY2F0aW9uSGlzdG9yeTsKLy8gfQoKLy8gZnVuY3Rpb24gZ2V0TWVkaWNhdGlvbkRldGFpbHMobWVkaWNhdGlvbjogTWVkaWNhdGlvblJlcXVlc3QpIHt9CgovLyBmdW5jdGlvbiBnZXRQcmVzY3JpcHRpb25TdGF0ZShzdGF0dXM6IE1lZGljYXRpb25SZXF1ZXN0WydzdGF0dXMnXSk6IHN0cmluZyB7Ci8vICAgaWYgKHN0YXR1cyA9PT0gJ2FjdGl2ZScgfHwgc3RhdHVzID09PSAnZHJhZnQnIHx8IHN0YXR1cyA9PT0gJ29uLWhvbGQnKSB7Ci8vICAgICByZXR1cm4gJ0FDVElWRSc7Ci8vICAgfSBlbHNlIGlmIChzdGF0dXMgPT09ICdjYW5jZWxsZWQnIHx8IHN0YXR1cyA9PT0gJ2VudGVyZWQtaW4tZXJyb3InIHx8IHN0YXR1cyA9PT0gJ3N0b3BwZWQnKSB7Ci8vICAgICByZXR1cm4gJ0NBTkNFTEVEJzsKLy8gICB9IGVsc2UgewovLyAgICAgcmV0dXJuICdERVBMRVRFRCc7Ci8vICAgfQovLyB9CgpmdW5jdGlvbiBnZXRUZWxlY29tKHN5c3RlbTogQ29udGFjdFBvaW50WydzeXN0ZW0nXSwgcGVyc29uPzogUHJhY3RpdGlvbmVyIHwgUGF0aWVudCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7CiAgaWYgKCFwZXJzb24pIHsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBjb25zdCB0ZWxlY29tID0gcGVyc29uLnRlbGVjb20/LmZpbmQoKGNvbW0pID0+IGNvbW0uc3lzdGVtID09PSBzeXN0ZW0pOwogIHJldHVybiB0ZWxlY29tPy52YWx1ZTsKfQo="
      }
    },
    {
      "fullUrl": "urn:uuid:8361e380-2a00-4736-b84c-c20576e696e6",
      "request": {
        "method": "POST",
        "url": "Binary"
      },
      "resource": {
        "resourceType": "Binary",
        "contentType": "text/javascript",
        "data": "InVzZSBzdHJpY3QiOwp2YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHsKICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgImRlZmF1bHQiOiBtb2QgfTsKfTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKZXhwb3J0cy5oYW5kbGVyID0gaGFuZGxlcjsKY29uc3QgY29yZV8xID0gcmVxdWlyZSgiQG1lZHBsdW0vY29yZSIpOwpjb25zdCBub2RlX2ZldGNoXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZSgibm9kZS1mZXRjaCIpKTsKYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihtZWRwbHVtLCBldmVudCkgewogICAgdmFyIF9hLCBfYiwgX2MsIF9kOwogICAgY29uc3QgcGF0aWVudCA9IGV2ZW50LmlucHV0OwogICAgY29uc3QgUEhPVE9OX0tFWSA9IChfYSA9IGV2ZW50LnNlY3JldHNbJ1BIT1RPTl9BUElfS0VZJ10pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS52YWx1ZVN0cmluZzsKICAgIGNvbnN0IGFsbGVyZ2llcyA9IGF3YWl0IG1lZHBsdW0uc2VhcmNoUmVzb3VyY2VzKCdBbGxlcmd5SW50b2xlcmFuY2UnLCB7CiAgICAgICAgcGF0aWVudDogKDAsIGNvcmVfMS5nZXRSZWZlcmVuY2VTdHJpbmcpKHBhdGllbnQpLAogICAgfSk7CiAgICBjb25zdCBwaG90b25RdWVyeSA9IGAKICAgICAgbXV0YXRpb24gY3JlYXRlUGF0aWVudCgKICAgICAgICAkZXh0ZXJuYWxJZDogSUQKICAgICAgICAkbmFtZTogTmFtZUlucHV0IQogICAgICAgICRkYXRlT2ZCaXJ0aDogQVdTRGF0ZSEKICAgICAgICAkc2V4OiBTZXhUeXBlIQogICAgICAgICRwaG9uZTogQVdTUGhvbmUhCiAgICAgICAgJGFsbGVyZ2llczogW0FsbGVyZ2VuSW5wdXRdCiAgICAgICAgJG1lZGljYXRpb25IaXN0b3J5OiBbTWVkaWNhdGlvbklucHV0XQogICAgICApIHsKICAgICAgICBjcmVhdGVQYXRpZW50KAogICAgICAgICAgZXh0ZXJuYWxJZDogJGV4dGVybmFsSWQKICAgICAgICAgIG5hbWU6ICRuYW1lCiAgICAgICAgICBkYXRlT2ZCaXJ0aDogJGRhdGVPZkJpcnRoCiAgICAgICAgICBzZXg6ICRzZXgKICAgICAgICAgIHBob25lOiAkcGhvbmUKICAgICAgICAgIGFsbGVyZ2llczogJGFsbGVyZ2llcwogICAgICAgICAgbWVkaWNhdGlvbkhpc3Rvcnk6ICRtZWRpY2F0aW9uSGlzdG9yeQogICAgICAgICkKICAgICAgfQogICAgYDsKICAgIGNvbnN0IHZhcmlhYmxlcyA9IHsKICAgICAgICBleHRlcm5hbElkOiBwYXRpZW50LmlkLAogICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgZmlyc3Q6IChfYyA9IChfYiA9IHBhdGllbnQubmFtZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iWzBdLmdpdmVuKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NbMF0sCiAgICAgICAgICAgIGxhc3Q6IChfZCA9IHBhdGllbnQubmFtZSkgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kWzBdLmZhbWlseSwKICAgICAgICB9LAogICAgICAgIGRhdGVPZkJpcnRoOiAoMCwgY29yZV8xLmZvcm1hdERhdGUpKHBhdGllbnQuYmlydGhEYXRlKSwKICAgICAgICBzZXg6IGdldFNleFR5cGUocGF0aWVudC5nZW5kZXIpLAogICAgICAgIGdlbmRlcjogcGF0aWVudC5nZW5kZXIsCiAgICAgICAgZW1haWw6IGdldFRlbGVjb20oJ2VtYWlsJywgcGF0aWVudCksCiAgICAgICAgcGhvbmU6IGdldFRlbGVjb20oJ3Bob25lJywgcGF0aWVudCksCiAgICAgICAgYWxsZXJnaWVzOiBmb3JtYXRQYXRpZW50QWxsZXJnaWVzKGFsbGVyZ2llcyksCiAgICB9OwogICAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICBxdWVyeTogcGhvdG9uUXVlcnksCiAgICAgICAgdmFyaWFibGVzLAogICAgfSk7CiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAoMCwgbm9kZV9mZXRjaF8xLmRlZmF1bHQpKCdodHRwczovL2FwaS5uZXV0cm9uLmhlYWx0aC9ncmFwaHFsJywgewogICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgIGJvZHk6IGRhdGEsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBhdXRob3JpemF0aW9uOiBQSE9UT05fS0VZLAogICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgIH0sCiAgICB9KQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpKQogICAgICAgIC5jYXRjaCgoKSA9PiBjb25zb2xlLmxvZygnRXJyb3Igc3luY2luZyBwYXRpZW50JykpOwogICAgY29uc29sZS5sb2cocmVzdWx0KTsKICAgIGF3YWl0IHVwZGF0ZVBhdGllbnQocGF0aWVudCwgcmVzdWx0LCBtZWRwbHVtKTsKfQphc3luYyBmdW5jdGlvbiB1cGRhdGVQYXRpZW50KHBhdGllbnQsIHJlc3BvbnNlLCBtZWRwbHVtKSB7CiAgICB2YXIgX2EsIF9iOwogICAgY29uc3QgcGF0aWVudERhdGEgPSByZXNwb25zZS5kYXRhLmNyZWF0ZVBhdGllbnQ7CiAgICBjb25zdCBwaG90b25JZGVudGlmaWVyID0gewogICAgICAgIHN5c3RlbTogJ2h0dHA6Ly9waG90b24uaGVhbHRoJywKICAgICAgICB2YWx1ZTogcGF0aWVudERhdGEuaWQsCiAgICB9OwogICAgY29uc3QgaWRlbnRpZmllcnMgPSAoX2EgPSBwYXRpZW50LmlkZW50aWZpZXIpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IFtdOwogICAgaWRlbnRpZmllcnMucHVzaChwaG90b25JZGVudGlmaWVyKTsKICAgIGNvbnN0IG9wID0gcGF0aWVudC5pZGVudGlmaWVyID8gJ3JlcGxhY2UnIDogJ2FkZCc7CiAgICBjb25zdCBwYXRpZW50SWQgPSBwYXRpZW50LmlkOwogICAgY29uc3Qgb3BzID0gWwogICAgICAgIC8vIFRlc3QgdG8gcHJldmVudCByYWNlIGNvbmRpdGlvbnMKICAgICAgICB7IG9wOiAndGVzdCcsIHBhdGg6ICcvbWV0YS92ZXJzaW9uSWQnLCB2YWx1ZTogKF9iID0gcGF0aWVudC5tZXRhKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IudmVyc2lvbklkIH0sCiAgICAgICAgeyBvcCwgcGF0aDogJy9pZGVudGlmaWVyJywgdmFsdWU6IGlkZW50aWZpZXJzIH0sCiAgICBdOwogICAgdHJ5IHsKICAgICAgICBhd2FpdCBtZWRwbHVtLnBhdGNoUmVzb3VyY2UoJ1BhdGllbnQnLCBwYXRpZW50SWQsIG9wcyk7CiAgICAgICAgY29uc29sZS5sb2coJ1N1Y2Nlc3MnKTsKICAgIH0KICAgIGNhdGNoIChlcnIpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycik7CiAgICB9Cn0KZnVuY3Rpb24gZ2V0U2V4VHlwZShzZXgpIHsKICAgIGlmIChzZXggPT09ICdvdGhlcicgfHwgc2V4ID09PSAndW5rbm93bicpIHsKICAgICAgICByZXR1cm4gJ1VOS05PV04nOwogICAgfQogICAgaWYgKHNleCA9PT0gJ2ZlbWFsZScpIHsKICAgICAgICByZXR1cm4gJ0ZFTUFMRSc7CiAgICB9CiAgICByZXR1cm4gJ01BTEUnOwp9CmZ1bmN0aW9uIGZvcm1hdFBhdGllbnRBbGxlcmdpZXMoYWxsZXJnaWVzKSB7CiAgICB2YXIgX2EsIF9iLCBfYzsKICAgIGNvbnN0IHBhdGllbnRBbGxlcmdpZXMgPSBbXTsKICAgIGZvciAoY29uc3QgYWxsZXJneSBvZiBhbGxlcmdpZXMpIHsKICAgICAgICBjb25zdCBvbnNldCA9ICgwLCBjb3JlXzEuZm9ybWF0RGF0ZSkoYWxsZXJneS5vbnNldERhdGVUaW1lKTsKICAgICAgICBjb25zdCBhbGxlcmdlbiA9IChfYiA9IChfYSA9IGFsbGVyZ3kuY29kZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNvZGluZykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmZpbmQoKGNvZGUpID0+IGNvZGUuc3lzdGVtID09PSAnaHR0cDovL3d3dy5ubG0ubmloLmdvdi9yZXNlYXJjaC91bWxzL3J4bm9ybScpOwogICAgICAgIHBhdGllbnRBbGxlcmdpZXMucHVzaCh7CiAgICAgICAgICAgIG9uc2V0LAogICAgICAgICAgICBhbGxlcmdlbjogewogICAgICAgICAgICAgICAgaWQ6IChfYyA9IGFsbGVyZ3kuY29kZSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmlkLAogICAgICAgICAgICAgICAgbmFtZTogYWxsZXJnZW4gPT09IG51bGwgfHwgYWxsZXJnZW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFsbGVyZ2VuLmRpc3BsYXksCiAgICAgICAgICAgICAgICByeGN1aTogYWxsZXJnZW4gPT09IG51bGwgfHwgYWxsZXJnZW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFsbGVyZ2VuLmNvZGUsCiAgICAgICAgICAgIH0sCiAgICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gcGF0aWVudEFsbGVyZ2llczsKfQovLyBhc3luYyBmdW5jdGlvbiBmb3JtYXRQYXRpZW50TWVkaWNhdGlvbkhpc3RvcnkocGF0aWVudDogUGF0aWVudCwgbWVkcGx1bTogTWVkcGx1bUNsaWVudCk6IFByb21pc2U8YW55PiB7Ci8vICAgY29uc3QgbWVkaWNhdGlvbkhpc3RvcnkgPSBbXTsKLy8gICBjb25zdCBtZWRpY2F0aW9uUmVxdWVzdHMgPSBhd2FpdCBtZWRwbHVtLnNlYXJjaFJlc291cmNlcygnTWVkaWNhdGlvblJlcXVlc3QnLCB7Ci8vICAgICBwYXRpZW50OiBnZXRSZWZlcmVuY2VTdHJpbmcocGF0aWVudCksCi8vICAgfSk7Ci8vICAgaWYgKCFtZWRpY2F0aW9uUmVxdWVzdHMpIHsKLy8gICAgIHJldHVybiB1bmRlZmluZWQ7Ci8vICAgfQovLyAgIC8vIC8vIGNvbnN0IG1lZGljYXRpb25FbnRyaWVzID0gPy5lbnRyeTsKLy8gICAvLyBpZiAoIW1lZGljYXRpb25FbnRyaWVzKSB7Ci8vICAgLy8gICByZXR1cm4gdW5kZWZpbmVkOwovLyAgIC8vIH0KLy8gICBmb3IgKGNvbnN0IG1lZGljYXRpb24gb2YgbWVkaWNhdGlvblJlcXVlc3RzKSB7Ci8vICAgICBjb25zdCBwcm92aWRlciA9IG1lZGljYXRpb24ucmVxdWVzdGVyCi8vICAgICAgID8gKChhd2FpdCBtZWRwbHVtLnJlYWRSZWZlcmVuY2UobWVkaWNhdGlvbi5yZXF1ZXN0ZXIpKSBhcyBQcmFjdGl0aW9uZXIpCi8vICAgICAgIDogdW5kZWZpbmVkOwovLyAgICAgY29uc3QgbWVkaWNhdGlvbkNvZGUgPSBtZWRpY2F0aW9uLm1lZGljYXRpb25Db2RlYWJsZUNvbmNlcHQ/LmNvZGluZz8uZmluZCgKLy8gICAgICAgKGNvZGUpID0+IGNvZGUuc3lzdGVtID09PSAnaHR0cDovL3d3dy5ubG0ubmloLmdvdi9yZXNlYXJjaC91bWxzL3J4bm9ybScKLy8gICAgICk7Ci8vICAgICAvLyBjb25zdCBtZWRpY2F0aW9uRGV0YWlscyA9IG1lZGljYXRpb24ubWVkaWNhdGlvblJlZmVyZW5jZQovLyAgICAgLy8gICA/IGF3YWl0IG1lZHBsdW0ucmVhZFJlZmVyZW5jZShtZWRpY2F0aW9uLm1lZGljYXRpb25SZWZlcmVuY2UpCi8vICAgICAvLyAgIDogdW5kZWZpbmVkOwovLyAgICAgY29uc3QgcGhvdG9uTWVkaWNhdGlvbiA9IHsKLy8gICAgICAgbmFtZTogbWVkaWNhdGlvbkNvZGU/LmRpc3BsYXksCi8vICAgICAgIGNvZGVzOiB7Ci8vICAgICAgICAgcnhjdWk6IG1lZGljYXRpb25Db2RlPy5jb2RlLAovLyAgICAgICB9LAovLyAgICAgICB0eXBlOiAnUlgnLAovLyAgICAgfTsKLy8gICAgIGNvbnN0IGRpc3BlbnNlID0gbWVkaWNhdGlvbi5kaXNwZW5zZVJlcXVlc3Q7Ci8vICAgICAvLyBjb25zdCBwaG90b25QcmVzY3JpcHRpb24gPSB7Ci8vICAgICAvLyAgIHByZXNjcmliZXI6IHsKLy8gICAgIC8vICAgICBuYW1lOiBwcm92aWRlcj8ubmFtZT8uWzBdID8gZm9ybWF0SHVtYW5OYW1lKHByb3ZpZGVyLm5hbWVbMF0pIDogJycsCi8vICAgICAvLyAgICAgZW1haWw6IGdldFRlbGVjb20oJ2VtYWlsJywgcHJvdmlkZXIpLAovLyAgICAgLy8gICAgIHBob25lOiBnZXRUZWxlY29tKCdwaG9uZScsIHByb3ZpZGVyKSwKLy8gICAgIC8vICAgICBmYXg6IGdldFRlbGVjb20oJ2ZheCcsIHByb3ZpZGVyKSwKLy8gICAgIC8vICAgICBhZGRyZXNzOiBwcm92aWRlcj8uYWRkcmVzcz8uWzBdID8gZm9ybWF0QWRkcmVzcyhwcm92aWRlcj8uYWRkcmVzc1swXSkgOiAnJywKLy8gICAgIC8vICAgfSwKLy8gICAgIC8vICAgc3RhdGU6IGdldFByZXNjcmlwdGlvblN0YXRlKG1lZGljYXRpb24uc3RhdHVzKSwKLy8gICAgIC8vICAgdHJlYXRtZW50OiB7Ci8vICAgICAvLyAgICAgbmFtZTogbWVkaWNhdGlvbkNvZGU/LmRpc3BsYXksCi8vICAgICAvLyAgICAgY29kZXM6IHsKLy8gICAgIC8vICAgICAgIHJ4Y3VpOiBtZWRpY2F0aW9uQ29kZT8uY29kZSwKLy8gICAgIC8vICAgICB9LAovLyAgICAgLy8gICAgIHR5cGU6ICdSWCcsCi8vICAgICAvLyAgIH0sCi8vICAgICAvLyAgIGRpc3BlbnNlUXVhbnRpdHk6IGRpc3BlbnNlPy5pbml0aWFsRmlsbD8ucXVhbnRpdHk/LnZhbHVlLAovLyAgICAgLy8gICBkaXNwZW5zZVVuaXQ6IGRpc3BlbnNlPy5pbml0aWFsRmlsbD8ucXVhbnRpdHk/LnVuaXQsCi8vICAgICAvLyAgIHJlZmlsbHNBbGxvd2VkOiBkaXNwZW5zZT8ubnVtYmVyT2ZSZXBlYXRzQWxsb3dlZCwKLy8gICAgIC8vICAgaW5zdHJ1Y3Rpb25zOiBtZWRpY2F0aW9uLmRvc2FnZUluc3RydWN0aW9uPy5bMF0uYWRkaXRpb25hbEluc3RydWN0aW9uPy5bMF0udGV4dCwKLy8gICAgIC8vICAgbm90ZXM6IG1lZGljYXRpb24ubm90ZT8uWzBdLnRleHQsCi8vICAgICAvLyB9OwovLyAgICAgbWVkaWNhdGlvbkhpc3RvcnkucHVzaChwaG90b25NZWRpY2F0aW9uKTsKLy8gICB9Ci8vICAgcmV0dXJuIG1lZGljYXRpb25IaXN0b3J5OwovLyB9Ci8vIGZ1bmN0aW9uIGdldE1lZGljYXRpb25EZXRhaWxzKG1lZGljYXRpb246IE1lZGljYXRpb25SZXF1ZXN0KSB7fQovLyBmdW5jdGlvbiBnZXRQcmVzY3JpcHRpb25TdGF0ZShzdGF0dXM6IE1lZGljYXRpb25SZXF1ZXN0WydzdGF0dXMnXSk6IHN0cmluZyB7Ci8vICAgaWYgKHN0YXR1cyA9PT0gJ2FjdGl2ZScgfHwgc3RhdHVzID09PSAnZHJhZnQnIHx8IHN0YXR1cyA9PT0gJ29uLWhvbGQnKSB7Ci8vICAgICByZXR1cm4gJ0FDVElWRSc7Ci8vICAgfSBlbHNlIGlmIChzdGF0dXMgPT09ICdjYW5jZWxsZWQnIHx8IHN0YXR1cyA9PT0gJ2VudGVyZWQtaW4tZXJyb3InIHx8IHN0YXR1cyA9PT0gJ3N0b3BwZWQnKSB7Ci8vICAgICByZXR1cm4gJ0NBTkNFTEVEJzsKLy8gICB9IGVsc2UgewovLyAgICAgcmV0dXJuICdERVBMRVRFRCc7Ci8vICAgfQovLyB9CmZ1bmN0aW9uIGdldFRlbGVjb20oc3lzdGVtLCBwZXJzb24pIHsKICAgIHZhciBfYTsKICAgIGlmICghcGVyc29uKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KICAgIGNvbnN0IHRlbGVjb20gPSAoX2EgPSBwZXJzb24udGVsZWNvbSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZpbmQoKGNvbW0pID0+IGNvbW0uc3lzdGVtID09PSBzeXN0ZW0pOwogICAgcmV0dXJuIHRlbGVjb20gPT09IG51bGwgfHwgdGVsZWNvbSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdGVsZWNvbS52YWx1ZTsKfQovLyMgc291cmNlTWFwcGluZ1VSTD1zeW5jLXBhdGllbnQuanMubWFw"
      }
    },
    {
      "request": {
        "method": "PUT",
        "url": "$bot-sync-patient-reference"
      },
      "resource": {
        "resourceType": "Bot",
        "id": "$bot-sync-patient-id",
        "name": "sync-patient",
        "identifier": [
          {
            "system": "http://example-bots.org",
            "value": "sync-patient"
          }
        ],
        "runtimeVersion": "awslambda",
        "sourceCode": {
          "contentType": "text/typescript",
          "url": "urn:uuid:12d816f9-021e-4c25-aa9f-8a9e8271fc39"
        },
        "executableCode": {
          "contentType": "text/javascript",
          "url": "urn:uuid:8361e380-2a00-4736-b84c-c20576e696e6"
        }
      }
    }
  ]
}