exports.id=247,exports.ids=[247],exports.modules={2792:(a,b,c)=>{"use strict";c.d(b,{mcf:()=>aB,OpF:()=>k,BRs:()=>be,bNj:()=>aV,KWQ:()=>i,pYA:()=>j});var d=c(31768),e=c(78157),f=c(10128),g=(0,d.createContext)(void 0);function h(){return(0,d.useContext)(g)}function i(){return h().medplum}function j(){return h().profile}function k(a){let b=a.medplum,c=a.navigate??l,[f,h]=(0,d.useState)({profile:b.getProfile(),loading:b.isLoading()}),i=(0,d.useMemo)(()=>({...f,medplum:b,navigate:c}),[f,b,c]);return(0,e.jsx)(g.Provider,{value:i,children:a.children})}function l(a){window.location.assign(a)}var m=new Map,n=a=>(0,d.useMemo)(()=>{let b;if(!a)return;let c=a.split("?")[0];if(!c)return a;try{b=new URLSearchParams(new URL(a).search)}catch{return a}if(!b.has("Key-Pair-Id")||!b.has("Signature"))return a;let d=b.get("Expires");if(!d||d.length>13)return a;let e=m.get(c);if(e){let a=new URLSearchParams(new URL(e).search).get("Expires");if(a&&1e3*Number.parseInt(a,10)-5e3>Date.now())return e}return m.set(c,a),a},[a]);function o(a,b){let c=i(),[e,g]=(0,d.useState)(()=>(function(a,b){if(b){if((0,f.NCg)(b))return b;if((0,f.A_h)(b))return a.getCachedReference(b)}})(c,a));return(0,d.useCallback)(a=>{(0,f.c2A)(a,e)||g(a)},[e]),e}var p={boolean:"boolean",decimal:"decimal",integer:"integer",date:"date",dateTime:"dateTime",time:"time",url:"url",attachment:"attachment",reference:"reference",quantity:"quantity"};p.boolean,f.UtL.boolean,p.date,f.UtL.date,p.dateTime,f.UtL.dateTime,p.time,f.UtL.time,p.url,f.UtL.string,f.UtL.uri,f.UtL.url,p.attachment,f.UtL.Attachment,p.reference,f.UtL.Reference,p.quantity,f.UtL.Quantity,p.decimal,f.UtL.decimal,f.UtL.integer,p.integer,f.UtL.decimal,f.UtL.integer;var q=c(54569),r=c(68816),s=c(37353),t=c(30825),u=c(56774),v=c(10524),w=c(26939),x=c(85600),y=c(53475),z=c(60691),A=c(49682),B=c(79809),C=c(67284),D=c(79635),E=c(44731),F=c(8009),G=c(31954),H=c(24657),I=c(61863),J=c(68591),K=c(66588),L=c(35423),M=c(10373),N=c(94997),O=c(87564),P=c(99019),Q=Object.create,R=Object.defineProperty,S=Object.getOwnPropertyDescriptor,T=Object.getOwnPropertyNames,U=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty,W=(a,b)=>function(){return b||(0,a[T(a)[0]])((b={exports:{}}).exports,b),b.exports},X=W({"../../node_modules/rfc6902/pointer.js"(a){function b(a){return a.replace(/~1/g,"/").replace(/~0/g,"~")}function c(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(a,"__esModule",{value:!0}),a.Pointer=a.escapeToken=a.unescapeToken=void 0,a.unescapeToken=b,a.escapeToken=c,a.Pointer=function(){function a(a){void 0===a&&(a=[""]),this.tokens=a}return a.fromJSON=function(c){var d=c.split("/").map(b);if(""!==d[0])throw Error("Invalid JSON Pointer: ".concat(c));return new a(d)},a.prototype.toString=function(){return this.tokens.map(c).join("/")},a.prototype.evaluate=function(a){for(var b=null,c="",d=a,e=1,f=this.tokens.length;e<f;e++)b=d,"__proto__"!=(c=this.tokens[e])&&"constructor"!=c&&"prototype"!=c&&(d=(b||{})[c]);return{parent:b,key:c,value:d}},a.prototype.get=function(a){return this.evaluate(a).value},a.prototype.set=function(a,b){var c=this.evaluate(a);c.parent&&(c.parent[c.key]=b)},a.prototype.push=function(a){this.tokens.push(a)},a.prototype.add=function(b){return new a(this.tokens.concat(String(b)))},a}()}}),Y=W({"../../node_modules/rfc6902/util.js"(a){Object.defineProperty(a,"__esModule",{value:!0}),a.clone=a.objectType=a.hasOwnProperty=void 0,a.hasOwnProperty=Object.prototype.hasOwnProperty,a.objectType=function(a){return void 0===a?"undefined":null===a?"null":Array.isArray(a)?"array":typeof a},a.clone=function b(c){if(null==c||"object"!=typeof c)return c;if(c.constructor==Array){for(var d=c.length,e=Array(d),f=0;f<d;f++)e[f]=b(c[f]);return e}if(c.constructor==Date)return new Date(+c);var g={};for(var h in c)a.hasOwnProperty.call(c,h)&&(g[h]=b(c[h]));return g}}}),Z=W({"../../node_modules/rfc6902/diff.js"(a){Object.defineProperty(a,"__esModule",{value:!0}),a.diffAny=a.diffObjects=a.diffArrays=a.intersection=a.subtract=a.isDestructive=void 0;var b=Y();function c(a,c){var d={};for(var e in a)b.hasOwnProperty.call(a,e)&&void 0!==a[e]&&(d[e]=1);for(var f in c)b.hasOwnProperty.call(c,f)&&void 0!==c[f]&&delete d[f];return Object.keys(d)}function d(a){for(var c=a.length,d={},e=0;e<c;e++){var f=a[e];for(var g in f)b.hasOwnProperty.call(f,g)&&void 0!==f[g]&&(d[g]=(d[g]||0)+1)}for(var g in d)d[g]<c&&delete d[g];return Object.keys(d)}function e(a,b){return{operations:a.operations.concat(b),cost:a.cost+1}}function f(a,b,c,d){void 0===d&&(d=h);var f={"0,0":{operations:[],cost:0}},g=isNaN(a.length)||a.length<=0?0:a.length;return(function g(h,i){var j="".concat(h,",").concat(i),k=f[j];if(void 0===k){if(h>0&&i>0&&!d(a[h-1],b[i-1],c.add(String(h-1))).length)k=g(h-1,i-1);else{var l=[];if(h>0){var m=g(h-1,i);l.push(e(m,{op:"remove",index:h-1}))}if(i>0){var n=g(h,i-1),o={op:"add",index:h-1,value:b[i-1]};l.push(e(n,o))}if(h>0&&i>0){var p=g(h-1,i-1),q={op:"replace",index:h-1,original:a[h-1],value:b[i-1]};l.push(e(p,q))}k=l.sort(function(a,b){return a.cost-b.cost})[0]}f[j]=k}return k})(g,isNaN(b.length)||b.length<=0?0:b.length).operations.reduce(function(a,b){var e=a[0],f=a[1];if("add"===b.op){var h=b.index+1+f,i=h<g+f?String(h):"-",j={op:b.op,path:c.add(i).toString(),value:b.value};return[e.concat(j),f+1]}if("remove"===b.op){var j={op:b.op,path:c.add(String(b.index+f)).toString()};return[e.concat(j),f-1]}var k=c.add(String(b.index+f)),l=d(b.original,b.value,k);return[e.concat.apply(e,l),f]},[[],0])[0]}function g(a,b,e,f){void 0===f&&(f=h);var g=[];return c(a,b).forEach(function(a){g.push({op:"remove",path:e.add(a).toString()})}),c(b,a).forEach(function(a){g.push({op:"add",path:e.add(a).toString(),value:b[a]})}),d([a,b]).forEach(function(c){g.push.apply(g,f(a[c],b[c],e.add(c)))}),g}function h(a,c,d,e){if(void 0===e&&(e=h),a===c)return[];var i=(0,b.objectType)(a),j=(0,b.objectType)(c);return"array"==i&&"array"==j?f(a,c,d,e):"object"==i&&"object"==j?g(a,c,d,e):[{op:"replace",path:d.toString(),value:c}]}a.isDestructive=function(a){var b=a.op;return"remove"===b||"replace"===b||"copy"===b||"move"===b},a.subtract=c,a.intersection=d,a.diffArrays=f,a.diffObjects=g,a.diffAny=h}}),$=W({"../../node_modules/rfc6902/patch.js"(a){var b,c=a&&a.__extends||(b=function(a,c){return(b=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])})(a,c)},function(a,c){if("function"!=typeof c&&null!==c)throw TypeError("Class extends value "+String(c)+" is not a constructor or null");function d(){this.constructor=a}b(a,c),a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)});Object.defineProperty(a,"__esModule",{value:!0}),a.apply=a.InvalidOperationError=a.test=a.copy=a.move=a.replace=a.remove=a.add=a.TestError=a.MissingError=void 0;var d=X(),e=Y(),f=Z(),g=function(a){function b(b){var c=a.call(this,"Value required at path: ".concat(b))||this;return c.path=b,c.name="MissingError",c}return c(b,a),b}(Error);a.MissingError=g;var h=function(a){function b(b,c){var d=a.call(this,"Test failed: ".concat(b," != ").concat(c))||this;return d.actual=b,d.expected=c,d.name="TestError",d}return c(b,a),b}(Error);function i(a,b,c){if(Array.isArray(a))if("-"==b)a.push(c);else{var d=parseInt(b,10);a.splice(d,0,c)}else a[b]=c}function j(a,b){if(Array.isArray(a)){var c=parseInt(b,10);a.splice(c,1)}else delete a[b]}function k(a,b){var c=d.Pointer.fromJSON(b.path).evaluate(a);return void 0===c.parent?new g(b.path):(i(c.parent,c.key,(0,e.clone)(b.value)),null)}function l(a,b){var c=d.Pointer.fromJSON(b.path).evaluate(a);return void 0===c.value?new g(b.path):(j(c.parent,c.key),null)}function m(a,b){var c=d.Pointer.fromJSON(b.path).evaluate(a);if(null===c.parent)return new g(b.path);if(Array.isArray(c.parent)){if(parseInt(c.key,10)>=c.parent.length)return new g(b.path)}else if(void 0===c.value)return new g(b.path);return c.parent[c.key]=(0,e.clone)(b.value),null}function n(a,b){var c=d.Pointer.fromJSON(b.from).evaluate(a);if(void 0===c.value)return new g(b.from);var e=d.Pointer.fromJSON(b.path).evaluate(a);return void 0===e.parent?new g(b.path):(j(c.parent,c.key),i(e.parent,e.key,c.value),null)}function o(a,b){var c=d.Pointer.fromJSON(b.from).evaluate(a);if(void 0===c.value)return new g(b.from);var f=d.Pointer.fromJSON(b.path).evaluate(a);return void 0===f.parent?new g(b.path):(i(f.parent,f.key,(0,e.clone)(c.value)),null)}function p(a,b){var c=d.Pointer.fromJSON(b.path).evaluate(a);return(0,f.diffAny)(c.value,b.value,new d.Pointer).length?new h(c.value,b.value):null}a.TestError=h,a.add=k,a.remove=l,a.replace=m,a.move=n,a.copy=o,a.test=p;var q=function(a){function b(b){var c=a.call(this,"Invalid operation: ".concat(b.op))||this;return c.operation=b,c.name="InvalidOperationError",c}return c(b,a),b}(Error);a.InvalidOperationError=q,a.apply=function(a,b){switch(b.op){case"add":return k(a,b);case"remove":return l(a,b);case"replace":return m(a,b);case"move":return n(a,b);case"copy":return o(a,b);case"test":return p(a,b)}return new q(b)}}}),_=W({"../../node_modules/rfc6902/index.js"(a){Object.defineProperty(a,"__esModule",{value:!0}),a.createTests=a.createPatch=a.applyPatch=a.Pointer=void 0;var b=X();Object.defineProperty(a,"Pointer",{enumerable:!0,get:function(){return b.Pointer}});var c=$(),d=Z();function e(a,c){var d=b.Pointer.fromJSON(c).evaluate(a);if(void 0!==d)return{op:"test",path:c,value:d.value}}a.applyPatch=function(a,b){return b.map(function(b){return(0,c.apply)(a,b)})},a.createPatch=function(a,c,e){var f=new b.Pointer;return(e?function a(b,c,f){var g=e(b,c,f);return Array.isArray(g)?g:(0,d.diffAny)(b,c,f,a)}:d.diffAny)(a,c,f)},a.createTests=function(a,b){var c=[];return b.filter(d.isDestructive).forEach(function(b){var d=e(a,b.path);if(d&&c.push(d),"from"in b){var f=e(a,b.from);f&&c.push(f)}}),c}}});function aa(a){let b=a.value;return b?(0,e.jsx)(e.Fragment,{children:(0,f.M0D)(b)}):null}var ab=["meta","implicitRules","contained","extension","modifierExtension"],ac=["language","text"],ad=(0,d.createContext)({path:"",profileUrl:void 0,elements:Object.create(null),elementsByPath:Object.create(null),getExtendedProps:()=>({readonly:!1,hidden:!1}),accessPolicyResource:void 0,debugMode:!1,isDefaultContext:!0});ad.displayName="ElementsContext";var ae=["extension","modifierExtension"];["id",...ab].filter(a=>!ae.includes(a));var af={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}},ag=(a,b,c,e)=>{let f=(0,d.forwardRef)(({color:c="currentColor",size:f=24,stroke:g=2,title:h,className:i,children:j,...k},l)=>(0,d.createElement)("svg",{ref:l,...af[a],width:f,height:f,className:["tabler-icon",`tabler-icon-${b}`,i].join(" "),..."filled"===a?{fill:c}:{strokeWidth:g,stroke:c},...k},[h&&(0,d.createElement)("title",{key:"svg-title"},h),...e.map(([a,b])=>(0,d.createElement)(a,b)),...Array.isArray(j)?j:[j]]));return f.displayName=`${c}`,f};ag("outline","adjustments-horizontal","AdjustmentsHorizontal",[["path",{d:"M14 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M4 6l8 0",key:"svg-1"}],["path",{d:"M16 6l4 0",key:"svg-2"}],["path",{d:"M8 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-3"}],["path",{d:"M4 12l2 0",key:"svg-4"}],["path",{d:"M10 12l10 0",key:"svg-5"}],["path",{d:"M17 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-6"}],["path",{d:"M4 18l11 0",key:"svg-7"}],["path",{d:"M19 18l1 0",key:"svg-8"}]]);var ah=ag("outline","alert-circle","AlertCircle",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 8v4",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]]);ag("outline","arrow-down","ArrowDown",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M18 13l-6 6",key:"svg-1"}],["path",{d:"M6 13l6 6",key:"svg-2"}]]),ag("outline","arrow-right","ArrowRight",[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]]),ag("outline","arrow-up","ArrowUp",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M18 11l-6 -6",key:"svg-1"}],["path",{d:"M6 11l6 -6",key:"svg-2"}]]),ag("outline","binary-tree","BinaryTree",[["path",{d:"M6 20a2 2 0 1 0 -4 0a2 2 0 0 0 4 0z",key:"svg-0"}],["path",{d:"M16 4a2 2 0 1 0 -4 0a2 2 0 0 0 4 0z",key:"svg-1"}],["path",{d:"M16 20a2 2 0 1 0 -4 0a2 2 0 0 0 4 0z",key:"svg-2"}],["path",{d:"M11 12a2 2 0 1 0 -4 0a2 2 0 0 0 4 0z",key:"svg-3"}],["path",{d:"M21 12a2 2 0 1 0 -4 0a2 2 0 0 0 4 0z",key:"svg-4"}],["path",{d:"M5.058 18.306l2.88 -4.606",key:"svg-5"}],["path",{d:"M10.061 10.303l2.877 -4.604",key:"svg-6"}],["path",{d:"M10.065 13.705l2.876 4.6",key:"svg-7"}],["path",{d:"M15.063 5.7l2.881 4.61",key:"svg-8"}]]),ag("outline","bleach-off","BleachOff",[["path",{d:"M5 19h14m1.986 -1.977a2 2 0 0 0 -.146 -.773l-7.1 -12.25a2 2 0 0 0 -3.5 0l-.815 1.405m-1.488 2.568l-4.797 8.277a2 2 0 0 0 1.75 2.75",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]]),ag("outline","bleach","Bleach",[["path",{d:"M5 19h14a2 2 0 0 0 1.84 -2.75l-7.1 -12.25a2 2 0 0 0 -3.5 0l-7.1 12.25a2 2 0 0 0 1.75 2.75",key:"svg-0"}]]),ag("outline","box-multiple","BoxMultiple",[["path",{d:"M7 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M17 17v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h2",key:"svg-1"}]]),ag("outline","brackets-contain","BracketsContain",[["path",{d:"M7 4h-4v16h4",key:"svg-0"}],["path",{d:"M17 4h4v16h-4",key:"svg-1"}],["path",{d:"M8 16h.01",key:"svg-2"}],["path",{d:"M12 16h.01",key:"svg-3"}],["path",{d:"M16 16h.01",key:"svg-4"}]]),ag("outline","bucket-off","BucketOff",[["path",{d:"M5.029 5.036c-.655 .58 -1.029 1.25 -1.029 1.964c0 2.033 3.033 3.712 6.96 3.967m3.788 -.21c3.064 -.559 5.252 -2.029 5.252 -3.757c0 -2.21 -3.582 -4 -8 -4c-1.605 0 -3.1 .236 -4.352 .643",key:"svg-0"}],["path",{d:"M4 7c0 .664 .088 1.324 .263 1.965l2.737 10.035c.5 1.5 2.239 2 5 2s4.5 -.5 5 -2c.1 -.3 .252 -.812 .457 -1.535m.862 -3.146c.262 -.975 .735 -2.76 1.418 -5.354a7.45 7.45 0 0 0 .263 -1.965",key:"svg-1"}],["path",{d:"M3 3l18 18",key:"svg-2"}]]),ag("outline","bucket","Bucket",[["path",{d:"M12 7m-8 0a8 4 0 1 0 16 0a8 4 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 7c0 .664 .088 1.324 .263 1.965l2.737 10.035c.5 1.5 2.239 2 5 2s4.5 -.5 5 -2c.333 -1 1.246 -4.345 2.737 -10.035a7.45 7.45 0 0 0 .263 -1.965",key:"svg-1"}]]),ag("outline","cake","Cake",[["path",{d:"M3 20h18v-8a3 3 0 0 0 -3 -3h-12a3 3 0 0 0 -3 3v8z",key:"svg-0"}],["path",{d:"M3 14.803c.312 .135 .654 .204 1 .197a2.4 2.4 0 0 0 2 -1a2.4 2.4 0 0 1 2 -1a2.4 2.4 0 0 1 2 1a2.4 2.4 0 0 0 2 1a2.4 2.4 0 0 0 2 -1a2.4 2.4 0 0 1 2 -1a2.4 2.4 0 0 1 2 1a2.4 2.4 0 0 0 2 1c.35 .007 .692 -.062 1 -.197",key:"svg-1"}],["path",{d:"M12 4l1.465 1.638a2 2 0 1 1 -3.015 .099l1.55 -1.737z",key:"svg-2"}]]),ag("outline","calendar","Calendar",[["path",{d:"M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z",key:"svg-0"}],["path",{d:"M16 3v4",key:"svg-1"}],["path",{d:"M8 3v4",key:"svg-2"}],["path",{d:"M4 11h16",key:"svg-3"}],["path",{d:"M11 15h1",key:"svg-4"}],["path",{d:"M12 15v3",key:"svg-5"}]]);var ai=ag("outline","check","Check",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]);ag("outline","checkbox","Checkbox",[["path",{d:"M9 11l3 3l8 -8",key:"svg-0"}],["path",{d:"M20 12v6a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h9",key:"svg-1"}]]),ag("outline","chevron-down","ChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]),ag("outline","chevron-right","ChevronRight",[["path",{d:"M9 6l6 6l-6 6",key:"svg-0"}]]),ag("outline","chevron-up","ChevronUp",[["path",{d:"M6 15l6 -6l6 6",key:"svg-0"}]]),ag("outline","circle-minus","CircleMinus",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 12l6 0",key:"svg-1"}]]),ag("outline","circle-plus","CirclePlus",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M9 12h6",key:"svg-1"}],["path",{d:"M12 9v6",key:"svg-2"}]]),ag("outline","cloud-upload","CloudUpload",[["path",{d:"M7 18a4.6 4.4 0 0 1 0 -9a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1",key:"svg-0"}],["path",{d:"M9 15l3 -3l3 3",key:"svg-1"}],["path",{d:"M12 12l0 9",key:"svg-2"}]]),ag("outline","columns","Columns",[["path",{d:"M4 6l5.5 0",key:"svg-0"}],["path",{d:"M4 10l5.5 0",key:"svg-1"}],["path",{d:"M4 14l5.5 0",key:"svg-2"}],["path",{d:"M4 18l5.5 0",key:"svg-3"}],["path",{d:"M14.5 6l5.5 0",key:"svg-4"}],["path",{d:"M14.5 10l5.5 0",key:"svg-5"}],["path",{d:"M14.5 14l5.5 0",key:"svg-6"}],["path",{d:"M14.5 18l5.5 0",key:"svg-7"}]]);var aj=ag("outline","copy","Copy",[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]]);ag("outline","currency-dollar","CurrencyDollar",[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]]),ag("outline","dots","Dots",[["path",{d:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}]]),ag("outline","edit","Edit",[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]]),ag("outline","empathize","Empathize",[["path",{d:"M12 5.5m-2.5 0a2.5 2.5 0 1 0 5 0a2.5 2.5 0 1 0 -5 0",key:"svg-0"}],["path",{d:"M12 21.368l5.095 -5.096a3.088 3.088 0 1 0 -4.367 -4.367l-.728 .727l-.728 -.727a3.088 3.088 0 1 0 -4.367 4.367l5.095 5.096z",key:"svg-1"}]]),ag("outline","equal-not","EqualNot",[["path",{d:"M5 10h14",key:"svg-0"}],["path",{d:"M5 14h14",key:"svg-1"}],["path",{d:"M5 19l14 -14",key:"svg-2"}]]),ag("outline","equal","Equal",[["path",{d:"M5 10h14",key:"svg-0"}],["path",{d:"M5 14h14",key:"svg-1"}]]);var ak=ag("outline","eye-off","EyeOff",[["path",{d:"M10.585 10.587a2 2 0 0 0 2.829 2.828",key:"svg-0"}],["path",{d:"M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87",key:"svg-1"}],["path",{d:"M3 3l18 18",key:"svg-2"}]]),al=ag("outline","eye","Eye",[["path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6",key:"svg-1"}]]);ag("outline","file-alert","FileAlert",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M12 17l.01 0",key:"svg-2"}],["path",{d:"M12 11l0 3",key:"svg-3"}]]),ag("outline","file-plus","FilePlus",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M12 11l0 6",key:"svg-2"}],["path",{d:"M9 14l6 0",key:"svg-3"}]]),ag("outline","filter","Filter",[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]]),ag("outline","language","Language",[["path",{d:"M9 6.371c0 4.418 -2.239 6.629 -5 6.629",key:"svg-0"}],["path",{d:"M4 6.371h7",key:"svg-1"}],["path",{d:"M5 9c0 2.144 2.252 3.908 6 4",key:"svg-2"}],["path",{d:"M12 20l4 -9l4 9",key:"svg-3"}],["path",{d:"M19.1 18h-6.2",key:"svg-4"}],["path",{d:"M6.694 3l.793 .582",key:"svg-5"}]]),ag("outline","logout","Logout",[["path",{d:"M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M9 12h12l-3 -3",key:"svg-1"}],["path",{d:"M18 15l3 -3",key:"svg-2"}]]),ag("outline","map-pin","MapPin",[["path",{d:"M9 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-0"}],["path",{d:"M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.827 0l-4.244 -4.243a8 8 0 1 1 11.314 0z",key:"svg-1"}]]),ag("outline","math-greater","MathGreater",[["path",{d:"M5 18l14 -6l-14 -6",key:"svg-0"}]]),ag("outline","math-lower","MathLower",[["path",{d:"M19 18l-14 -6l14 -6",key:"svg-0"}]]),ag("outline","message","Message",[["path",{d:"M8 9h8",key:"svg-0"}],["path",{d:"M8 13h6",key:"svg-1"}],["path",{d:"M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z",key:"svg-2"}]]),ag("outline","plus","Plus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]),ag("outline","refresh","Refresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]]),ag("outline","search","Search",[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]]),ag("outline","settings","Settings",[["path",{d:"M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z",key:"svg-0"}],["path",{d:"M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]]),ag("outline","sort-ascending","SortAscending",[["path",{d:"M4 6l7 0",key:"svg-0"}],["path",{d:"M4 12l7 0",key:"svg-1"}],["path",{d:"M4 18l9 0",key:"svg-2"}],["path",{d:"M15 9l3 -3l3 3",key:"svg-3"}],["path",{d:"M18 6l0 12",key:"svg-4"}]]),ag("outline","sort-descending","SortDescending",[["path",{d:"M4 6l9 0",key:"svg-0"}],["path",{d:"M4 12l7 0",key:"svg-1"}],["path",{d:"M4 18l7 0",key:"svg-2"}],["path",{d:"M15 15l3 3l3 -3",key:"svg-3"}],["path",{d:"M18 6l0 12",key:"svg-4"}]]),ag("outline","square","Square",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}]]),ag("outline","stethoscope","Stethoscope",[["path",{d:"M6 4h-1a2 2 0 0 0 -2 2v3.5h0a5.5 5.5 0 0 0 11 0v-3.5a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M8 15a6 6 0 1 0 12 0v-3",key:"svg-1"}],["path",{d:"M11 3v2",key:"svg-2"}],["path",{d:"M6 3v2",key:"svg-3"}],["path",{d:"M20 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-4"}]]),ag("outline","switch-horizontal","SwitchHorizontal",[["path",{d:"M16 3l4 4l-4 4",key:"svg-0"}],["path",{d:"M10 7l10 0",key:"svg-1"}],["path",{d:"M8 13l-4 4l4 4",key:"svg-2"}],["path",{d:"M4 17l9 0",key:"svg-3"}]]),ag("outline","table-export","TableExport",[["path",{d:"M12.5 21h-7.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v7.5",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v18",key:"svg-2"}],["path",{d:"M16 19h6",key:"svg-3"}],["path",{d:"M19 16l3 3l-3 3",key:"svg-4"}]]),ag("outline","trash","Trash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]),ag("outline","x","X",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]),d.Component;var am=function(){for(var a,b,c=0,d="",e=arguments.length;c<e;c++)(a=arguments[c])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b)){var f=b.length;for(c=0;c<f;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d)}else for(d in b)b[d]&&(e&&(e+=" "),e+=d);return e}(a))&&(d&&(d+=" "),d+=b);return d};function an(a){let b=h().navigate,{to:c,suffix:d,label:g,onClick:i,children:j,...k}=a,l=function(a){if(a){var b,c,d;if("string"==typeof a){return(b=a).startsWith("http://")||b.startsWith("https://")||b.startsWith("/")?b:"/"+b}if((0,f.NCg)(a)){return c=a,`/${c.resourceType}/${c.id}`}if((0,f.A_h)(a)){return d=a,`/${d.reference}`}}return"#"}(c);return d&&(l+="/"+d),(0,e.jsx)(s.Anchor,{href:l,"aria-label":g,onAuxClick:a=>{a.stopPropagation()},onClick:a=>{a.stopPropagation(),i?(a.preventDefault(),i(a)):c&&(1===a.button||a.ctrlKey||a.metaKey||(a.preventDefault(),b(l)))},...k,children:j})}function ao(a){let b=a.value;return b?(0,e.jsx)(e.Fragment,{children:(0,f.EpQ)(b,a.options)}):null}var ap=(0,d.createContext)({submitting:!1});function aq(a){let[b,c]=(0,d.useState)(!1);return(0,e.jsx)(ap.Provider,{value:{submitting:b},children:(0,e.jsx)("form",{style:a.style,"data-testid":a.testid,onSubmit:b=>{b.preventDefault();let d=function(a){let b={};for(let f of Array.from(a.elements)){var c,d,e;f instanceof HTMLInputElement?(c=b,(d=f).disabled||("checkbox"===d.type||"radio"===d.type)&&!d.checked||(c[d.name]=d.value)):f instanceof HTMLTextAreaElement?b[f.name]=f.value:f instanceof HTMLSelectElement&&(b[(e=f).name]=e.value)}return b}(b.target);if(a.onSubmit){c(!0);let b=a.onSubmit(d);b?.then?b.catch(console.error).finally(()=>{c(!1)}):c(!1)}},children:a.children})})}function ar(a){let{children:b,...c}=a,{submitting:f}=(0,d.useContext)(ap);return(0,e.jsx)(t.Button,{type:"submit",loading:f,...c,children:b})}function as(a){let{url:b}=a,[c,g]=(0,d.useState)(!1),h=(0,d.useRef)(null),[i,j]=(0,d.useState)(),[k,l]=(0,d.useState)(!1),m=async()=>{if(b)try{l(!0);let a=await (await fetch(b)).text(),c=new FormData;c.append("ccdaFile",new Blob([a],{type:"text/xml"}),"ccda.xml");let d=await fetch("https://ccda-validator.medplum.com/referenceccdaservice/?validationObjective=C-CDA_IG_Plus_Vocab&referenceFileName=No%20scenario%20File&curesUpdate=true&severityLevel=WARNING",{method:"POST",body:c,credentials:"omit",redirect:"manual"});if(!d.ok)throw Error(`Validation failed: ${d.status} ${d.statusText}`);let e=await d.json();j(e)}catch(a){j(void 0),console.error("CCDA validation error:",a)}finally{l(!1)}};return b?(0,e.jsxs)("div",{"data-testid":"ccda-iframe",style:{maxWidth:a.maxWidth},children:[(0,e.jsx)("div",{style:{minHeight:400},children:(0,e.jsx)("iframe",{title:"C-CDA Viewer",width:"100%",height:"400",ref:h,src:"https://ccda.medplum.com",allowFullScreen:!0,frameBorder:0,seamless:!0,onLoad:()=>g(!0)})}),(0,e.jsxs)("div",{style:{marginTop:"10px",marginBottom:"10px",display:"flex",alignItems:"center"},children:[(0,e.jsx)(t.Button,{type:"button",onClick:m,disabled:k,children:k?"Validating...":"Validate"}),i&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{style:{marginLeft:"15px"},children:[(0,e.jsx)("strong",{children:"Validation Results:"})," ",i?i.resultsMetaData.resultMetaData.filter(a=>a?.type.includes("Error")).reduce((a,b)=>a+(b.count||0),0):0," errors found"]}),(0,e.jsx)(t.Button,{type:"button",onClick:()=>{let a,b,c;i&&(a=new Blob([JSON.stringify(i,null,2)],{type:f.cME.JSON}),b=URL.createObjectURL(a),(c=document.createElement("a")).href=b,c.download="ccda-validation-results.json",document.body.appendChild(c),c.click(),URL.revokeObjectURL(b))},color:"green",style:{marginLeft:"auto"},children:"Download Full Results"})]})]})]}):null}function at(a){var b;let{contentType:c,url:d,title:g}=a.value??{},h=n(d);return h?(0,e.jsxs)("div",{"data-testid":"attachment-display",children:[c?.startsWith("image/")&&(0,e.jsx)("img",{"data-testid":"attachment-image",style:{maxWidth:a.maxWidth},src:h,alt:g}),c?.startsWith("video/")&&(0,e.jsx)("video",{"data-testid":"attachment-video",style:{maxWidth:a.maxWidth},controls:!0,children:(0,e.jsx)("source",{type:c,src:h})}),(c?.startsWith("text/")||"application/json"===c||"application/pdf"===c)&&(0,e.jsx)("div",{"data-testid":"attachment-iframe",style:{maxWidth:a.maxWidth,minHeight:400},children:(0,e.jsx)("iframe",{title:"Attachment",width:"100%",height:"400",src:h+"#navpanes=0",allowFullScreen:!0,frameBorder:0,seamless:!0})}),c===f.cME.CDA_XML&&(0,e.jsx)(as,{url:h}),(0,e.jsx)("div",{"data-testid":"download-link",style:{padding:"2px 16px 16px 16px"},children:(0,e.jsx)(s.Anchor,{href:d,"data-testid":"attachment-details",target:"_blank",rel:"noopener noreferrer",download:(b=g,b?.includes(".")?b:void 0),children:g||"Download"})})]}):null}ap.displayName="FormContext";var au={root:"DescriptionList_root",compact:"DescriptionList_compact"};function av(a){let{children:b,compact:c}=a;return(0,e.jsx)("dl",{className:am(au.root,{[au.compact]:c}),children:b})}function aw(a){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("dt",{children:a.term}),(0,e.jsx)("dd",{children:a.children})]})}function ax(a){let b=a.values?.map((b,c)=>(0,e.jsx)("div",{children:(0,e.jsx)(at,{value:b,maxWidth:a.maxWidth})},"attatchment-"+c)),c;if(a.includeDescriptionListEntry){if(void 0===a.property)throw Error("props.property is required when includeDescriptionListEntry is true");if(!(0,f.dI)(a.path))throw Error("props.path is required when includeDescriptionListEntry is true");let d=a.path.split(".").pop();c=(0,e.jsx)(aw,{term:(0,f.hq1)(d),children:b})}else c=(0,e.jsx)(e.Fragment,{children:b});return c}function ay(a){let b=(void 0).MEDPLUM_LOGO_URL;return b?(0,e.jsx)("img",{src:b,alt:"Logo",style:{maxHeight:a.size}}):(0,e.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 180 180",style:{width:a.size,height:a.size},children:[(0,e.jsx)("title",{children:"Medplum Logo"}),(0,e.jsx)("path",{fill:a.fill??"#9c36b5",d:"M84 56c-3-15-15-24-23-28l5-10c8 2 14 8 20 14 0-12 1-16 5-21 8-9 13-9 41-9 0 7 1 18-3 24-7 9-16 7-41 8 5 8 7 14 8 22 36-24 74-7 74 39 0 42-40 83-80 83s-80-41-80-83c0-46 38-63 74-39Zm-3 43H65c-4 0-7 3-7 7v4c0 4 3 7 7 7h16v16c0 4 3 7 7 7h4c4 0 7-3 7-7v-16h16c4 0 7-3 7-7v-4c0-4-3-7-7-7H99V83c0-4-3-7-7-7h-4c-4 0-7 3-7 7z"})]})}function az(a){let[b,c]=(0,d.useState)();return(0,e.jsx)(aq,{onSubmit:b=>{c(void 0),a.onSubmit(b)?.catch(a=>c((0,f.zWg)(a)))},children:(0,e.jsxs)(u.Stack,{children:[(0,e.jsxs)(v.Center,{style:{flexDirection:"column"},children:[(0,e.jsx)(ay,{size:32}),(0,e.jsx)(w.Title,{children:a.title})]}),b&&(0,e.jsx)(q.Alert,{icon:(0,e.jsx)(ah,{size:16}),title:"Error",color:"red",children:b}),a.qrCodeUrl&&(0,e.jsxs)(u.Stack,{align:"center",children:[(0,e.jsx)(x.Text,{children:"Scan this QR code with your authenticator app."}),(0,e.jsx)("img",{src:a.qrCodeUrl,alt:"Multi Factor Auth QR Code"})]}),(0,e.jsx)(u.Stack,{children:(0,e.jsx)(y.TextInput,{name:"token",label:"MFA code",autoComplete:"one-time-code",required:!0,autoFocus:!0})}),(0,e.jsx)(z.Group,{justify:"flex-end",mt:"xl",children:(0,e.jsx)(ar,{children:a.buttonText})})]})})}var aA={root:"Container_root"};function aB(a){let{children:b,...c}=a;return(0,e.jsx)(A.Container,{className:aA.root,...c,children:b})}var aC={paper:"Panel_paper",fill:"Panel_fill"};function aD(a){let{width:b,fill:c,className:d,children:f,...g}=a;return(0,e.jsx)(B.Paper,{className:am(aC.paper,c&&aC.fill,d),style:b?{maxWidth:b}:void 0,shadow:"sm",radius:"sm",withBorder:!0,...g,children:f})}function aE(a){let{children:b,...c}=a;return(0,e.jsx)(aB,{children:(0,e.jsx)(aD,{...c,children:b})})}function aF(a,b){return a?.issue?.filter(a=>aI(a.expression?.[0],b))?.map(a=>a.details?.text)?.join(`
`)}function aG(a,b){return a?.issue?.filter(a=>aI(a.expression?.[0],b))}var aH=/\[\d+\]/;function aI(a,b){if(("string"==typeof a&&aH.test(a))!==("string"==typeof b&&aH.test(b))&&(a=a?.replace(aH,""),b=b?.replace(aH,"")),a===b)return!0;if(!a||!b)return!1;let c=a.indexOf(".");if(c>=0&&a.substring(c+1)===b)return!0;let d=b.indexOf(".");return d>=0&&b.substring(d+1)===a}function aJ(a){let b=i(),[c,g]=(0,d.useState)();return(0,e.jsxs)(aq,{onSubmit:async c=>{try{a.handleAuthResponse(await b.startNewProject({login:a.login,projectName:c.projectName}))}catch(a){g((0,f.ZrK)(a))}},children:[(0,e.jsxs)(v.Center,{style:{flexDirection:"column"},children:[(0,e.jsx)(ay,{size:32}),(0,e.jsx)(w.Title,{children:"Create project"})]}),(0,e.jsxs)(u.Stack,{gap:"xl",children:[(0,e.jsx)(y.TextInput,{name:"projectName",label:"Project Name",placeholder:"My Project",required:!0,autoFocus:!0,error:aF(c,"projectName")}),(0,e.jsxs)(x.Text,{c:"dimmed",size:"xs",children:["By clicking submit you agree to the Medplum"," ",(0,e.jsx)(s.Anchor,{href:"https://www.medplum.com/privacy",children:"Privacy\xa0Policy"})," and ",(0,e.jsx)(s.Anchor,{href:"https://www.medplum.com/terms",children:"Terms\xa0of\xa0Service"}),"."]})]}),(0,e.jsx)(z.Group,{justify:"flex-end",mt:"xl",wrap:"nowrap",children:(0,e.jsx)(ar,{children:"Create project"})})]})}function aK(a){i();let{googleClientId:b,handleGoogleCredential:c}=a,f=(0,d.useRef)(null),[g,h]=(0,d.useState)("u">typeof google),[j,k]=(0,d.useState)(!1),[l,m]=(0,d.useState)(!1);return b?(0,e.jsx)("div",{ref:f}):null}function aL(a){let b=a.outcome?.issue||a.issues;return b&&0!==b.length?(0,e.jsx)(q.Alert,{icon:(0,e.jsx)(ah,{size:16}),color:"red",children:b.map(a=>(0,e.jsx)("div",{"data-testid":"text-field-error",children:(0,f.hMM)(a)},a.details?.text))}):null}var aM={userNotice:"AuthenticationForm_userNotice"};function aN(a){let[b,c]=(0,d.useState)();return b?(0,e.jsx)(aP,{email:b,resetEmail:()=>c(void 0),...a}):(0,e.jsx)(aO,{setEmail:c,...a})}function aO(a){let{setEmail:b,onRegister:c,handleAuthResponse:g,children:h,disableEmailAuth:j,...k}=a,l=i(),m=!a.disableGoogleAuth&&function(a){if(a)return a;let b=f.DA.getOrigin();if(b&&("undefined".split(",")??0).includes(b))return"undefined"}(a.googleClientId),[n,o]=(0,d.useState)(),p=aG(n,void 0),q=(0,d.useCallback)(async a=>{if(!a.authorizeUrl)return!1;let b=JSON.stringify({...await l.ensureCodeChallenge(k),domain:a.domain}),c=new URL(a.authorizeUrl);return c.searchParams.set("state",b),f.DA.assign(c.toString()),!0},[l,k]),r=(0,d.useCallback)(async a=>{let c=await l.post("auth/method",{email:a.email});await q(c)||b(a.email)},[l,q,b]),t=(0,d.useCallback)(async a=>{try{let b=await l.startGoogleLogin({...k,googleCredential:a.credential});await q(b)||g(b)}catch(a){o((0,f.ZrK)(a))}},[l,k,q,g]);return(0,e.jsxs)(aq,{onSubmit:r,children:[(0,e.jsx)(v.Center,{style:{flexDirection:"column"},children:h}),(0,e.jsx)(aL,{issues:p}),m&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(z.Group,{justify:"center",p:"xl",style:{height:70},children:(0,e.jsx)(aK,{googleClientId:m,handleGoogleCredential:t})}),!j&&(0,e.jsx)(D.Divider,{label:"or",labelPosition:"center",my:"lg"})]}),!j&&(0,e.jsx)(y.TextInput,{name:"email",type:"email",label:"Email",placeholder:"name@domain.com",required:!0,autoFocus:!0,error:aF(n,"email"),"data-testid":"auth.email"}),(0,e.jsxs)(z.Group,{justify:"space-between",mt:"xl",gap:0,wrap:"nowrap",children:[(0,e.jsx)("div",{children:c&&(0,e.jsx)(s.Anchor,{component:"button",type:"button",c:"dimmed",onClick:c,size:"xs","data-dashlane-ignore":"true","data-lp-ignore":"true","data-no-autofill":"true","data-form-type":"navigation",children:"Register"})}),!j&&(0,e.jsx)(ar,{children:"Next"})]})]})}function aP(a){let{onForgotPassword:b,handleAuthResponse:c,children:g,...h}=a,j=i(),[k,l]=(0,d.useState)(),m=aG(k,void 0),n=(0,d.useCallback)(a=>{j.startLogin({...h,password:a.password,remember:"on"===a.remember}).then(c).catch(a=>l((0,f.ZrK)(a)))},[j,h,c]);return(0,e.jsxs)(aq,{onSubmit:n,children:[(0,e.jsx)(v.Center,{style:{flexDirection:"column"},children:g}),(0,e.jsx)(aL,{issues:m}),(0,e.jsxs)(u.Stack,{gap:"sm",children:[(0,e.jsx)(E.PasswordInput,{name:"password",label:"Password",autoComplete:"off",required:!0,autoFocus:!0,error:aF(k,"password"),"data-testid":"auth.password"}),(0,e.jsxs)(F.Flex,{className:aM.userNotice,justify:"space-between",align:"center",px:"xs",bdrs:"sm",children:[(0,e.jsxs)(x.Text,{size:"xs",children:["Logging in as ",(0,e.jsx)("em",{children:a.email})]}),(0,e.jsx)(t.Button,{variant:"transparent",onClick:a.resetEmail,size:"compact-xs",children:"Change"})]})]}),(0,e.jsxs)(z.Group,{justify:"space-between",mt:"xl",gap:0,wrap:"nowrap",children:[b&&(0,e.jsx)(s.Anchor,{component:"button",type:"button",c:"dimmed",onClick:b,size:"xs",children:"Forgot password"}),(0,e.jsx)(G.Checkbox,{id:"remember",name:"remember",label:"Remember me",size:"xs",style:{lineHeight:1}}),(0,e.jsx)(ar,{children:"Sign in"})]})]})}function aQ(a){let b=i(),c=(0,H.useCombobox)(),[g,h]=(0,d.useState)(""),[j,k]=(0,d.useState)();function l(a){return!!a?.toLowerCase()?.includes(g.toLowerCase())}let m=a.memberships.filter(function(a){return l(a.profile?.display)||l(a.project?.display)}).slice(0,10).map(a=>(0,e.jsx)(I.Combobox.Option,{value:a.id,children:(0,e.jsx)(aR,{...a})},a.id));return(0,e.jsxs)(u.Stack,{children:[(0,e.jsxs)(F.Flex,{gap:"md",mb:"md",justify:"center",align:"center",direction:"column",wrap:"nowrap",children:[(0,e.jsx)(ay,{size:32}),(0,e.jsx)(w.Title,{order:3,children:"Choose profile"})]}),(0,e.jsx)(aL,{outcome:j}),(0,e.jsxs)(I.Combobox,{store:c,onOptionSubmit:function(c){b.post("auth/profile",{login:a.login,profile:c}).then(a.handleAuthResponse).catch(a=>k((0,f.ZrK)(a)))},children:[(0,e.jsx)(I.Combobox.EventsTarget,{children:(0,e.jsx)(y.TextInput,{placeholder:"Search",value:g,onChange:a=>{h(a.currentTarget.value),c.updateSelectedOptionIndex()}})}),(0,e.jsx)("div",{children:(0,e.jsx)(I.Combobox.Options,{children:m.length>0?m:(0,e.jsx)(I.Combobox.Empty,{children:"Nothing found..."})})})]})]})}function aR(a){let b=a.identifier?.find(a=>"https://medplum.com/identifier/label"===a.system)?.value;return(0,e.jsxs)(z.Group,{children:[(0,e.jsx)(r.Avatar,{radius:"xl"}),(0,e.jsxs)("div",{children:[(0,e.jsx)(x.Text,{fz:"sm",fw:500,children:a.profile?.display}),(0,e.jsxs)(x.Text,{fz:"xs",opacity:.6,children:[a.project?.display," ",b?` - ${b}`:""]})]})]})}var aS=/^patient\/Condition\.(?:\*|c?r?u?d?s?)$/,aT=/^patient\/Observation\.(?:\*|c?r?u?d?s?)$/;function aU(a){let b=i();return(0,e.jsx)(aq,{onSubmit:c=>{b.post("auth/scope",{login:a.login,scope:Object.keys(c).join(" ")}).then(a.handleAuthResponse).catch(console.log)},children:(0,e.jsxs)(u.Stack,{children:[(0,e.jsxs)(v.Center,{style:{flexDirection:"column"},children:[(0,e.jsx)(ay,{size:32}),(0,e.jsx)(w.Title,{children:"Choose scope"})]}),(0,e.jsx)(u.Stack,{children:(a.scope??"openid").split(" ").map(a=>{let b;return aS.test(a)?b=[a+"?category=http://terminology.hl7.org/CodeSystem/condition-category|encounter-diagnosis",a+"?category=http://terminology.hl7.org/CodeSystem/condition-category|problem-list-item",a+"?category=http://hl7.org/fhir/us/core/CodeSystem/condition-category|health-concern"]:aT.test(a)&&(b=[a+"?category=http://hl7.org/fhir/us/core/CodeSystem/us-core-observation-category|clinical-test",a+"?category=http://terminology.hl7.org/CodeSystem/observation-category|laboratory",a+"?category=http://terminology.hl7.org/CodeSystem/observation-category|social-history",a+"?category=http://hl7.org/fhir/us/core/CodeSystem/us-core-category|sdoh",a+"?category=http://terminology.hl7.org/CodeSystem/observation-category|survey",a+"?category=http://terminology.hl7.org/CodeSystem/observation-category|vital-signs"]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(G.Checkbox,{id:a,name:a,label:a,defaultChecked:!0},a),b?.map(a=>(0,e.jsx)(G.Checkbox,{id:a,name:a,label:a},a))]},a+"_group")})}),(0,e.jsx)(z.Group,{justify:"flex-end",mt:"xl",children:(0,e.jsx)(ar,{children:"Set scope"})})]})})}function aV(a){let{login:b,chooseScopes:c,onSuccess:g,onForgotPassword:h,onRegister:j,onCode:k,...l}=a,m=i(),[n,o]=(0,d.useState)(),[p,q]=((0,d.useRef)(!1),(0,d.useState)(!1)),[r,s]=(0,d.useState)(),[t,u]=(0,d.useState)(!1),[v,w]=(0,d.useState)(),x=(0,d.useCallback)(a=>{k?k(a):m.processCode(a).then(()=>{g&&g()}).catch(a=>(0,C.Ds)({color:"red",message:(0,f.zWg)(a)}))},[m,k,g]),y=(0,d.useCallback)(a=>{q(!!a.mfaEnrollRequired),s(a.enrollQrCode),u(!!a.mfaRequired),a.login&&o(a.login),a.memberships&&w(a.memberships),a.code&&(c?w(void 0):x(a.code))},[c,x]),z=(0,d.useCallback)(a=>{x(a.code)},[x]);return(0,e.jsx)(aE,{width:450,px:"sm",py:"md",children:n?p&&r?(0,e.jsx)(az,{title:"Enroll in MFA",buttonText:"Enroll",qrCodeUrl:r,onSubmit:async a=>{y(await m.post("auth/mfa/login-enroll",{login:n,token:a.token}))}}):t?(0,e.jsx)(az,{title:"Enter MFA code",buttonText:"Submit code",onSubmit:async a=>{y(await m.post("auth/mfa/verify",{login:n,token:a.token}))}}):v?(0,e.jsx)(aQ,{login:n,memberships:v,handleAuthResponse:y}):"new"===a.projectId?(0,e.jsx)(aJ,{login:n,handleAuthResponse:y}):a.chooseScopes?(0,e.jsx)(aU,{login:n,scope:a.scope,handleAuthResponse:z}):(0,e.jsx)("div",{children:"Success"}):(0,e.jsx)(aN,{onForgotPassword:h,onRegister:j,handleAuthResponse:y,disableGoogleAuth:a.disableGoogleAuth,disableEmailAuth:a.disableEmailAuth,...l,children:a.children})})}function aW(a){return(0,e.jsx)(e.Fragment,{children:(0,f.PDW)(a.value)})}function aX(a){return(0,e.jsx)(e.Fragment,{children:(0,f.amN)(a.value)})}function aY(a){let b=a.value;if(!b)return null;let c=[];return b.value&&c.push(b.value),(b.use||b.system)&&(c.push(" ["),b.use&&c.push(b.use),b.use&&b.system&&c.push(" "),b.system&&c.push(b.system),c.push("]")),(0,e.jsx)(e.Fragment,{children:c.join("").trim()})}function aZ(a){let b=a.value;return b?(0,e.jsxs)(e.Fragment,{children:[b.name,b.name&&": ",b.telecom?.map(a=>(0,e.jsx)(aY,{value:a},`telecom-${b.name}-${a.value}`))]}):null}function a$(a,b,c){let d=(0,f.Jsh)(a,b,{profileUrl:c});return d?Array.isArray(d)?[d.map(a=>a.value),d[0].type]:[d.value,d.type]:[void 0,"undefined"]}function a_(a){let{elementDefinitionType:b}=a,c=(i(),(0,d.useContext)(ad)),[g,h]=(0,d.useState)((0,f.h1O)("Extension")),j=(0,d.useMemo)(()=>{if((0,f.dI)(b?.profile))return b.profile[0]},[b]),[k,l]=(0,d.useState)(void 0!==j);if(j&&(k||!(0,f.hHN)(j)))return(0,e.jsx)("div",{children:"Loading..."});if(g.elements["value[x]"]?.max!==0){let[b,d]=a$({type:"Extension",value:a.value},"value[x]",j??c.profileUrl);return(0,e.jsx)(a9,{propertyType:d,value:b})}return(0,e.jsx)(bd,{path:a.path,value:{type:g.type,value:a.value},compact:a.compact,ignoreMissingValues:a.ignoreMissingValues,link:a.link,profileUrl:j})}function a0(a){return(0,e.jsxs)("div",{children:[a.value?.system,": ",a.value?.value]})}function a1(a){return(0,e.jsx)(e.Fragment,{children:(0,f.upu)(a.value)})}function a2(a){return(0,e.jsx)(e.Fragment,{children:(0,f.VZ2)(a.value)})}function a3(a){return(0,e.jsx)(e.Fragment,{children:(0,f.LuA)(a.value)})}function a4(a){let b=a.value;return b?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(a2,{value:b.numerator}),"\xa0/\xa0",(0,e.jsx)(a2,{value:b.denominator})]}):null}function a5(a){if(!a.value)return null;let b=a.value.display||a.value.reference||(0,f.AsM)(a.value);return!1!==a.link&&a.value.reference?(0,e.jsx)(an,{to:a.value,children:b}):(0,e.jsx)(e.Fragment,{children:b})}function a6(a,b,c){return void 0!==b?(0,e.jsx)(a,{value:b,children:c}):c}function a7(a){let{slice:b,property:c}=a,g=b.typeSchema?.elements??b.elements,h=(0,d.useContext)(ad),i=(0,d.useMemo)(()=>{if((0,f.dI)(g))return(0,f.bbl)({parentContext:h,elements:g,path:a.path,profileUrl:b.typeSchema?.url})},[h,a.path,b.typeSchema?.url,g]);return a6(ad.Provider,i,(0,e.jsx)(e.Fragment,{children:a.value.map((d,f)=>(0,e.jsx)("div",{children:(0,e.jsx)(a9,{property:c,path:a.path,arrayElement:!0,elementDefinitionType:b.type[0],propertyType:b.type[0].code,value:d,ignoreMissingValues:a.ignoreMissingValues,link:a.link})},`${f}-${a.value.length}`))}))}function a8(a){let b,{property:c,propertyType:g}=a,h=(i(),(0,d.useMemo)(()=>Array.isArray(a.values)?a.values:[],[a.values])),[j,k]=(0,d.useState)(!0),[l,m]=(0,d.useState)([]),[n,o]=(0,d.useState)(()=>[h]),[p,q]=(0,d.useState)(0);if((0,d.useContext)(ad),j)return(0,e.jsx)("div",{children:"Loading..."});if(c.type[0]?.code!=="Extension"){let d=n[l.length],h=d.map((b,f)=>(0,e.jsx)("div",{children:(0,e.jsx)(a9,{path:a.path,arrayElement:!0,property:c,propertyType:g,value:b,ignoreMissingValues:a.ignoreMissingValues,link:a.link})},`${f}-${d.length}`));if(a.includeDescriptionListEntry){if(!(0,f.dI)(a.path))throw Error("props.path is required when includeDescriptionListEntry is true");let c=a.path.split(".").pop();b=(0,e.jsx)(aw,{term:(0,f.hq1)(c),children:h})}else b=(0,e.jsx)(e.Fragment,{children:h})}return(0,e.jsxs)(e.Fragment,{children:[l.map((b,d)=>{if(!a.path)throw Error(`Displaying a resource property with slices of type ${a.propertyType} requires path`);let g=(0,e.jsx)(a7,{path:a.path,slice:b,property:c,value:n[d],ignoreMissingValues:a.ignoreMissingValues,link:a.link},b.name);return a.includeDescriptionListEntry&&(g=(0,e.jsx)(aw,{term:(0,f.hq1)(b.name),children:g},b.name)),g}),b,p>50&&(0,e.jsx)(z.Group,{justify:"right",children:(0,e.jsxs)(x.Text,{children:["... ",p," total values"]})})]})}function a9(a){let{property:b,propertyType:c,value:d}=a;if(b?.path?.endsWith(".id"))return(0,e.jsxs)(F.Flex,{gap:3,align:"center",children:[d,!(0,f.Ime)(d)&&(0,e.jsx)(J.CopyButton,{value:d,timeout:2e3,children:({copied:a,copy:b})=>(0,e.jsx)(K.Tooltip,{label:a?"Copied":"Copy",withArrow:!0,position:"right",children:(0,e.jsx)(L.ActionIcon,{variant:"subtle",color:a?"teal":"gray",onClick:b,children:a?(0,e.jsx)(ai,{size:"1rem"}):(0,e.jsx)(aj,{size:"1rem"})})})})]});if(b&&(b.isArray||b.max>1)&&!a.arrayElement)return c===f.UtL.Attachment?(0,e.jsx)(ax,{values:d,maxWidth:a.maxWidth,includeDescriptionListEntry:a.includeArrayDescriptionListEntry,property:b,path:a.path}):(0,e.jsx)(a8,{path:a.path,property:b,propertyType:c,values:d,includeDescriptionListEntry:a.includeArrayDescriptionListEntry,ignoreMissingValues:a.ignoreMissingValues,link:a.link});switch(c){case f.UtL.boolean:return(0,e.jsx)(e.Fragment,{children:void 0===d?"":(!!d).toString()});case f.UtL.SystemString:case f.UtL.string:return a.property?.path?.toLowerCase().includes("secret")?(0,e.jsx)(ba,{value:d}):(0,e.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:d});case f.UtL.code:case f.UtL.date:case f.UtL.decimal:case f.UtL.id:case f.UtL.integer:case f.UtL.positiveInt:case f.UtL.unsignedInt:case f.UtL.uri:case f.UtL.url:return(0,e.jsx)(e.Fragment,{children:d});case f.UtL.canonical:return(0,e.jsx)(a5,{value:{reference:d},link:a.link});case f.UtL.dateTime:case f.UtL.instant:return(0,e.jsx)(e.Fragment,{children:(0,f.r69)(d)});case f.UtL.markdown:return(0,e.jsx)("pre",{children:d});case f.UtL.Address:return(0,e.jsx)(aa,{value:d});case f.UtL.Annotation:return(0,e.jsx)(e.Fragment,{children:d?.text});case f.UtL.Attachment:return(0,e.jsx)(at,{value:d,maxWidth:a.maxWidth});case f.UtL.CodeableConcept:return(0,e.jsx)(aW,{value:d});case f.UtL.Coding:return(0,e.jsx)(aX,{value:d});case f.UtL.ContactDetail:return(0,e.jsx)(aZ,{value:d});case f.UtL.ContactPoint:return(0,e.jsx)(aY,{value:d});case f.UtL.HumanName:return(0,e.jsx)(ao,{value:d});case f.UtL.Identifier:return(0,e.jsx)(a0,{value:d});case f.UtL.Money:return(0,e.jsx)(a1,{value:d});case f.UtL.Period:return(0,e.jsx)(e.Fragment,{children:(0,f.dH3)(d)});case f.UtL.Quantity:case f.UtL.Duration:return(0,e.jsx)(a2,{value:d});case f.UtL.Range:return(0,e.jsx)(a3,{value:d});case f.UtL.Ratio:return(0,e.jsx)(a4,{value:d});case f.UtL.Reference:return(0,e.jsx)(a5,{value:d,link:a.link});case f.UtL.Timing:return(0,e.jsx)(e.Fragment,{children:(0,f.iwe)(d)});case f.UtL.Dosage:case f.UtL.UsageContext:if(!a.path)throw Error(`Displaying property of type ${a.propertyType} requires path`);return(0,e.jsx)(bd,{path:a.path,value:{type:c,value:d},compact:!0,ignoreMissingValues:a.ignoreMissingValues});case f.UtL.Extension:if(!a.path)throw Error(`Displaying property of type ${a.propertyType} requires path`);return(0,e.jsx)(a_,{path:a.path,value:d,compact:!0,ignoreMissingValues:a.ignoreMissingValues,elementDefinitionType:a.elementDefinitionType});default:if(!b)throw Error(`Displaying property of type ${a.propertyType} requires element schema`);if(!a.path)throw Error(`Displaying property of type ${a.propertyType} requires path`);return(0,e.jsx)(bd,{path:a.path,value:{type:b.type[0].code,value:d},compact:!0,ignoreMissingValues:a.ignoreMissingValues})}}function ba(a){let[b,c]=(0,d.useState)(!1),g=a.value??"",h=!(0,f.Ime)(g),i="â€¢".repeat(8);return(0,e.jsxs)(F.Flex,{gap:3,align:"center",children:[b?(0,e.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:g}):(0,e.jsx)("div",{style:{whiteSpace:"pre-wrap"},"aria-hidden":"true",children:h?i:""}),h&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(J.CopyButton,{value:a.value,timeout:2e3,children:({copied:a,copy:b})=>(0,e.jsx)(K.Tooltip,{label:a?"Copied":"Copy secret",withArrow:!0,position:"right",children:(0,e.jsx)(L.ActionIcon,{variant:"subtle",color:a?"teal":"gray",onClick:b,"aria-label":a?"Copied":"Copy secret",children:a?(0,e.jsx)(ai,{size:"1rem"}):(0,e.jsx)(aj,{size:"1rem"})})})}),(0,e.jsx)(K.Tooltip,{label:b?"Hide secret":"Show secret",withArrow:!0,position:"right",children:(0,e.jsx)(L.ActionIcon,{variant:"subtle",color:"gray",onClick:()=>c(!b),"aria-label":b?"Hide secret":"Show secret",children:b?(0,e.jsx)(ak,{size:"1rem"}):(0,e.jsx)(al,{size:"1rem"})})})]})]})}var bb=["extension","modifierExtension"],bc=ab.filter(a=>!bb.includes(a));function bd(a){let b=a.value,{value:c,type:g}=b,h=(0,d.useContext)(ad),i=a.profileUrl??h?.profileUrl,j=(0,d.useMemo)(()=>(0,f.kg4)(g,i),[i,g]),k=(0,d.useMemo)(()=>{if(j)return(0,f.bbl)({parentContext:h,elements:j.elements,path:a.path,profileUrl:j.url,accessPolicyResource:a.accessPolicyResource})},[j,h,a.path,a.accessPolicyResource]);if((0,f.Ime)(c))return null;if(!j)return(0,e.jsxs)("div",{children:[g,"\xa0not implemented"]});if("object"==typeof c&&"name"in c&&1===Object.keys(c).length&&"string"==typeof c.name)return(0,e.jsx)("div",{children:c.name});let l=k??h;return a6(ad.Provider,k,(0,e.jsx)(av,{compact:a.compact,children:Object.entries(l.elements).map(([c,d])=>{if(bb.includes(c)&&(0,f.Ime)(d.slicing?.slices)||bc.includes(c)||ac.includes(c)&&2===d.path.split(".").length||c.includes("."))return null;let[g,h]=a$(b,c,l.profileUrl);if((a.ignoreMissingValues||0===d.max)&&(0,f.Ime)(g)||a.path.endsWith(".extension")&&("url"===c||"id"===c))return null;let i=d.max>1||d.isArray,j=(0,e.jsx)(a9,{property:d,propertyType:h,path:a.path+"."+c,value:g,ignoreMissingValues:a.ignoreMissingValues,includeArrayDescriptionListEntry:i,link:a.link},c);return i?j:(0,e.jsx)(aw,{term:(0,f.hq1)(c),children:j},c)})}))}f.ypx;function be(a){let{profileUrl:b}=a,c=i().getAccessPolicy(),g=o(a.value),[h,j]=(0,d.useState)(!1),k=(0,d.useMemo)(()=>g&&(0,f.df0)(g,f.f_l.READ,c),[c,g]);return h&&g?(0,e.jsx)(bd,{path:g.resourceType,value:{type:g.resourceType,value:a.forceUseInput?a.value:g},profileUrl:b,ignoreMissingValues:a.ignoreMissingValues,accessPolicyResource:k}):null}((a,b,c)=>(c=null!=a?Q(U(a)):{},((a,b,c,d)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let e of T(b))V.call(a,e)||e===c||R(a,e,{get:()=>b[e],enumerable:!(d=S(b,e))||d.enumerable})})(!b&&a&&a.__esModule?c:R(c,"default",{value:a,enumerable:!0}),a)))(_(),1),f.XPK.EQUALS,f.XPK.NOT,f.XPK.CONTAINS,f.XPK.EXACT,f.XPK.EQUALS,f.XPK.NOT,f.XPK.CONTAINS,f.XPK.EXACT,f.XPK.EQUALS,f.XPK.NOT,f.XPK.EQUALS,f.XPK.NOT,f.XPK.EQUALS,f.XPK.NOT_EQUALS,f.XPK.GREATER_THAN,f.XPK.LESS_THAN,f.XPK.GREATER_THAN_OR_EQUALS,f.XPK.LESS_THAN_OR_EQUALS,f.XPK.EQUALS,f.XPK.NOT_EQUALS,f.XPK.GREATER_THAN,f.XPK.LESS_THAN,f.XPK.GREATER_THAN_OR_EQUALS,f.XPK.LESS_THAN_OR_EQUALS,f.XPK.EQUALS,f.XPK.NOT_EQUALS,f.XPK.GREATER_THAN,f.XPK.LESS_THAN,f.XPK.GREATER_THAN_OR_EQUALS,f.XPK.LESS_THAN_OR_EQUALS,f.XPK.STARTS_AFTER,f.XPK.ENDS_BEFORE,f.XPK.APPROXIMATELY,f.XPK.EQUALS,f.XPK.NOT_EQUALS,f.XPK.GREATER_THAN,f.XPK.LESS_THAN,f.XPK.GREATER_THAN_OR_EQUALS,f.XPK.LESS_THAN_OR_EQUALS,f.XPK.STARTS_AFTER,f.XPK.ENDS_BEFORE,f.XPK.APPROXIMATELY,f.XPK.EQUALS,f.XPK.NOT,f.XPK.ABOVE,f.XPK.BELOW,Event,Event,Event;var bf={root:"InfoBar_root",entry:"InfoBar_entry",key:"InfoBar_key",value:"InfoBar_value"};function bg(a){return(0,e.jsx)(P.ScrollArea,{children:(0,e.jsx)("div",{className:bf.root,children:a.children})})}bg.Entry=function(a){return(0,e.jsx)("div",{className:bf.entry,children:a.children})},bg.Key=function(a){return(0,e.jsx)("div",{className:bf.key,children:a.children})},bg.Value=function(a){return(0,e.jsx)("div",{className:bf.value,children:a.children})},f.cME.FHIR_JSON,f.cME.FHIR_JSON,f.cME.CDA_XML,f.cME.CDA_XML,f.ypx,f.Od0,f.Pzm,f.Pzm,f.Pzm},8461:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,48365,23)),Promise.resolve().then(c.t.bind(c,64596,23)),Promise.resolve().then(c.t.bind(c,56186,23)),Promise.resolve().then(c.t.bind(c,67805,23)),Promise.resolve().then(c.t.bind(c,27561,23)),Promise.resolve().then(c.t.bind(c,47569,23)),Promise.resolve().then(c.t.bind(c,42747,23)),Promise.resolve().then(c.t.bind(c,56676,23)),Promise.resolve().then(c.bind(c,97225))},10128:(a,b,c)=>{"use strict";c.d(b,{AEw:()=>ar,A_h:()=>a4,AsM:()=>au,DA:()=>b0,EpQ:()=>aK,HQo:()=>v,Ime:()=>av,Jsh:()=>X,LuA:()=>aS,M0D:()=>aJ,NCg:()=>a3,NmV:()=>cF,Od0:()=>n,PDW:()=>aV,Pzm:()=>l,SQA:()=>cz,UtL:()=>aZ,VZ2:()=>aT,XPK:()=>bO,ZcR:()=>cG,ZrK:()=>x,amN:()=>aW,bbl:()=>cD,c2A:()=>ax,cME:()=>b4,dH3:()=>aN,dI:()=>aw,df0:()=>b$,f_l:()=>bY,h1O:()=>J,hHN:()=>K,hMM:()=>A,hq1:()=>a0,iPK:()=>aq,iwe:()=>aR,kg4:()=>I,nKc:()=>L,p8P:()=>function a(b){if(!b)return"";let c=[];if(b.valueQuantity)c.push(aT(b.valueQuantity));else if(b.valueCodeableConcept)c.push(aV(b.valueCodeableConcept));else{let a=aX(b.valueString);a&&c.push(a)}return"component"in b&&c.push(b.component.map(b=>a(b)).join(" / ")),c.join(" / ").trim()},r69:()=>aM,upu:()=>aU,ypx:()=>m,zWg:()=>y});var d,e=Object.defineProperty,f=(a,b,c)=>((a,b,c)=>b in a?e(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c),g=class{constructor(a,b){f(this,"operator"),f(this,"child"),this.operator=a,this.child=b}toString(){return`${this.operator}(${this.child.toString()})`}},h=class{constructor(a,b,c){f(this,"operator"),f(this,"left"),f(this,"right"),this.operator=a,this.left=b,this.right=c}toString(){return`(${this.left.toString()} ${this.operator} ${this.right.toString()})`}},i=class{constructor(){f(this,"prefixParselets",{}),f(this,"infixParselets",{})}registerInfix(a,b){return this.infixParselets[a]=b,this}registerPrefix(a,b){return this.prefixParselets[a]=b,this}prefix(a,b,c){return this.registerPrefix(a,{parse:(a,d)=>c(d,a.consumeAndParse(b))})}infixLeft(a,b,c){return this.registerInfix(a,{parse:(a,d,e)=>c(d,e,a.consumeAndParse(b)),precedence:b})}construct(a){return new j(a,this.prefixParselets,this.infixParselets)}},j=class{constructor(a,b,c){f(this,"tokens"),f(this,"prefixParselets"),f(this,"infixParselets"),this.tokens=a,this.prefixParselets=b,this.infixParselets=c}hasMore(){return this.tokens.length>0}match(a){return this.peek()?.id===a&&(this.consume(),!0)}consumeAndParse(a=1/0){let b=this.consume(),c=this.prefixParselets[b.id];if(!c)throw Error(`Parse error at "${b.value}" (line ${b.line}, column ${b.column}). No matching prefix parselet.`);let d=c.parse(this,b);for(;a>this.getPrecedence();){let a=this.consume();d=this.getInfixParselet(a).parse(this,d,a)}return d}getPrecedence(){let a=this.peek();if(!a)return 1/0;let b=this.getInfixParselet(a);return b?b.precedence:1/0}consume(a,b){if(!this.tokens.length)throw Error("Cant consume unknown more tokens.");if(a&&this.peek()?.id!==a){let b=this.peek();throw Error(`Expected ${a} but got "${b.id}" (${b.value}) at line ${b.line} column ${b.column}.`)}if(b&&this.peek()?.value!==b){let a=this.peek();throw Error(`Expected "${b}" but got "${a.value}" at line ${a.line} column ${a.column}.`)}return this.tokens.shift()}peek(){return this.tokens.length>0?this.tokens[0]:void 0}removeComments(){this.tokens=this.tokens.filter(a=>"Comment"!==a.id)}getInfixParselet(a){return this.infixParselets["Symbol"===a.id?a.value:a.id]}},k=class{constructor(a=10){f(this,"max"),f(this,"cache"),this.max=a,this.cache=new Map}clear(){this.cache.clear()}get(a){let b=this.cache.get(a);return b&&(this.cache.delete(a),this.cache.set(a,b)),b}set(a,b){this.cache.has(a)?this.cache.delete(a):this.cache.size>=this.max&&this.cache.delete(this.first()),this.cache.set(a,b)}delete(a){this.cache.delete(a)}keys(){return this.cache.keys()}first(){return this.cache.keys().next().value}},l="http://snomed.info/sct",m="http://hl7.org",n="http://terminology.hl7.org",o={resourceType:"OperationOutcome",id:"not-found",issue:[{severity:"error",code:"not-found",details:{text:"Not found"}}]},p={resourceType:"OperationOutcome",id:"unauthorized",issue:[{severity:"error",code:"login",details:{text:"Unauthorized"}}]},q={...p,issue:[...p.issue,{severity:"error",code:"expired",details:{text:"Token expired"}}]},r={...p,issue:[...p.issue,{severity:"error",code:"invalid",details:{text:"Token not issued for this audience"}}]};function s(a,b){return{resourceType:"OperationOutcome",issue:[{severity:"error",code:"invalid",details:{text:a},...b?{expression:[b]}:void 0}]}}function t(a){return{resourceType:"OperationOutcome",issue:[{severity:"error",code:"structure",details:{text:a}}]}}function u(a){return"object"==typeof a&&null!==a&&"OperationOutcome"===a.resourceType}function v(a){return"ok"===a.id||"created"===a.id||"not-modified"===a.id||"accepted"===a.id}var w=class a extends Error{constructor(b,c){super(z(b),c),f(this,"outcome"),Object.setPrototypeOf(this,a.prototype),this.name=this.constructor.name,this.outcome=b,Error.captureStackTrace(this,this.constructor)}};function x(a){return a instanceof w?a.outcome:u(a)?a:s(y(a))}function y(a){return a?"string"==typeof a?a:a&&"object"==typeof a&&(a instanceof Error||"u">typeof DOMException&&a instanceof DOMException||"[object Error]"===Object.prototype.toString.call(a))?a.message:u(a)?z(a):"object"==typeof a&&"code"in a&&"string"==typeof a.code?a.code:JSON.stringify(a):"Unknown error"}function z(a){let b=a.issue?.map(A)??[];return b.length>0?b.join("; "):"Unknown error"}function A(a){let b;return b=a.details?.text?a.diagnostics?`${a.details.text} (${a.diagnostics})`:a.details.text:a.diagnostics?a.diagnostics:"Unknown error",a.expression?.length&&(b+=` (${a.expression.join(", ")})`),b}var B=function(a){let b=Object.create(null);for(let[c,d]of Object.entries(a))b[c]={name:c,type:c,path:c,elements:Object.fromEntries(Object.entries(d.elements).map(([a,b])=>[a,function(a,b){let c=b.max&&b.max===Number.MAX_SAFE_INTEGER?1/0:b.max;return{path:a,description:"",type:b.type??[],min:b.min??0,max:c??1,isArray:!!c&&c>1,constraints:[]}}(a,b)])),constraints:[],innerTypes:[]};return b}({Element:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]}}},BackboneElement:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},modifierExtension:{max:0x1fffffffffffff,type:[{code:"Extension"}]}}},Address:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},use:{type:[{code:"code"}]},type:{type:[{code:"code"}]},text:{type:[{code:"string"}]},line:{max:0x1fffffffffffff,type:[{code:"string"}]},city:{type:[{code:"string"}]},district:{type:[{code:"string"}]},state:{type:[{code:"string"}]},postalCode:{type:[{code:"string"}]},country:{type:[{code:"string"}]},period:{type:[{code:"Period"}]}}},Age:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},value:{type:[{code:"decimal"}]},comparator:{type:[{code:"code"}]},unit:{type:[{code:"string"}]},system:{type:[{code:"uri"}]},code:{type:[{code:"code"}]}}},Annotation:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},"author[x]":{type:[{code:"Reference",targetProfile:["http://hl7.org/fhir/StructureDefinition/Practitioner","http://hl7.org/fhir/StructureDefinition/Patient","http://hl7.org/fhir/StructureDefinition/RelatedPerson","http://hl7.org/fhir/StructureDefinition/Organization"]},{code:"string"}]},time:{type:[{code:"dateTime"}]},text:{min:1,type:[{code:"markdown"}]}}},Attachment:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},contentType:{type:[{code:"code"}]},language:{type:[{code:"code"}]},data:{type:[{code:"base64Binary"}]},url:{type:[{code:"url"}]},size:{type:[{code:"unsignedInt"}]},hash:{type:[{code:"base64Binary"}]},title:{type:[{code:"string"}]},creation:{type:[{code:"dateTime"}]}}},CodeableConcept:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},coding:{max:0x1fffffffffffff,type:[{code:"Coding"}]},text:{type:[{code:"string"}]}}},Coding:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},system:{type:[{code:"uri"}]},version:{type:[{code:"string"}]},code:{type:[{code:"code"}]},display:{type:[{code:"string"}]},userSelected:{type:[{code:"boolean"}]}}},ContactDetail:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},name:{type:[{code:"string"}]},telecom:{max:0x1fffffffffffff,type:[{code:"ContactPoint"}]}}},ContactPoint:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},system:{type:[{code:"code"}]},value:{type:[{code:"string"}]},use:{type:[{code:"code"}]},rank:{type:[{code:"positiveInt"}]},period:{type:[{code:"Period"}]}}},Contributor:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},type:{min:1,type:[{code:"code"}]},name:{min:1,type:[{code:"string"}]},contact:{max:0x1fffffffffffff,type:[{code:"ContactDetail"}]}}},Count:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},value:{type:[{code:"decimal"}]},comparator:{type:[{code:"code"}]},unit:{type:[{code:"string"}]},system:{type:[{code:"uri"}]},code:{type:[{code:"code"}]}}},DataRequirement:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},type:{min:1,type:[{code:"code"}]},profile:{max:0x1fffffffffffff,type:[{code:"canonical",targetProfile:["http://hl7.org/fhir/StructureDefinition/StructureDefinition"]}]},"subject[x]":{type:[{code:"CodeableConcept"},{code:"Reference",targetProfile:["http://hl7.org/fhir/StructureDefinition/Group"]}]},mustSupport:{max:0x1fffffffffffff,type:[{code:"string"}]},codeFilter:{max:0x1fffffffffffff,type:[{code:"DataRequirementCodeFilter"}]},dateFilter:{max:0x1fffffffffffff,type:[{code:"DataRequirementDateFilter"}]},limit:{type:[{code:"positiveInt"}]},sort:{max:0x1fffffffffffff,type:[{code:"DataRequirementSort"}]}}},DataRequirementCodeFilter:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},path:{type:[{code:"string"}]},searchParam:{type:[{code:"string"}]},valueSet:{type:[{code:"canonical",targetProfile:["http://hl7.org/fhir/StructureDefinition/ValueSet"]}]},code:{max:0x1fffffffffffff,type:[{code:"Coding"}]}}},DataRequirementDateFilter:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},path:{type:[{code:"string"}]},searchParam:{type:[{code:"string"}]},"value[x]":{type:[{code:"dateTime"},{code:"Period"},{code:"Duration"}]}}},DataRequirementSort:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},path:{min:1,type:[{code:"string"}]},direction:{min:1,type:[{code:"code"}]}}},Distance:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},value:{type:[{code:"decimal"}]},comparator:{type:[{code:"code"}]},unit:{type:[{code:"string"}]},system:{type:[{code:"uri"}]},code:{type:[{code:"code"}]}}},Dosage:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},modifierExtension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},sequence:{type:[{code:"integer"}]},text:{type:[{code:"string"}]},additionalInstruction:{max:0x1fffffffffffff,type:[{code:"CodeableConcept"}]},patientInstruction:{type:[{code:"string"}]},timing:{type:[{code:"Timing"}]},"asNeeded[x]":{type:[{code:"boolean"},{code:"CodeableConcept"}]},site:{type:[{code:"CodeableConcept"}]},route:{type:[{code:"CodeableConcept"}]},method:{type:[{code:"CodeableConcept"}]},doseAndRate:{max:0x1fffffffffffff,type:[{code:"DosageDoseAndRate"}]},maxDosePerPeriod:{type:[{code:"Ratio"}]},maxDosePerAdministration:{type:[{code:"Quantity",profile:["http://hl7.org/fhir/StructureDefinition/SimpleQuantity"]}]},maxDosePerLifetime:{type:[{code:"Quantity",profile:["http://hl7.org/fhir/StructureDefinition/SimpleQuantity"]}]}}},DosageDoseAndRate:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},type:{type:[{code:"CodeableConcept"}]},"dose[x]":{type:[{code:"Range"},{code:"Quantity",profile:["http://hl7.org/fhir/StructureDefinition/SimpleQuantity"]}]},"rate[x]":{type:[{code:"Ratio"},{code:"Range"},{code:"Quantity",profile:["http://hl7.org/fhir/StructureDefinition/SimpleQuantity"]}]}}},Duration:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},value:{type:[{code:"decimal"}]},comparator:{type:[{code:"code"}]},unit:{type:[{code:"string"}]},system:{type:[{code:"uri"}]},code:{type:[{code:"code"}]}}},ElementDefinition:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},modifierExtension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},path:{min:1,type:[{code:"string"}]},representation:{max:0x1fffffffffffff,type:[{code:"code"}]},sliceName:{type:[{code:"string"}]},sliceIsConstraining:{type:[{code:"boolean"}]},label:{type:[{code:"string"}]},code:{max:0x1fffffffffffff,type:[{code:"Coding"}]},slicing:{type:[{code:"ElementDefinitionSlicing"}]},short:{type:[{code:"string"}]},definition:{type:[{code:"markdown"}]},comment:{type:[{code:"markdown"}]},requirements:{type:[{code:"markdown"}]},alias:{max:0x1fffffffffffff,type:[{code:"string"}]},min:{type:[{code:"unsignedInt"}]},max:{type:[{code:"string"}]},base:{type:[{code:"ElementDefinitionBase"}]},contentReference:{type:[{code:"uri"}]},type:{max:0x1fffffffffffff,type:[{code:"ElementDefinitionType"}]},"defaultValue[x]":{type:[{code:"base64Binary"},{code:"boolean"},{code:"canonical"},{code:"code"},{code:"date"},{code:"dateTime"},{code:"decimal"},{code:"id"},{code:"instant"},{code:"integer"},{code:"markdown"},{code:"oid"},{code:"positiveInt"},{code:"string"},{code:"time"},{code:"unsignedInt"},{code:"uri"},{code:"url"},{code:"uuid"},{code:"Address"},{code:"Age"},{code:"Annotation"},{code:"Attachment"},{code:"CodeableConcept"},{code:"Coding"},{code:"ContactPoint"},{code:"Count"},{code:"Distance"},{code:"Duration"},{code:"HumanName"},{code:"Identifier"},{code:"Money"},{code:"Period"},{code:"Quantity"},{code:"Range"},{code:"Ratio"},{code:"Reference"},{code:"SampledData"},{code:"Signature"},{code:"Timing"},{code:"ContactDetail"},{code:"Contributor"},{code:"DataRequirement"},{code:"Expression"},{code:"ParameterDefinition"},{code:"RelatedArtifact"},{code:"TriggerDefinition"},{code:"UsageContext"},{code:"Dosage"},{code:"Meta"}]},meaningWhenMissing:{type:[{code:"markdown"}]},orderMeaning:{type:[{code:"string"}]},"fixed[x]":{type:[{code:"base64Binary"},{code:"boolean"},{code:"canonical"},{code:"code"},{code:"date"},{code:"dateTime"},{code:"decimal"},{code:"id"},{code:"instant"},{code:"integer"},{code:"markdown"},{code:"oid"},{code:"positiveInt"},{code:"string"},{code:"time"},{code:"unsignedInt"},{code:"uri"},{code:"url"},{code:"uuid"},{code:"Address"},{code:"Age"},{code:"Annotation"},{code:"Attachment"},{code:"CodeableConcept"},{code:"Coding"},{code:"ContactPoint"},{code:"Count"},{code:"Distance"},{code:"Duration"},{code:"HumanName"},{code:"Identifier"},{code:"Money"},{code:"Period"},{code:"Quantity"},{code:"Range"},{code:"Ratio"},{code:"Reference"},{code:"SampledData"},{code:"Signature"},{code:"Timing"},{code:"ContactDetail"},{code:"Contributor"},{code:"DataRequirement"},{code:"Expression"},{code:"ParameterDefinition"},{code:"RelatedArtifact"},{code:"TriggerDefinition"},{code:"UsageContext"},{code:"Dosage"},{code:"Meta"}]},"pattern[x]":{type:[{code:"base64Binary"},{code:"boolean"},{code:"canonical"},{code:"code"},{code:"date"},{code:"dateTime"},{code:"decimal"},{code:"id"},{code:"instant"},{code:"integer"},{code:"markdown"},{code:"oid"},{code:"positiveInt"},{code:"string"},{code:"time"},{code:"unsignedInt"},{code:"uri"},{code:"url"},{code:"uuid"},{code:"Address"},{code:"Age"},{code:"Annotation"},{code:"Attachment"},{code:"CodeableConcept"},{code:"Coding"},{code:"ContactPoint"},{code:"Count"},{code:"Distance"},{code:"Duration"},{code:"HumanName"},{code:"Identifier"},{code:"Money"},{code:"Period"},{code:"Quantity"},{code:"Range"},{code:"Ratio"},{code:"Reference"},{code:"SampledData"},{code:"Signature"},{code:"Timing"},{code:"ContactDetail"},{code:"Contributor"},{code:"DataRequirement"},{code:"Expression"},{code:"ParameterDefinition"},{code:"RelatedArtifact"},{code:"TriggerDefinition"},{code:"UsageContext"},{code:"Dosage"},{code:"Meta"}]},example:{max:0x1fffffffffffff,type:[{code:"ElementDefinitionExample"}]},"minValue[x]":{type:[{code:"date"},{code:"dateTime"},{code:"instant"},{code:"time"},{code:"decimal"},{code:"integer"},{code:"positiveInt"},{code:"unsignedInt"},{code:"Quantity"}]},"maxValue[x]":{type:[{code:"date"},{code:"dateTime"},{code:"instant"},{code:"time"},{code:"decimal"},{code:"integer"},{code:"positiveInt"},{code:"unsignedInt"},{code:"Quantity"}]},maxLength:{type:[{code:"integer"}]},condition:{max:0x1fffffffffffff,type:[{code:"id"}]},constraint:{max:0x1fffffffffffff,type:[{code:"ElementDefinitionConstraint"}]},mustSupport:{type:[{code:"boolean"}]},isModifier:{type:[{code:"boolean"}]},isModifierReason:{type:[{code:"string"}]},isSummary:{type:[{code:"boolean"}]},binding:{type:[{code:"ElementDefinitionBinding"}]},mapping:{max:0x1fffffffffffff,type:[{code:"ElementDefinitionMapping"}]}}},ElementDefinitionSlicingDiscriminator:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},type:{min:1,type:[{code:"code"}]},path:{min:1,type:[{code:"string"}]}}},ElementDefinitionSlicing:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},discriminator:{max:0x1fffffffffffff,type:[{code:"ElementDefinitionSlicingDiscriminator"}]},description:{type:[{code:"string"}]},ordered:{type:[{code:"boolean"}]},rules:{min:1,type:[{code:"code"}]}}},ElementDefinitionBase:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},path:{min:1,type:[{code:"string"}]},min:{min:1,type:[{code:"unsignedInt"}]},max:{min:1,type:[{code:"string"}]}}},ElementDefinitionType:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},code:{min:1,type:[{code:"uri"}]},profile:{max:0x1fffffffffffff,type:[{code:"canonical",targetProfile:["http://hl7.org/fhir/StructureDefinition/StructureDefinition","http://hl7.org/fhir/StructureDefinition/ImplementationGuide"]}]},targetProfile:{max:0x1fffffffffffff,type:[{code:"canonical",targetProfile:["http://hl7.org/fhir/StructureDefinition/StructureDefinition","http://hl7.org/fhir/StructureDefinition/ImplementationGuide"]}]},aggregation:{max:0x1fffffffffffff,type:[{code:"code"}]},versioning:{type:[{code:"code"}]}}},ElementDefinitionExample:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},label:{min:1,type:[{code:"string"}]},"value[x]":{min:1,type:[{code:"base64Binary"},{code:"boolean"},{code:"canonical"},{code:"code"},{code:"date"},{code:"dateTime"},{code:"decimal"},{code:"id"},{code:"instant"},{code:"integer"},{code:"markdown"},{code:"oid"},{code:"positiveInt"},{code:"string"},{code:"time"},{code:"unsignedInt"},{code:"uri"},{code:"url"},{code:"uuid"},{code:"Address"},{code:"Age"},{code:"Annotation"},{code:"Attachment"},{code:"CodeableConcept"},{code:"Coding"},{code:"ContactPoint"},{code:"Count"},{code:"Distance"},{code:"Duration"},{code:"HumanName"},{code:"Identifier"},{code:"Money"},{code:"Period"},{code:"Quantity"},{code:"Range"},{code:"Ratio"},{code:"Reference"},{code:"SampledData"},{code:"Signature"},{code:"Timing"},{code:"ContactDetail"},{code:"Contributor"},{code:"DataRequirement"},{code:"Expression"},{code:"ParameterDefinition"},{code:"RelatedArtifact"},{code:"TriggerDefinition"},{code:"UsageContext"},{code:"Dosage"},{code:"Meta"}]}}},ElementDefinitionConstraint:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},key:{min:1,type:[{code:"id"}]},requirements:{type:[{code:"string"}]},severity:{min:1,type:[{code:"code"}]},human:{min:1,type:[{code:"string"}]},expression:{type:[{code:"string"}]},xpath:{type:[{code:"string"}]},source:{type:[{code:"canonical",targetProfile:["http://hl7.org/fhir/StructureDefinition/StructureDefinition"]}]}}},ElementDefinitionBinding:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},strength:{min:1,type:[{code:"code"}]},description:{type:[{code:"string"}]},valueSet:{type:[{code:"canonical",targetProfile:["http://hl7.org/fhir/StructureDefinition/ValueSet"]}]}}},ElementDefinitionMapping:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},identity:{min:1,type:[{code:"id"}]},language:{type:[{code:"code"}]},map:{min:1,type:[{code:"string"}]},comment:{type:[{code:"string"}]}}},Expression:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},description:{type:[{code:"string"}]},name:{type:[{code:"id"}]},language:{min:1,type:[{code:"code"}]},expression:{type:[{code:"string"}]},reference:{type:[{code:"uri"}]}}},Extension:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},url:{min:1,type:[{code:"uri"}]},"value[x]":{type:[{code:"base64Binary"},{code:"boolean"},{code:"canonical"},{code:"code"},{code:"date"},{code:"dateTime"},{code:"decimal"},{code:"id"},{code:"instant"},{code:"integer"},{code:"markdown"},{code:"oid"},{code:"positiveInt"},{code:"string"},{code:"time"},{code:"unsignedInt"},{code:"uri"},{code:"url"},{code:"uuid"},{code:"Address"},{code:"Age"},{code:"Annotation"},{code:"Attachment"},{code:"CodeableConcept"},{code:"Coding"},{code:"ContactPoint"},{code:"Count"},{code:"Distance"},{code:"Duration"},{code:"HumanName"},{code:"Identifier"},{code:"Money"},{code:"Period"},{code:"Quantity"},{code:"Range"},{code:"Ratio"},{code:"Reference"},{code:"SampledData"},{code:"Signature"},{code:"Timing"},{code:"ContactDetail"},{code:"Contributor"},{code:"DataRequirement"},{code:"Expression"},{code:"ParameterDefinition"},{code:"RelatedArtifact"},{code:"TriggerDefinition"},{code:"UsageContext"},{code:"Dosage"},{code:"Meta"}]}}},HumanName:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},use:{type:[{code:"code"}]},text:{type:[{code:"string"}]},family:{type:[{code:"string"}]},given:{max:0x1fffffffffffff,type:[{code:"string"}]},prefix:{max:0x1fffffffffffff,type:[{code:"string"}]},suffix:{max:0x1fffffffffffff,type:[{code:"string"}]},period:{type:[{code:"Period"}]}}},Identifier:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},use:{type:[{code:"code"}]},type:{type:[{code:"CodeableConcept"}]},system:{type:[{code:"uri"}]},value:{type:[{code:"string"}]},period:{type:[{code:"Period"}]},assigner:{type:[{code:"Reference",targetProfile:["http://hl7.org/fhir/StructureDefinition/Organization"]}]}}},MarketingStatus:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},modifierExtension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},country:{min:1,type:[{code:"CodeableConcept"}]},jurisdiction:{type:[{code:"CodeableConcept"}]},status:{min:1,type:[{code:"CodeableConcept"}]},dateRange:{min:1,type:[{code:"Period"}]},restoreDate:{type:[{code:"dateTime"}]}}},Meta:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},versionId:{type:[{code:"id"}]},lastUpdated:{type:[{code:"instant"}]},source:{type:[{code:"uri"}]},profile:{max:0x1fffffffffffff,type:[{code:"canonical",targetProfile:["http://hl7.org/fhir/StructureDefinition/StructureDefinition"]}]},security:{max:0x1fffffffffffff,type:[{code:"Coding"}]},tag:{max:0x1fffffffffffff,type:[{code:"Coding"}]},project:{type:[{code:"uri"}]},author:{type:[{code:"Reference"}]},onBehalfOf:{type:[{code:"Reference"}]},account:{type:[{code:"Reference"}]},accounts:{max:0x1fffffffffffff,type:[{code:"Reference"}]},compartment:{max:0x1fffffffffffff,type:[{code:"Reference"}]}}},Money:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},value:{type:[{code:"decimal"}]},currency:{type:[{code:"code"}]}}},Narrative:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},status:{min:1,type:[{code:"code"}]},div:{min:1,type:[{code:"xhtml"}]}}},ParameterDefinition:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},name:{type:[{code:"code"}]},use:{min:1,type:[{code:"code"}]},min:{type:[{code:"integer"}]},max:{type:[{code:"string"}]},documentation:{type:[{code:"string"}]},type:{min:1,type:[{code:"code"}]},profile:{type:[{code:"canonical",targetProfile:["http://hl7.org/fhir/StructureDefinition/StructureDefinition"]}]}}},Period:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},start:{type:[{code:"dateTime"}]},end:{type:[{code:"dateTime"}]}}},Population:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},modifierExtension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},"age[x]":{type:[{code:"Range"},{code:"CodeableConcept"}]},gender:{type:[{code:"CodeableConcept"}]},race:{type:[{code:"CodeableConcept"}]},physiologicalCondition:{type:[{code:"CodeableConcept"}]}}},ProdCharacteristic:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},modifierExtension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},height:{type:[{code:"Quantity"}]},width:{type:[{code:"Quantity"}]},depth:{type:[{code:"Quantity"}]},weight:{type:[{code:"Quantity"}]},nominalVolume:{type:[{code:"Quantity"}]},externalDiameter:{type:[{code:"Quantity"}]},shape:{type:[{code:"string"}]},color:{max:0x1fffffffffffff,type:[{code:"string"}]},imprint:{max:0x1fffffffffffff,type:[{code:"string"}]},image:{max:0x1fffffffffffff,type:[{code:"Attachment"}]},scoring:{type:[{code:"CodeableConcept"}]}}},ProductShelfLife:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},modifierExtension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},identifier:{type:[{code:"Identifier"}]},type:{min:1,type:[{code:"CodeableConcept"}]},period:{min:1,type:[{code:"Quantity"}]},specialPrecautionsForStorage:{max:0x1fffffffffffff,type:[{code:"CodeableConcept"}]}}},Quantity:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},value:{type:[{code:"decimal"}]},comparator:{type:[{code:"code"}]},unit:{type:[{code:"string"}]},system:{type:[{code:"uri"}]},code:{type:[{code:"code"}]}}},Range:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},low:{type:[{code:"Quantity",profile:["http://hl7.org/fhir/StructureDefinition/SimpleQuantity"]}]},high:{type:[{code:"Quantity",profile:["http://hl7.org/fhir/StructureDefinition/SimpleQuantity"]}]}}},Ratio:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},numerator:{type:[{code:"Quantity"}]},denominator:{type:[{code:"Quantity"}]}}},Reference:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},reference:{type:[{code:"string"}]},type:{type:[{code:"uri"}]},identifier:{type:[{code:"Identifier"}]},display:{type:[{code:"string"}]}}},RelatedArtifact:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},type:{min:1,type:[{code:"code"}]},label:{type:[{code:"string"}]},display:{type:[{code:"string"}]},citation:{type:[{code:"markdown"}]},url:{type:[{code:"url"}]},document:{type:[{code:"Attachment"}]},resource:{type:[{code:"canonical",targetProfile:["http://hl7.org/fhir/StructureDefinition/Resource"]}]}}},SampledData:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},origin:{min:1,type:[{code:"Quantity",profile:["http://hl7.org/fhir/StructureDefinition/SimpleQuantity"]}]},period:{min:1,type:[{code:"decimal"}]},factor:{type:[{code:"decimal"}]},lowerLimit:{type:[{code:"decimal"}]},upperLimit:{type:[{code:"decimal"}]},dimensions:{min:1,type:[{code:"positiveInt"}]},data:{type:[{code:"string"}]}}},Signature:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},type:{min:1,max:0x1fffffffffffff,type:[{code:"Coding"}]},when:{min:1,type:[{code:"instant"}]},who:{min:1,type:[{code:"Reference",targetProfile:["http://hl7.org/fhir/StructureDefinition/Practitioner","http://hl7.org/fhir/StructureDefinition/PractitionerRole","http://hl7.org/fhir/StructureDefinition/RelatedPerson","http://hl7.org/fhir/StructureDefinition/Patient","http://hl7.org/fhir/StructureDefinition/Device","http://hl7.org/fhir/StructureDefinition/Organization"]}]},onBehalfOf:{type:[{code:"Reference",targetProfile:["http://hl7.org/fhir/StructureDefinition/Practitioner","http://hl7.org/fhir/StructureDefinition/PractitionerRole","http://hl7.org/fhir/StructureDefinition/RelatedPerson","http://hl7.org/fhir/StructureDefinition/Patient","http://hl7.org/fhir/StructureDefinition/Device","http://hl7.org/fhir/StructureDefinition/Organization"]}]},targetFormat:{type:[{code:"code"}]},sigFormat:{type:[{code:"code"}]},data:{type:[{code:"base64Binary"}]}}},SubstanceAmount:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},modifierExtension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},"amount[x]":{type:[{code:"Quantity"},{code:"Range"},{code:"string"}]},amountType:{type:[{code:"CodeableConcept"}]},amountText:{type:[{code:"string"}]},referenceRange:{type:[{code:"SubstanceAmountReferenceRange"}]}}},SubstanceAmountReferenceRange:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},lowLimit:{type:[{code:"Quantity"}]},highLimit:{type:[{code:"Quantity"}]}}},Timing:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},modifierExtension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},event:{max:0x1fffffffffffff,type:[{code:"dateTime"}]},repeat:{type:[{code:"TimingRepeat"}]},code:{type:[{code:"CodeableConcept"}]}}},TimingRepeat:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},"bounds[x]":{type:[{code:"Duration"},{code:"Range"},{code:"Period"}]},count:{type:[{code:"positiveInt"}]},countMax:{type:[{code:"positiveInt"}]},duration:{type:[{code:"decimal"}]},durationMax:{type:[{code:"decimal"}]},durationUnit:{type:[{code:"code"}]},frequency:{type:[{code:"positiveInt"}]},frequencyMax:{type:[{code:"positiveInt"}]},period:{type:[{code:"decimal"}]},periodMax:{type:[{code:"decimal"}]},periodUnit:{type:[{code:"code"}]},dayOfWeek:{max:0x1fffffffffffff,type:[{code:"code"}]},timeOfDay:{max:0x1fffffffffffff,type:[{code:"time"}]},when:{max:0x1fffffffffffff,type:[{code:"code"}]},offset:{type:[{code:"unsignedInt"}]}}},TriggerDefinition:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},type:{min:1,type:[{code:"code"}]},name:{type:[{code:"string"}]},"timing[x]":{type:[{code:"Timing"},{code:"Reference",targetProfile:["http://hl7.org/fhir/StructureDefinition/Schedule"]},{code:"date"},{code:"dateTime"}]},data:{max:0x1fffffffffffff,type:[{code:"DataRequirement"}]},condition:{type:[{code:"Expression"}]}}},UsageContext:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},code:{min:1,type:[{code:"Coding"}]},"value[x]":{min:1,type:[{code:"CodeableConcept"},{code:"Quantity"},{code:"Range"},{code:"Reference",targetProfile:["http://hl7.org/fhir/StructureDefinition/PlanDefinition","http://hl7.org/fhir/StructureDefinition/ResearchStudy","http://hl7.org/fhir/StructureDefinition/InsurancePlan","http://hl7.org/fhir/StructureDefinition/HealthcareService","http://hl7.org/fhir/StructureDefinition/Group","http://hl7.org/fhir/StructureDefinition/Location","http://hl7.org/fhir/StructureDefinition/Organization"]}]}}},MoneyQuantity:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},value:{type:[{code:"decimal"}]},comparator:{type:[{code:"code"}]},unit:{type:[{code:"string"}]},system:{type:[{code:"uri"}]},code:{type:[{code:"code"}]}}},SimpleQuantity:{elements:{id:{type:[{code:"string"}]},extension:{max:0x1fffffffffffff,type:[{code:"Extension"}]},value:{type:[{code:"decimal"}]},comparator:{max:0,type:[{code:"code"}]},unit:{type:[{code:"string"}]},system:{type:[{code:"uri"}]},code:{type:[{code:"code"}]}}},IdentityProvider:{elements:{authorizeUrl:{min:1,type:[{code:"string"}]},tokenUrl:{min:1,type:[{code:"string"}]},tokenAuthMethod:{type:[{code:"code"}]},userInfoUrl:{min:1,type:[{code:"string"}]},clientId:{min:1,type:[{code:"string"}]},clientSecret:{min:1,type:[{code:"string"}]},usePkce:{type:[{code:"boolean"}]},useSubject:{type:[{code:"boolean"}]}}}}),C=Object.create(null),D=Object.create(null),E={"http://hl7.org/fhir/StructureDefinition/MoneyQuantity":"MoneyQuantity","http://hl7.org/fhir/StructureDefinition/SimpleQuantity":"SimpleQuantity","http://hl7.org/fhir/uv/sql-on-fhir/StructureDefinition/ViewDefinition":"ViewDefinition"};function F(a){let b;return(b=D[a])||(b=D[a]=Object.create(null)),b}function G(a){let b=(Array.isArray(a)?a:a.entry?.map(a=>a.resource)??[]).filter(a=>a?.resourceType==="StructureDefinition");for(let a of(function(a){for(let b of Array.isArray(a)?a:a.entry?.map(a=>a.resource)??[])b?.resourceType==="StructureDefinition"&&"resource"===b.kind&&a$(b.type)}(b),b))H(a)}function H(a){if(!a?.name)throw Error("Failed loading StructureDefinition from bundle");if("StructureDefinition"!==a.resourceType)return;let b=new M(a).parse(),c=E[a.url],d,e;for(let f of(c?(d=B,e=c):(d=a.url===`http://hl7.org/fhir/StructureDefinition/${a.type}`||a.url===`https://medplum.com/fhir/StructureDefinition/${a.type}`||a.type?.startsWith("http://")||a.type?.startsWith("https://")?B:F(a.url),e=a.type),d[e]=b,b.innerTypes))f.parentType=b,d[f.name]=f;C[a.url]=b}function I(a,b){if(b){let c=F(b)[a];if(c)return c}return B[a]}function J(a,b){let c=I(a,b);if(!c)throw new w(s("Unknown data type: "+a));return c}function K(a){return!!C[a]}function L(a){return C[a]}var M=class{constructor(a){if(f(this,"root"),f(this,"elements"),f(this,"elementIndex"),f(this,"index"),f(this,"resourceSchema"),f(this,"slicingContext"),f(this,"innerTypes"),f(this,"backboneContext"),!a.snapshot?.element||0===a.snapshot.element.length)throw Error(`No snapshot defined for StructureDefinition '${a.name}'`);this.root=a.snapshot.element[0],this.elements=a.snapshot.element.slice(1),this.elementIndex=Object.create(null),this.index=0,this.resourceSchema={name:a.name,path:this.root.path,title:a.title,type:a.type,url:a.url,version:a.version,kind:a.kind,description:function(a){let b=a.description;return b?.startsWith(`Base StructureDefinition for ${a.name} Type: `)&&(b=b.substring(`Base StructureDefinition for ${a.name} Type: `.length)),b}(a),elements:{},constraints:this.parseElementDefinition(this.root).constraints,innerTypes:[],summaryProperties:new Set,mandatoryProperties:new Set},this.innerTypes=[]}parse(){let a=this.next();for(;a;){if(a.sliceName)this.parseSliceStart(a);else if(a.id?.includes(":")){if(this.slicingContext?.current){let b=O(a,this.slicingContext.path);this.slicingContext.current.elements[b]=this.parseElementDefinition(a)}}else{let b=this.parseElementDefinition(a);this.checkFieldEnter(a,b);let c=this.backboneContext;for(;c;){if(a.path?.startsWith(c.path+".")){c.type.elements[O(a,c.path)]=b;break}c=c.parent}if(!c){let c=O(a,this.root.path);a.isSummary&&this.resourceSchema.summaryProperties?.add(c.replace("[x]","")),b.min>0&&this.resourceSchema.mandatoryProperties?.add(c.replace("[x]","")),this.resourceSchema.elements[c]=b}this.checkFieldExit(a)}a=this.next()}return this.checkFieldExit(),this.innerTypes.length>0&&(this.resourceSchema.innerTypes=this.innerTypes),this.resourceSchema}checkFieldEnter(a,b){this.isInnerType(a)&&this.enterInnerType(a),this.slicingContext&&!P(this.slicingContext.path,a?.path)&&(this.slicingContext=void 0),a.slicing&&!this.slicingContext&&this.enterSlice(a,b)}enterInnerType(a){for(;this.backboneContext&&!P(this.backboneContext?.path,a.path);)this.innerTypes.push(this.backboneContext.type),this.backboneContext=this.backboneContext.parent;let b=a_(a);this.backboneContext={type:{name:b,type:b,path:a.path,title:a.label,description:a.definition,elements:{},constraints:this.parseElementDefinition(a).constraints,innerTypes:[]},path:a.path,parent:P(this.backboneContext?.path,a.path)?this.backboneContext:this.backboneContext?.parent}}enterSlice(a,b){var c;let d;c=a,d=c.slicing?.discriminator,c.type?.some(a=>"Extension"===a.code)&&d?.length===1&&"value"===d[0].type&&"url"===d[0].path&&!this.peek()?.sliceName||(b.slicing={discriminator:(a.slicing?.discriminator??[]).map(a=>{if("value"!==a.type&&"pattern"!==a.type&&"type"!==a.type)throw Error(`Unsupported slicing discriminator type: ${a.type}`);return{path:a.path,type:a.type}}),slices:[],ordered:a.slicing?.ordered??!1,rule:a.slicing?.rules},this.slicingContext={field:b.slicing,path:a.path??""})}checkFieldExit(a){if(this.backboneContext&&!P(this.backboneContext.path,a?.path))if(this.backboneContext.parent)do this.innerTypes.push(this.backboneContext.type),this.backboneContext=this.backboneContext.parent;while(this.backboneContext&&!P(this.backboneContext.path,a?.path));else this.innerTypes.push(this.backboneContext.type),this.backboneContext=void 0}next(){let a=this.peek();if(a)return this.index++,a}peek(){let a=this.elements[this.index];if(a){if(this.elementIndex[a.path??""]=a,a.contentReference){let b=a.contentReference.slice(a.contentReference.indexOf("#")+1),c=this.elementIndex[b];return c?{...c,id:a.id,path:a.path,min:a.min??c.min,max:a.max??c.max,base:{path:c.base?.path??b,min:a.base?.min??c.base?.min??c.min,max:a.base?.max??c.base?.max??c.max},contentReference:a.contentReference,definition:a.definition}:void 0}return a}}isInnerType(a){let b=this.peek();return!!(P(a?.path,b?.path)&&a.type?.some(a=>["BackboneElement","Element"].includes(a.code)))}parseSliceStart(a){if(!this.slicingContext)throw Error(`Invalid slice start before discriminator: ${a.sliceName} (${a.id})`);this.slicingContext.current={...this.parseElementDefinition(a),name:a.sliceName??"",definition:a.definition,elements:{}},this.slicingContext.field.slices.push(this.slicingContext.current)}parseElementDefinitionType(a){return(a.type??[]).map(b=>{let c;return("BackboneElement"===b.code||"Element"===b.code)&&(c=a_(a)),c||(c=at(b,"http://hl7.org/fhir/StructureDefinition/structuredefinition-fhir-type")?.valueUrl),c||(c=b.code??""),{code:c,targetProfile:b.targetProfile,profile:b.profile}})}parseElementDefinition(a){let b=N(a.max),c=a.base?.max?N(a.base.max):b,d={type:"ElementDefinition",value:a};return{description:a.definition||"",path:a.path||a.base?.path||"",min:a.min??0,max:b,isArray:c>1,constraints:(a.constraint??[]).map(a=>({key:a.key??"",severity:a.severity??"error",expression:a.expression??"",description:a.human??""})),type:this.parseElementDefinitionType(a),fixed:Q(X(d,"fixed[x]")),pattern:Q(X(d,"pattern[x]")),binding:a.binding}}};function N(a){return"*"===a?1/0:Number.parseInt(a,10)}function O(a,b=""){var c,d;return c=a.path,d=b,c?d&&c.startsWith(d)?c.substring(d.length+1):c:""}function P(a,b){return!!a&&!!b&&(b.startsWith(a+".")||b===a)}function Q(a){return Array.isArray(a)&&a.length>0?a[0]:av(a)?void 0:a}function R(a,b,c){var d,e,f;let g,h=a.path;return d=X(a,b,c),e=h,f=b,g=e?e+".":"",void 0===d?{type:"undefined",value:void 0,path:`${g}${f}`}:Array.isArray(d)?d.map((a,b)=>({...a,path:`${g}${f}[${b}]`})):{...d,path:`${g}${f}`}}new k(1e3);var S={date:/^(\d(\d(\d[1-9]|[1-9]0)|[1-9]00)|[1-9]000)(-(0[1-9]|1[0-2])(-(0[1-9]|[1-2]\d|3[0-1]))?)?$/,dateTime:/^(\d(\d(\d[1-9]|[1-9]0)|[1-9]00)|[1-9]000)(-(0[1-9]|1[0-2])(-(0[1-9]|[1-2]\d|3[0-1])(T([01]\d|2[0-3])(:[0-5]\d:([0-5]\d|60)(\.\d{1,9})?)?)?)?(Z|[+-]((0\d|1[0-3]):[0-5]\d|14:00)?)?)?$/};function T(a){return[{type:aZ.boolean,value:a}]}function U(a){return null==a?{type:"undefined",value:void 0}:Number.isSafeInteger(a)?{type:aZ.integer,value:a}:"number"==typeof a?{type:aZ.decimal,value:a}:"boolean"==typeof a?{type:aZ.boolean,value:a}:"string"==typeof a?{type:aZ.string,value:a}:ah(a)?{type:aZ.Quantity,value:a}:a3(a)?{type:a.resourceType,value:a}:aA(a)?{type:aZ.CodeableConcept,value:a}:az(a)?{type:aZ.Coding,value:a}:{type:aZ.BackboneElement,value:a}}function V(a){return 0!==a.length&&!!a[0].value}function W(a,b){if(0!==a.length){if(1===a.length&&(!b||a[0].type===b))return a[0];throw Error(`Expected singleton of type ${b}, but found ${JSON.stringify(a)}`)}}function X(a,b,c){if(!a.value)return;let d=function(a,b,c){let d=I(a,c);if(d)return function(a,b){let c=a[b]??a[b+"[x]"];if(c)return c;for(let c=0;c<b.length;c++){let d=b[c];if(d>="A"&&d<="Z"){let d=a[b.slice(0,c)+"[x]"];if(d)return d}}}(d.elements,b)}(a.type,b,c?.profileUrl);return d?function(a,b,c){let d=a.value,e=c.type;if(!e||0===e.length)return;let f,g="undefined",h,i=c.path.lastIndexOf("."),j=c.path.substring(i+1);for(let a of e){let b=j.replace("[x]",aD(a.code));if(f=d[b],h=d["_"+b],void 0!==f||void 0!==h){g=a.code;break}}if(h)if(Array.isArray(f)){f=f.slice();for(let a=0;a<Math.max(f.length,h.length);a++)f[a]=al(f[a],h[a])}else if(!f&&Array.isArray(h)){f=h.slice();for(let a=0;a<h.length;a++)f[a]=al(void 0,h[a])}else f=al(f,h);if(!av(f))return("Element"===g||"BackboneElement"===g)&&(g=c.type[0].code),Array.isArray(f)?f.map(a=>Y(a,g)):Y(f,g)}(a,0,d):function(a,b){let c,d=a.value;if(d&&"object"==typeof d){if(b in d){let a=d[b];c=Array.isArray(a)?a.map(U):U(a)}else{let a=b.endsWith("[x]")?b.substring(0,b.length-3):b;for(let b of Object.values(aZ)){let e=a+aD(b);if(e in d){let a=d[e];c=Array.isArray(a)?a.map(a=>({type:b,value:a})):{type:b,value:a};break}}}if(Array.isArray(c)){if(0===c.length||av(c[0]))return}else if(av(c))return;return c}}(a,b)}function Y(a,b){return"Resource"===b&&a3(a)&&(b=a.resourceType),{type:b,value:a}}function Z(a){let b=[];for(let c of a){let a=!1;for(let d of b)if(V($(c,d))){a=!0;break}a||b.push(c)}return b}function $(a,b){let c=a.value?.valueOf(),d=b.value?.valueOf();return"number"==typeof c&&"number"==typeof d?T(1e-8>Math.abs(c-d)):ah(c)&&ah(d)?T(ai(c,d)):T("object"==typeof c&&"object"==typeof d?aj(a,b):c===d)}function _(a,b){return 0===a.length&&0===b.length?T(!0):a.length!==b.length?T(!1):(a.sort(aa),b.sort(aa),T(a.every((a,c)=>V(function(a,b){let{type:c,value:d}=a,{type:e,value:f}=b,g=d?.valueOf(),h=f?.valueOf();return"number"==typeof g&&"number"==typeof h?T(.01>Math.abs(g-h)):ah(g)&&ah(h)?T(ai(g,h)):T("Coding"===c&&"Coding"===e?"object"==typeof g&&"object"==typeof h&&g.code===h.code&&g.system===h.system:"object"==typeof g&&"object"==typeof h?aj({...g,id:void 0},{...h,id:void 0}):"string"==typeof g&&"string"==typeof h?g.toLowerCase()===h.toLowerCase():g===h)}(a,b[c])))))}function aa(a,b){let c=a.value?.valueOf(),d=b.value?.valueOf();return"number"==typeof c&&"number"==typeof d?c-d:"string"==typeof c&&"string"==typeof d?c.localeCompare(d):0}function ab(a,b){let{value:c}=a;if(null==c)return!1;let d=b;switch(d.startsWith("System.")&&(d=d.substring(7)),d.startsWith("FHIR.")&&(d=d.substring(5)),d){case"Boolean":return"boolean"==typeof c;case"Decimal":case"Integer":return"number"==typeof c;case"Date":return ac(c);case"DateTime":return ad(c);case"Time":return"string"==typeof c&&!!/^T\d/.exec(c);case"Period":return ae(c);case"Quantity":return ah(c);default:return a.type===d||"object"==typeof c&&c?.resourceType===d}}function ac(a){return"string"==typeof a&&!!S.date.exec(a)}function ad(a){return"string"==typeof a&&!!S.dateTime.exec(a)}function ae(a){return!!(a&&"object"==typeof a&&("start"in a&&ad(a.start)||"end"in a&&ad(a.end)))}function af(a){if(a){if(ac(a)||ad(a))return{start:ag(a,"0000-01-01T00:00:00.000"),end:ag(a,"xxxx-12-31T23:59:59.999")};if(ae(a))return{start:a.start?ag(a.start,"0000-01-01T00:00:00.000"):void 0,end:a.end?ag(a.end,"xxxx-12-31T23:59:59.999"):void 0}}}function ag(a,b){let c="Z",d=Math.max(a.indexOf("+",10),a.indexOf("-",10));return d>-1?(c=a.substring(d),a=a.substring(0,d)):a.endsWith("Z")&&(a=a.substring(0,a.length-1)),new Date(a+b.substring(a.length)+c).toISOString()}function ah(a){return!!(a&&"object"==typeof a&&"value"in a&&"number"==typeof a.value)}function ai(a,b){return .01>Math.abs(a.value-b.value)&&(a.unit===b.unit||a.code===b.code||a.unit===b.code||a.code===b.unit)}function aj(a,b){let c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(let d of c){let c=a[d],e=b[d];if(ak(c)&&ak(e)){if(!aj(c,e))return!1}else if(c!==e)return!1}return!0}function ak(a){return null!==a&&"object"==typeof a}function al(a,b){if(b){var c,d;if("object"!=typeof b)throw Error("Primitive extension must be an object");return c=a??{},d=b,delete d.__proto__,delete d.constructor,Object.assign(c,d)}return a}function am(a,b){return a3(a,b)&&"id"in a&&"string"==typeof a.id}function an(a){let b=ao(a)??"undefined/undefined",c=aq(a);return c===b?{reference:b}:{reference:b,display:c}}function ao(a){return a4(a)?a.reference:am(a)?`${a.resourceType}/${a.id}`:void 0}function ap(a){if(a)return a4(a)?a.reference.split("/")[1]:a.id}function aq(a){if("Patient"===a.resourceType||"Practitioner"===a.resourceType||"RelatedPerson"===a.resourceType){let b=function(a){let b=a.name;if(b&&b.length>0)return aK(b[0])}(a);if(b)return b}if("Device"===a.resourceType){let b=function(a){let b=a.deviceName;if(b&&b.length>0)return b[0].name}(a);if(b)return b}if("MedicationRequest"===a.resourceType&&a.medicationCodeableConcept)return aV(a.medicationCodeableConcept);if("Subscription"===a.resourceType&&a.criteria)return a.criteria;if("User"===a.resourceType&&a.email)return a.email;if("name"in a&&a.name&&"string"==typeof a.name)return a.name;if("code"in a&&a.code){var b;let c=a.code;if(Array.isArray(c)&&(c=c[0]),aA(c))return aV(c);if(ay(b=c)&&"text"in b&&"string"==typeof b.text)return c.text}return ao(a)??""}function ar(a){if(!("photo"in a))return;let b=a.photo;if(b)if(!Array.isArray(b))return as(b);else for(let a of b){let b=as(a);if(b)return b}}function as(a){if(a.url&&a.contentType?.startsWith("image/"))return a.url}function at(a,...b){let c=a;for(let a=0;a<b.length&&c;a++)c=c?.extension?.find(c=>c.url===b[a]);return c}function au(a,b){return JSON.stringify(function a(b){if(null!=b&&""!==b)return"object"==typeof b?Array.isArray(b)?function(b){let c=b.length;if(0===c)return;let d,e=0;for(let f=0;f<c;f++){let c=b[f],g=a(c);g===c||d||(d=Array.from(b)),void 0===g?d&&(d[f]=null):(d&&(d[f]=g),e++)}if(0!==e)return d??b}(b):function(b){let c,d=0;for(let e in b){let f=b[e],g=a(f);g===f||c||(c={...b}),void 0===g?c&&delete c[e]:(c&&(c[e]=g),d++)}if(0!==d)return c??b}(b):b}(a),null,b?2:void 0)??""}function av(a){if(null==a)return!0;let b=typeof a;return("string"===b||"object"===b)&&!aw(a)}function aw(a){if(null==a)return!1;let b=typeof a;return"string"===b&&""!==a||"object"===b&&("length"in a&&a.length>0||Object.keys(a).length>0)}function ax(a,b,c){return!!(a===b||av(a)&&av(b))||!(av(a)||av(b))&&(Array.isArray(a)&&Array.isArray(b)?function(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(!ax(a[c],b[c]))return!1;return!0}(a,b):!(Array.isArray(a)||Array.isArray(b))&&(ay(a)&&ay(b)?function(a,b,c){let d=new Set;for(let e of(Object.keys(a).forEach(a=>d.add(a)),Object.keys(b).forEach(a=>d.add(a)),"meta"===c&&(d.delete("versionId"),d.delete("lastUpdated"),d.delete("author")),d))if(!ax(a[e],b[e],e))return!1;return!0}(a,b,c):(ay(a)||ay(b),!1)))}function ay(a){return null!==a&&"object"==typeof a}function az(a){return ay(a)&&"code"in a&&"string"==typeof a.code}function aA(a){return ay(a)&&"coding"in a&&Array.isArray(a.coding)&&a.coding.every(az)}var aB=[];for(let a=0;a<256;a++)aB.push(a.toString(16).padStart(2,"0"));function aC(a){return ArrayBuffer.isView(a)?a.buffer:a}function aD(a){return a?a.charAt(0).toUpperCase()+a.substring(1):""}var aE=a=>new Promise(b=>{setTimeout(b,a)});function aF(a,b,c){let d=[];for(let e=0;e<c-1;e++){let c=a.indexOf(b);if(c<0)break;d.push(a.slice(0,c)),a=a.slice(c+b.length)}return d.push(a),d}function aG(a,b){return a?(a.push(b),a):[b]}function aH(a){return a.endsWith("/")?a:a+"/"}function aI(a,b){return new URL(b.startsWith("/")?b.slice(1):b,aH(a.toString())).toString()}function aJ(a,b){if(!a)return"";let c=[];if(a.line&&c.push(...a.line),a.city||a.state||a.postalCode){let b=[];a.city&&b.push(a.city),a.state&&b.push(a.state),a.postalCode&&b.push(a.postalCode),c.push(b.join(", "))}return a.use&&(b?.all||b?.use)&&c.push("["+a.use+"]"),c.join(b?.lineSeparator??", ").trim()}function aK(a,b){if(!a)return"";let c=[];if(a.prefix&&b?.prefix!==!1&&c.push(...a.prefix),a.given&&c.push(...a.given),a.family&&c.push(a.family),a.suffix&&b?.suffix!==!1&&c.push(...a.suffix),a.use&&(b?.all||b?.use)&&c.push("["+a.use+"]"),0===c.length){let b=aX(a.text);if(b)return b}return c.join(" ").trim()}function aL(a){return a instanceof Date&&!Number.isNaN(a.getTime())}function aM(a,b,c){if(!a)return"";let d=new Date(a);return aL(d)?d.toLocaleString(b,c):""}function aN(a,b,c){return a&&(a.start||a.end)?aM(a.start,b,c)+" - "+aM(a.end,b,c):""}var aO={s:"every second",min:"every minute",h:"hourly",d:"daily",wk:"weekly",mo:"monthly",a:"annually"},aP={s:"second",min:"minute",h:"hour",d:"day",wk:"week",mo:"month",a:"year"},aQ={s:"seconds",min:"minutes",h:"hours",d:"days",wk:"weeks",mo:"months",a:"years"};function aR(a){if(!a)return"";let b=[];return function(a,b){if(!b?.periodUnit)return;let c=b.frequency??1,d=b.period??1,e=b.periodUnit;1===c&&1===d?a.push(aO[e]):(1===c?a.push("once"):a.push(c+" times"),1===d?a.push("per "+aP[e]):a.push("per "+d+" "+aQ[e])),b.dayOfWeek&&a.push("on "+b.dayOfWeek.map(aD).join(", ")),b.timeOfDay&&a.push("at "+b.timeOfDay.map(a=>(function(a,b,c){if(!a)return"";let d=new Date("2000-01-01T"+a+"Z");return aL(d)?d.toLocaleTimeString(void 0,void 0):""})(a)).join(", "))}(b,a.repeat),a.event&&b.push(a.event.map(a=>aM(a)).join(", ")),aD(b.join(" ").trim())}function aS(a,b,c=!1){if(c&&void 0===b)throw Error("Precision must be specified for exclusive ranges");let d=a?.low&&{...a.low,comparator:void 0},e=a?.high&&{...a.high,comparator:void 0};return d?.value===void 0&&e?.value===void 0?"":d?.value!==void 0&&e?.value===void 0?c&&void 0!==b?(d.value=function(a,b,c=1){return(aY(a,b)-c)*Math.pow(10,-b)}(d.value,b),`> ${aT(d,b)}`):`>= ${aT(d,b)}`:d?.value===void 0&&e?.value!==void 0?c&&void 0!==b?(e.value=function(a,b,c=1){return(aY(a,b)+c)*Math.pow(10,-b)}(e.value,b),`< ${aT(e,b)}`):`<= ${aT(e,b)}`:(d?.unit===e?.unit&&delete d?.unit,`${aT(d,b)} - ${aT(e,b)}`)}function aT(a,b){if(!a)return"";let c=[];return a.comparator&&(c.push(a.comparator),c.push(" ")),void 0!==a.value&&(void 0!==b?c.push(a.value.toFixed(b)):c.push(a.value)),a.unit&&("%"!==a.unit&&" "!==c.at(-1)&&c.push(" "),c.push(a.unit)),c.join("").trim()}function aU(a){return a?.value===void 0?"":a.value.toLocaleString(void 0,{style:"currency",currency:a.currency??"USD",currencyDisplay:"narrowSymbol"})}function aV(a){return a?aX(a.text)||(a.coding?a.coding.map(a=>aW(a)).join(", "):""):""}function aW(a,b){let c=aX(a?.display);if(c){let d=b?aX(a?.code):void 0;return`${c}${d?" ("+d+")":""}`}return aX(a?.code)??""}function aX(a){return"string"==typeof a?a:void 0}function aY(a,b){return void 0===b?a:Math.round(a*Math.pow(10,b))}var aZ={Address:"Address",Age:"Age",Annotation:"Annotation",Attachment:"Attachment",BackboneElement:"BackboneElement",CodeableConcept:"CodeableConcept",Coding:"Coding",ContactDetail:"ContactDetail",ContactPoint:"ContactPoint",Contributor:"Contributor",Count:"Count",DataRequirement:"DataRequirement",Distance:"Distance",Dosage:"Dosage",Duration:"Duration",Expression:"Expression",Extension:"Extension",HumanName:"HumanName",Identifier:"Identifier",MarketingStatus:"MarketingStatus",Meta:"Meta",Money:"Money",Narrative:"Narrative",ParameterDefinition:"ParameterDefinition",Period:"Period",Population:"Population",ProdCharacteristic:"ProdCharacteristic",ProductShelfLife:"ProductShelfLife",Quantity:"Quantity",Range:"Range",Ratio:"Ratio",Reference:"Reference",RelatedArtifact:"RelatedArtifact",SampledData:"SampledData",Signature:"Signature",SubstanceAmount:"SubstanceAmount",SystemString:"http://hl7.org/fhirpath/System.String",Timing:"Timing",TriggerDefinition:"TriggerDefinition",UsageContext:"UsageContext",base64Binary:"base64Binary",boolean:"boolean",canonical:"canonical",code:"code",date:"date",dateTime:"dateTime",decimal:"decimal",id:"id",instant:"instant",integer:"integer",markdown:"markdown",oid:"oid",positiveInt:"positiveInt",string:"string",time:"time",unsignedInt:"unsignedInt",uri:"uri",url:"url",uuid:"uuid"};function a$(a){let b=a5.types[a];return b||(b={searchParamsDetails:{}},a5.types[a]=b),b.searchParams||"Binary"===a||(b.searchParams={_id:{base:[a],code:"_id",type:"token",expression:a+".id"},_lastUpdated:{base:[a],code:"_lastUpdated",type:"date",expression:a+".meta.lastUpdated"},_compartment:{base:[a],code:"_compartment",type:"reference",expression:a+".meta.compartment"},_profile:{base:[a],code:"_profile",type:"uri",expression:a+".meta.profile"},_security:{base:[a],code:"_security",type:"token",expression:a+".meta.security"},_source:{base:[a],code:"_source",type:"uri",expression:a+".meta.source"},_tag:{base:[a],code:"_tag",type:"token",expression:a+".meta.tag"}}),b}function a_(a){var b;let c=a.type?.[0]?.code;return"BackboneElement"===c||"Element"===c?1===(b=(a.base?.path??a.path)?.split(".")).length?b[0]:b.map(aD).join(""):c}function a0(a){var b;return((b=a.replaceAll("[x]","").split(".").pop()).length<100?b.match(/[A-Z]+(?![a-z])|[A-Z]?[a-z]+|\d+/g)??[]:b.split(/(?=[A-Z])/)).map(a2).join(" ").replace("_"," ").replaceAll(/\s+/g," ")}var a1=new Set(["ID","IP","PKCE","JWKS","URI","URL","OMB","UDI"]);function a2(a){let b=a.toUpperCase();return a===b?a:a1.has(b)?b:b.charAt(0)+a.slice(1)}function a3(a,b){return!(!a||"object"!=typeof a||!("resourceType"in a)||b&&a.resourceType!==b)}function a4(a,b){return!!a&&"object"==typeof a&&"reference"in a&&"string"==typeof a.reference&&(!b||null!==a.reference.match(RegExp(`^${b}(/|\\?)`)))}var a5={types:{}};function a6(a){if(a.startsWith("T"))return a+"T00:00:00.000Z".substring(a.length);if(a.length<=10)return a;try{return new Date(a).toISOString()}catch{return a}}var a7=()=>[],a8={empty:(a,b)=>T(b.every(a=>av(a.value))),hasValue:(a,b)=>T(0!==b.length),exists:(a,b,c)=>c?T(b.some(b=>V(c.eval(a,[b])))):T(b.length>0&&b.every(a=>!av(a.value))),all:(a,b,c)=>T(b.every(b=>V(c.eval(a,[b])))),allTrue:(a,b)=>{for(let a of b)if(!a.value)return T(!1);return T(!0)},anyTrue:(a,b)=>{for(let a of b)if(a.value)return T(!0);return T(!1)},allFalse:(a,b)=>{for(let a of b)if(a.value)return T(!1);return T(!0)},anyFalse:(a,b)=>{for(let a of b)if(!a.value)return T(!0);return T(!1)},subsetOf:(a,b,c)=>{if(0===b.length)return T(!0);let d=c.eval(a,bc(a));return 0===d.length?T(!1):T(b.every(a=>d.some(b=>b.value===a.value)))},supersetOf:(a,b,c)=>{let d=c.eval(a,bc(a));return 0===d.length?T(!0):0===b.length?T(!1):T(d.every(a=>b.some(b=>b.value===a.value)))},count:(a,b)=>[{type:aZ.integer,value:b.length}],distinct:(a,b)=>{let c=[];for(let a of b)c.some(b=>b.value===a.value)||c.push(a);return c},isDistinct:(a,b)=>T(b.length===a8.distinct(a,b).length),where:(a,b,c)=>b.filter(b=>V(c.eval(a,[b]))),select:(a,b,c)=>b.flatMap(b=>c.eval({parent:a,variables:{$this:b}},[b])),repeat:a7,ofType:(a,b,c)=>b.filter(a=>a.type===c.name),single:(a,b)=>{if(b.length>1)throw Error("Expected input length one for single()");return 0===b.length?[]:b.slice(0,1)},first:(a,b)=>0===b.length?[]:b.slice(0,1),last:(a,b)=>0===b.length?[]:b.slice(-1,b.length),tail:(a,b)=>0===b.length?[]:b.slice(1,b.length),skip:(a,b,c)=>{let d=c.eval(a,b)[0]?.value;if("number"!=typeof d)throw TypeError("Expected a number for skip(num)");return d>=b.length?[]:d<=0?b:b.slice(d,b.length)},take:(a,b,c)=>{let d=c.eval(a,b)[0]?.value;if("number"!=typeof d)throw TypeError("Expected a number for take(num)");return d>=b.length?b:d<=0?[]:b.slice(0,d)},intersect:(a,b,c)=>{if(!c)return b;let d=c.eval(a,bc(a)),e=[];for(let a of b)!e.some(b=>b.value===a.value)&&d.some(b=>b.value===a.value)&&e.push(a);return e},exclude:(a,b,c)=>{if(!c)return b;let d=c.eval(a,bc(a)),e=[];for(let a of b)d.some(b=>b.value===a.value)||e.push(a);return e},union:(a,b,c)=>c?Z([...b,...c.eval(a,bc(a))]):b,combine:(a,b,c)=>c?[...b,...c.eval(a,bc(a))]:b,htmlChecks:(a,b,c)=>[U(!0)],iif:(a,b,c,d,e)=>{let f=c.eval(a,b);if(f.length>1||1===f.length&&"boolean"!=typeof f[0].value)throw Error("Expected criterion to evaluate to a Boolean");return V(f)?d.eval(a,b):e?e.eval(a,b):[]},toBoolean:(a,b)=>{if(0===b.length)return[];let[{value:c}]=bb(b,1);if("boolean"==typeof c)return[{type:aZ.boolean,value:c}];if("number"==typeof c&&(0===c||1===c))return T(!!c);if("string"==typeof c){let a=c.toLowerCase();if(["true","t","yes","y","1","1.0"].includes(a))return T(!0);if(["false","f","no","n","0","0.0"].includes(a))return T(!1)}return[]},convertsToBoolean:(a,b)=>0===b.length?[]:T(1===a8.toBoolean(a,b).length),toInteger:(a,b)=>{if(0===b.length)return[];let[{value:c}]=bb(b,1);return"number"==typeof c?[{type:aZ.integer,value:c}]:"string"==typeof c&&/^[+-]?\d+$/.exec(c)?[{type:aZ.integer,value:Number.parseInt(c,10)}]:"boolean"==typeof c?[{type:aZ.integer,value:+!!c}]:[]},convertsToInteger:(a,b)=>0===b.length?[]:T(1===a8.toInteger(a,b).length),toDate:(a,b)=>{if(0===b.length)return[];let[{value:c}]=bb(b,1);return"string"==typeof c&&/^\d{4}(-\d{2}(-\d{2})?)?/.exec(c)?[{type:aZ.date,value:a6(c)}]:[]},convertsToDate:(a,b)=>0===b.length?[]:T(1===a8.toDate(a,b).length),toDateTime:(a,b)=>{if(0===b.length)return[];let[{value:c}]=bb(b,1);return"string"==typeof c&&/^\d{4}(-\d{2}(-\d{2})?)?/.exec(c)?[{type:aZ.dateTime,value:a6(c)}]:[]},convertsToDateTime:(a,b)=>0===b.length?[]:T(1===a8.toDateTime(a,b).length),toDecimal:(a,b)=>{if(0===b.length)return[];let[{value:c}]=bb(b,1);return"number"==typeof c?[{type:aZ.decimal,value:c}]:"string"==typeof c&&/^-?\d{1,9}(\.\d{1,9})?$/.exec(c)?[{type:aZ.decimal,value:Number.parseFloat(c)}]:"boolean"==typeof c?[{type:aZ.decimal,value:+!!c}]:[]},convertsToDecimal:(a,b)=>0===b.length?[]:T(1===a8.toDecimal(a,b).length),toQuantity:(a,b)=>{if(0===b.length)return[];let[{value:c}]=bb(b,1);return ah(c)?[{type:aZ.Quantity,value:c}]:"number"==typeof c?[{type:aZ.Quantity,value:{value:c,unit:"1"}}]:"string"==typeof c&&/^-?\d{1,9}(\.\d{1,9})?/.exec(c)?[{type:aZ.Quantity,value:{value:Number.parseFloat(c),unit:"1"}}]:"boolean"==typeof c?[{type:aZ.Quantity,value:{value:+!!c,unit:"1"}}]:[]},convertsToQuantity:(a,b)=>0===b.length?[]:T(1===a8.toQuantity(a,b).length),toString:(a,b)=>{if(0===b.length)return[];let[{value:c}]=bb(b,1);return null==c?[]:ah(c)?[{type:aZ.string,value:`${c.value} '${c.unit}'`}]:[{type:aZ.string,value:c.toString()}]},convertsToString:(a,b)=>0===b.length?[]:T(1===a8.toString(a,b).length),toTime:(a,b)=>{if(0===b.length)return[];let[{value:c}]=bb(b,1);if("string"==typeof c){let a=/^T?(\d{2}(:\d{2}(:\d{2})?)?)/.exec(c);if(a)return[{type:aZ.time,value:a6("T"+a[1])}]}return[]},convertsToTime:(a,b)=>0===b.length?[]:T(1===a8.toTime(a,b).length),indexOf:(a,b,c)=>a9((a,b)=>a.indexOf(b),a,b,c),substring:(a,b,c,d)=>a9((a,b,c)=>{let d=c?b+c:a.length;return b<0||b>=a.length?void 0:a.substring(b,d)},a,b,c,d),startsWith:(a,b,c)=>a9((a,b)=>a.startsWith(b),a,b,c),endsWith:(a,b,c)=>a9((a,b)=>a.endsWith(b),a,b,c),contains:(a,b,c)=>a9((a,b)=>a.includes(b),a,b,c),upper:(a,b)=>a9(a=>a.toUpperCase(),a,b),lower:(a,b)=>a9(a=>a.toLowerCase(),a,b),replace:(a,b,c,d)=>a9((a,b,c)=>a.replaceAll(b,c),a,b,c,d),matches:(a,b,c)=>a9((a,b)=>!!new RegExp(b).exec(a),a,b,c),replaceMatches:(a,b,c,d)=>a9((a,b,c)=>a.replaceAll(RegExp(b,"g"),c.replaceAll(/\$\{(\w+)\}/g,"$<$1>")),a,b,c,d),length:(a,b)=>a9(a=>a.length,a,b),toChars:(a,b)=>a9(a=>a?a.split(""):void 0,a,b),encode:a7,decode:a7,escape:a7,unescape:a7,trim:a7,split:a7,join:(a,b,c)=>{let d=c?.eval(a,bc(a))[0]?.value??"";if("string"!=typeof d)throw TypeError("Separator must be a string.");return[{type:aZ.string,value:b.map(a=>a.value?.toString()??"").join(d)}]},abs:(a,b)=>ba(Math.abs,a,b),ceiling:(a,b)=>ba(Math.ceil,a,b),exp:(a,b)=>ba(Math.exp,a,b),floor:(a,b)=>ba(Math.floor,a,b),ln:(a,b)=>ba(Math.log,a,b),log:(a,b,c)=>ba((a,b)=>Math.log(a)/Math.log(b),a,b,c),power:(a,b,c)=>ba(Math.pow,a,b,c),round:(a,b,...c)=>ba((a,b=0)=>{if("number"!=typeof b||b<0)throw Error("Invalid precision provided to round()");let c=Math.pow(10,b);return Math.round(a*c)/c},a,b,...c),sqrt:(a,b)=>ba(Math.sqrt,a,b),truncate:(a,b)=>ba(a=>Math.trunc(a),a,b),children:a7,descendants:a7,trace:(a,b,c)=>b,now:()=>[{type:aZ.dateTime,value:new Date().toISOString()}],timeOfDay:()=>[{type:aZ.time,value:new Date().toISOString().substring(11)}],today:()=>[{type:aZ.date,value:new Date().toISOString().substring(0,10)}],between:(a,b,c,d,e)=>{let f=a8.toDateTime(a,c.eval(a,b));if(0===f.length)throw Error("Invalid start date");let g=a8.toDateTime(a,d.eval(a,b));if(0===g.length)throw Error("Invalid end date");let h=e.eval(a,b)[0]?.value;if("years"!==h&&"months"!==h&&"days"!==h)throw Error("Invalid units");let i=function(a,b){let c=new Date(a);c.setUTCHours(0,0,0,0);let d=b?new Date(b):new Date;d.setUTCHours(0,0,0,0);let e=c.getUTCFullYear(),f=c.getUTCMonth(),g=c.getUTCDate(),h=d.getUTCFullYear(),i=d.getUTCMonth(),j=d.getUTCDate(),k=h-e;(i<f||i===f&&j<g)&&k--;let l=12*h+i-(12*e+f);return j<g&&l--,{years:k,months:l,days:Math.floor((d.getTime()-c.getTime())/864e5)}}(f[0].value,g[0].value);return[{type:aZ.Quantity,value:{value:i[h],unit:h}}]},is:(a,b,c)=>{let d="";return c instanceof bf?d=c.name:c instanceof bo&&(d=c.left.name+"."+c.right.name),d?b.map(a=>({type:aZ.boolean,value:ab(a,d)})):[]},not:(a,b)=>a8.toBoolean(a,b).map(a=>({type:aZ.boolean,value:!a.value})),resolve:(a,b)=>b.map(a=>{let b=a.value,c;if("string"==typeof b)c=b;else if("object"==typeof b){if(b.resource)return U(b.resource);b.reference?c=b.reference:b.type&&b.identifier&&(c=`${b.type}?identifier=${b.identifier.system}|${b.identifier.value}`)}if(c?.includes("?")){let[a]=c.split("?");return{type:a,value:{resourceType:a}}}if(c?.includes("/")){let[a,b]=c.split("/");return{type:a,value:{resourceType:a,id:b}}}return{type:aZ.BackboneElement,value:void 0}}).filter(a=>!!a.value),as:(a,b)=>b,type:(a,b)=>b.map(({value:a})=>"boolean"==typeof a?{type:aZ.BackboneElement,value:{namespace:"System",name:"Boolean"}}:"number"==typeof a?{type:aZ.BackboneElement,value:{namespace:"System",name:"Integer"}}:a3(a)?{type:aZ.BackboneElement,value:{namespace:"FHIR",name:a.resourceType}}:{type:aZ.BackboneElement,value:null}),conformsTo:(a,b,c)=>{let d=c.eval(a,b)[0].value;if(!d.startsWith("http://hl7.org/fhir/StructureDefinition/"))throw Error("Expected a StructureDefinition URL");let e=d.replace("http://hl7.org/fhir/StructureDefinition/","");return b.map(a=>({type:aZ.boolean,value:a.value?.resourceType===e}))},getResourceKey:(a,b)=>{let c=b[0].value;return c?.id?[{type:aZ.id,value:c.id}]:[]},getReferenceKey:(a,b,c)=>{let d=b[0].value;if(!d?.reference)return[];let e="";return c instanceof bf&&(e=c.name),e&&!d.reference.startsWith(e+"/")?[]:[{type:aZ.id,value:ap(d)}]},extension:(a,b,c)=>{let d=c.eval(a,b)[0].value,e=b?.[0]?.value;if(e){let a=at(e,d);if(a)return[{type:aZ.Extension,value:a}]}return[]}};function a9(a,b,c,...d){if(0===c.length)return[];let[{value:e}]=bb(c,1);if("string"!=typeof e)throw TypeError("String function cannot be called with non-string");let f=a(e,...d.map(a=>a?.eval(b,c)[0]?.value));return void 0===f?[]:Array.isArray(f)?f.map(U):[U(f)]}function ba(a,b,c,...d){if(0===c.length)return[];let[{value:e}]=bb(c,1),f=ah(e),g=f?e.value:e;if("number"!=typeof g)throw TypeError("Math function cannot be called with non-number");let h=a(g,...d.map(a=>a.eval(b,c)[0]?.value));return[{type:f?aZ.Quantity:c[0].type,value:f?{...e,value:h}:h}]}function bb(a,b){if(a.length!==b)throw Error(`Expected ${b} arguments`);for(let b of a)if(null==b)throw Error("Expected non-null argument");return a}function bc(a){let b=a;for(;b.parent?.variables.$this;)b=b.parent;return[b.variables.$this]}var bd=class{constructor(a,b){f(this,"original"),f(this,"child"),this.original=a,this.child=b}eval(a,b){try{if(!(b.length>0))return this.child.eval(a,[]);{let c=[];for(let d of b)c.push(this.child.eval({parent:a,variables:{$this:d}},[d]));return c.flat()}}catch(a){throw Error(`FhirPathError on "${this.original}": ${a}`,{cause:a})}}toString(){return this.child.toString()}},be=class{constructor(a){f(this,"value"),this.value=a}eval(){return[this.value]}toString(){let a=this.value.value;return"string"==typeof a?`'${a}'`:a.toString()}},bf=class{constructor(a){f(this,"name"),this.name=a}eval(a,b){if("$this"===this.name)return b;let c=this.getVariable(a);if(c)return[c];if(this.name.startsWith("%"))throw Error(`Undefined variable ${this.name}`);return b.flatMap(a=>this.evalValue(a)).filter(a=>a?.value!==void 0)}getVariable(a){let b=a.variables[this.name];return void 0!==b?b:a.parent?this.getVariable(a.parent):void 0}evalValue(a){let b=a.value;if(!(!b||"object"!=typeof b))return a3(b,this.name)?a:R(a,this.name)}toString(){return this.name}},bg=class{eval(){return[]}toString(){return"{}"}},bh=class extends g{constructor(a,b,c){super(a,b),f(this,"impl"),this.impl=c}eval(a,b){return this.impl(this.child.eval(a,b))}toString(){return this.operator+this.child.toString()}},bi=class extends h{constructor(a,b){super("as",a,b)}eval(a,b){return a8.ofType(a,this.left.eval(a,b),this.right)}},bj=class extends h{},bk=class extends bj{constructor(a,b,c,d){super(a,b,c),f(this,"impl"),this.impl=d}eval(a,b){let c=this.left.eval(a,b);if(1!==c.length)return[];let d=this.right.eval(a,b);if(1!==d.length)return[];let e=c[0].value,f=d[0].value,g=ah(e)?e.value:e,h=ah(f)?f.value:f,i=this.impl(g,h);return"boolean"==typeof i?T(i):ah(e)?[{type:aZ.Quantity,value:{...e,value:i}}]:[U(i)]}},bl=class extends h{constructor(a,b){super("&",a,b)}eval(a,b){let c=[...this.left.eval(a,b),...this.right.eval(a,b)];return c.length>0&&c.every(a=>"string"==typeof a.value)?[{type:aZ.string,value:c.map(a=>a.value).join("")}]:c}},bm=class extends bj{constructor(a,b){super("contains",a,b)}eval(a,b){let c=this.left.eval(a,b),d=this.right.eval(a,b);return T(c.some(a=>a.value===d[0].value))}},bn=class extends bj{constructor(a,b){super("in",a,b)}eval(a,b){let c=W(this.left.eval(a,b)),d=this.right.eval(a,b);return c?T(d.some(a=>$(c,a)[0].value)):[]}},bo=class extends h{constructor(a,b){super(".",a,b)}eval(a,b){return this.right.eval(a,this.left.eval(a,b))}toString(){return`${this.left.toString()}.${this.right.toString()}`}},bp=class extends h{constructor(a,b){super("|",a,b)}eval(a,b){return Z([...this.left.eval(a,b),...this.right.eval(a,b)])}},bq=class extends bj{constructor(a,b){super("=",a,b)}eval(a,b){let c=this.left.eval(a,b),d=this.right.eval(a,b);return 0===c.length||0===d.length?[]:c.length!==d.length?T(!1):T(c.every((a,b)=>V($(a,d[b]))))}},br=class extends bj{constructor(a,b){super("!=",a,b)}eval(a,b){let c=this.left.eval(a,b),d=this.right.eval(a,b);return 0===c.length||0===d.length?[]:c.length!==d.length?T(!0):T(c.some((a,b)=>!V($(a,d[b]))))}},bs=class extends bj{constructor(a,b){super("~",a,b)}eval(a,b){return _(this.left.eval(a,b),this.right.eval(a,b))}},bt=class extends bj{constructor(a,b){super("!~",a,b)}eval(a,b){return T(!V(_(this.left.eval(a,b),this.right.eval(a,b))))}},bu=class extends bj{constructor(a,b){super("is",a,b)}eval(a,b){let c=this.left.eval(a,b);if(1!==c.length)return[];let d=this.right.name;return T(ab(c[0],d))}},bv=class extends bj{constructor(a,b){super("and",a,b)}eval(a,b){let c=W(this.left.eval(a,b),"boolean"),d=W(this.right.eval(a,b),"boolean");return c?.value===!0&&d?.value===!0?T(!0):c?.value===!1||d?.value===!1?T(!1):[]}},bw=class extends bj{constructor(a,b){super("or",a,b)}eval(a,b){let c=W(this.left.eval(a,b),"boolean"),d=W(this.right.eval(a,b),"boolean");return c?.value===!1&&d?.value===!1?T(!1):c?.value||d?.value?T(!0):[]}},bx=class extends bj{constructor(a,b){super("xor",a,b)}eval(a,b){let c=W(this.left.eval(a,b),"boolean"),d=W(this.right.eval(a,b),"boolean");return c&&d?T(c.value!==d.value):[]}},by=class extends bj{constructor(a,b){super("implies",a,b)}eval(a,b){let c=W(this.left.eval(a,b),"boolean"),d=W(this.right.eval(a,b),"boolean");return d?.value===!0||c?.value===!1?T(!0):c&&d?T(!1):[]}},bz=class{constructor(a,b){f(this,"name"),f(this,"args"),this.name=a,this.args=b}eval(a,b){let c=a8[this.name];if(!c)throw Error("Unrecognized function: "+this.name);return c(a,b,...this.args)}toString(){return`${this.name}(${this.args.map(a=>a.toString()).join(", ")})`}},bA=class{constructor(a,b){f(this,"left"),f(this,"expr"),this.left=a,this.expr=b}eval(a,b){let c=this.expr.eval(a,b);if(1!==c.length)return[];let d=c[0].value;if("number"!=typeof d)throw Error("Invalid indexer expression: should return integer}");let e=this.left.eval(a,b);return d in e?[e[d]]:[]}toString(){return`${this.left.toString()}[${this.expr.toString()}]`}},bB=["year","years","month","months","week","weeks","day","days","hour","hours","minute","minutes","second","seconds","millisecond","milliseconds"],bC={"'":"'",'"':'"',"`":"`",r:"\r",n:`
`,t:"	",f:"\f","\\":"\\"},bD=class{constructor(a,b,c,d){f(this,"str"),f(this,"keywords"),f(this,"operators"),f(this,"dateTimeLiterals"),f(this,"symbolRegex"),f(this,"result",[]),f(this,"pos",{index:0,line:1,column:0}),f(this,"markStack",[]),this.str=a,this.keywords=b,this.operators=c,this.dateTimeLiterals=!!d?.dateTimeLiterals,this.symbolRegex=d?.symbolRegex??/[$\w%]/}tokenize(){for(;this.pos.index<this.str.length;){let a=this.consumeToken();a&&this.result.push(a)}return this.result}prevToken(){return this.result.slice(-1)[0]}peekToken(){this.mark();let a=this.consumeToken();return this.reset(),a}consumeToken(){this.consumeWhitespace();let a=this.curr();if(!a)return;this.mark();let b=this.peek();return"/"===a&&"*"===b?this.consumeMultiLineComment():"/"===a&&"/"===b?this.consumeSingleLineComment():"'"===a||'"'===a||"`"===a?this.consumeString(a):"@"===a?this.consumeDateTime():/\d/.exec(a)?this.consumeNumber():/\w/.exec(a)||("$"===a||"%"===a)&&/\w/.exec(b)?this.consumeSymbol():("$"===a||"%"===a)&&("'"===b||'"'===b||"`"===b)?this.consumeQuotedSymbol(b):this.consumeOperator()}consumeWhitespace(){this.consumeWhile(()=>/\s/.exec(this.curr()))}consumeMultiLineComment(){let a=this.pos.index;return this.consumeWhile(()=>"*"!==this.curr()||"/"!==this.peek()),this.advance(),this.advance(),this.buildToken("Comment",this.str.substring(a,this.pos.index))}consumeSingleLineComment(){return this.buildToken("Comment",this.consumeWhile(()=>this.curr()!==`
`))}consumeString(a){this.advance();let b="",c;for(;c=this.consumeChar(a);)b+=c;let d=this.buildToken("`"===a?"Symbol":"String",b);return this.advance(),d}consumeChar(a){let b=this.curr();if("\\"===b){this.advance();let b=this.curr(),c=bC[b];if(void 0!==c)return this.advance(),c;if("u"===b){this.advance();let a=/^[0-9a-fA-F]{4}$/.exec(this.str.substring(this.pos.index,this.pos.index+4))?.[0];return a?(this.advance(),this.advance(),this.advance(),this.advance(),String.fromCodePoint(Number.parseInt(a,16))):"u"}return this.consumeChar(a)}return b!==a&&b?(this.advance(),b):""}consumeQuotedSymbol(a){this.mark();let b=this.pos.index;this.advance(),this.consumeString(a);let c=this.str.substring(b,this.pos.index);return this.buildToken("Symbol",c)}consumeDateTime(){this.advance();let a=this.pos.index;this.consumeWhile(()=>/[\d-]/.exec(this.curr()));let b=!1,c=!1;if("T"===this.curr()&&(b=!0,this.advance(),this.consumeWhile(()=>/[\d:]/.exec(this.curr())),"."===this.curr()&&/\d/.exec(this.peek())&&(this.advance(),this.consumeWhile(()=>/\d/.exec(this.curr()))),"Z"===this.curr()?(c=!0,this.advance()):("+"===this.curr()||"-"===this.curr())&&(c=!0,this.advance(),this.consumeWhile(()=>/[\d:]/.exec(this.curr())))),this.pos.index===a)throw Error("Invalid DateTime literal");let d=this.str.substring(a,this.pos.index);return d.endsWith("T")?d=d.substring(0,d.length-1):d.startsWith("T")||!b||c||(d+="Z"),this.buildToken("DateTime",d)}consumeNumber(){var a;let b=this.pos.index,c="Number";return this.consumeWhile(()=>/\d/.exec(this.curr())),"."===this.curr()&&/\d/.exec(this.peek())&&(this.advance(),this.consumeWhile(()=>/\d/.exec(this.curr()))),"-"===this.curr()&&this.dateTimeLiterals?(this.pos.index=b-1,this.consumeDateTime()):(" "===this.curr()&&(a=this.peekToken())&&("String"===a.id||"Symbol"===a.id&&bB.includes(a.value))&&(c="Quantity",this.consumeToken()),this.buildToken(c,this.str.substring(b,this.pos.index)))}consumeSymbol(){let a=this.consumeWhile(()=>this.symbolRegex.exec(this.curr()));return this.prevToken()?.value!=="."&&this.keywords.includes(a)?this.buildToken(a,a):this.buildToken("Symbol",a)}consumeOperator(){let a=this.curr(),b=a+this.peek();return this.operators.includes(b)?(this.advance(),this.advance(),this.buildToken(b,b)):(this.advance(),this.buildToken(a,a))}consumeWhile(a){let b=this.pos.index;for(;this.pos.index<this.str.length&&a();)this.advance();return this.str.substring(b,this.pos.index)}curr(){return this.str[this.pos.index]}peek(){return this.str[this.pos.index+1]??""}mark(){this.markStack.push({...this.pos})}reset(){let a=this.markStack.pop();if(!a)throw Error("No mark to reset to");this.pos.index=a.index,this.pos.line=a.line,this.pos.column=a.column}advance(){this.pos.index++,this.curr()===`
`?(this.pos.line++,this.pos.column=0):this.pos.column++}buildToken(a,b){let c=this.markStack.pop();if(!c)throw Error("No mark for token");return{id:a,value:b,...c}}},bE=["true","false"],bF=["!=","!~","<=",">=","{}","->"],bG={FunctionCall:0,Dot:1,Indexer:2,UnaryAdd:3,UnarySubtract:3,Multiply:4,Divide:4,Modulo:4,Add:5,Subtract:5,Ampersand:5,Is:6,As:6,Union:7,GreaterThan:8,GreaterThanOrEquals:8,LessThan:8,LessThanOrEquals:8,Equals:9,Equivalent:9,NotEquals:9,NotEquivalent:9,In:10,Contains:10,And:11,Xor:12,Or:12,Implies:13,Arrow:100,Semicolon:200},bH={parse(a){let b=a.consumeAndParse();if(!a.match(")"))throw Error("Parse error: expected `)` got `"+a.peek()?.value+"`");return b}},bI={parse(a,b){let c=a.consumeAndParse();if(!a.match("]"))throw Error("Parse error: expected `]`");return new bA(b,c)},precedence:bG.Indexer},bJ={parse(a,b){if(!(b instanceof bf))throw Error("Unexpected parentheses");let c=[];for(;!a.match(")");)c.push(a.consumeAndParse()),a.match(",");return new bz(b.name,c)},precedence:bG.FunctionCall};function bK(){return new i().registerPrefix("String",{parse:(a,b)=>new be({type:aZ.string,value:b.value})}).registerPrefix("DateTime",{parse:(a,b)=>new be({type:aZ.dateTime,value:a6(b.value)})}).registerPrefix("Quantity",{parse:(a,b)=>{let c,d,e;return new be({type:aZ.Quantity,value:(d=Number.parseFloat((c=b.value.split(" "))[0]),e=c[1],{value:d,unit:e=e?.startsWith("'")&&e.endsWith("'")?e.substring(1,e.length-1):"{"+e+"}"})})}}).registerPrefix("Number",{parse:(a,b)=>new be({type:b.value.includes(".")?aZ.decimal:aZ.integer,value:Number.parseFloat(b.value)})}).registerPrefix("true",{parse:()=>new be({type:aZ.boolean,value:!0})}).registerPrefix("false",{parse:()=>new be({type:aZ.boolean,value:!1})}).registerPrefix("Symbol",{parse:(a,b)=>new bf(b.value)}).registerPrefix("{}",{parse:()=>new bg}).registerPrefix("(",bH).registerInfix("[",bI).registerInfix("(",bJ).prefix("+",bG.UnaryAdd,(a,b)=>new bh("+",b,a=>a)).prefix("-",bG.UnarySubtract,(a,b)=>new bk("-",b,b,(a,b)=>-b)).infixLeft(".",bG.Dot,(a,b,c)=>new bo(a,c)).infixLeft("/",bG.Divide,(a,b,c)=>new bk("/",a,c,(a,b)=>a/b)).infixLeft("*",bG.Multiply,(a,b,c)=>new bk("*",a,c,(a,b)=>a*b)).infixLeft("+",bG.Add,(a,b,c)=>new bk("+",a,c,(a,b)=>a+b)).infixLeft("-",bG.Subtract,(a,b,c)=>new bk("-",a,c,(a,b)=>a-b)).infixLeft("|",bG.Union,(a,b,c)=>new bp(a,c)).infixLeft("=",bG.Equals,(a,b,c)=>new bq(a,c)).infixLeft("!=",bG.NotEquals,(a,b,c)=>new br(a,c)).infixLeft("~",bG.Equivalent,(a,b,c)=>new bs(a,c)).infixLeft("!~",bG.NotEquivalent,(a,b,c)=>new bt(a,c)).infixLeft("<",bG.LessThan,(a,b,c)=>new bk("<",a,c,(a,b)=>a<b)).infixLeft("<=",bG.LessThanOrEquals,(a,b,c)=>new bk("<=",a,c,(a,b)=>a<=b)).infixLeft(">",bG.GreaterThan,(a,b,c)=>new bk(">",a,c,(a,b)=>a>b)).infixLeft(">=",bG.GreaterThanOrEquals,(a,b,c)=>new bk(">=",a,c,(a,b)=>a>=b)).infixLeft("&",bG.Ampersand,(a,b,c)=>new bl(a,c)).infixLeft("and",bG.And,(a,b,c)=>new bv(a,c)).infixLeft("as",bG.As,(a,b,c)=>new bi(a,c)).infixLeft("contains",bG.Contains,(a,b,c)=>new bm(a,c)).infixLeft("div",bG.Divide,(a,b,c)=>new bk("div",a,c,(a,b)=>a/b|0)).infixLeft("in",bG.In,(a,b,c)=>new bn(a,c)).infixLeft("is",bG.Is,(a,b,c)=>new bu(a,c)).infixLeft("mod",bG.Modulo,(a,b,c)=>new bk("mod",a,c,(a,b)=>a%b)).infixLeft("or",bG.Or,(a,b,c)=>new bw(a,c)).infixLeft("xor",bG.Xor,(a,b,c)=>new bx(a,c)).infixLeft("implies",bG.Implies,(a,b,c)=>new by(a,c))}var bL=bK();function bM(a,b,c){c&&(c.display&&bN(a,b,b.textSearchSystem,c.display),bN(a,b,c.system,c.code))}function bN(a,b,c,d){(c||d)&&!a.some(a=>a.system===c&&a.value===d)&&a.push({system:c,value:d&&b.caseInsensitive?d.toLocaleLowerCase():d})}var bO={EQUALS:"eq",NOT_EQUALS:"ne",GREATER_THAN:"gt",LESS_THAN:"lt",GREATER_THAN_OR_EQUALS:"ge",LESS_THAN_OR_EQUALS:"le",STARTS_AFTER:"sa",ENDS_BEFORE:"eb",APPROXIMATELY:"ap",CONTAINS:"contains",STARTS_WITH:"sw",EXACT:"exact",TEXT:"text",NOT:"not",ABOVE:"above",BELOW:"below",IN:"in",NOT_IN:"not-in",OF_TYPE:"of-type",MISSING:"missing",PRESENT:"present",IDENTIFIER:"identifier",ITERATE:"iterate"},bP={contains:bO.CONTAINS,exact:bO.EXACT,above:bO.ABOVE,below:bO.BELOW,text:bO.TEXT,not:bO.NOT,in:bO.IN,"not-in":bO.NOT_IN,"of-type":bO.OF_TYPE,missing:bO.MISSING,identifier:bO.IDENTIFIER,iterate:bO.ITERATE},bQ={eq:bO.EQUALS,ne:bO.NOT_EQUALS,lt:bO.LESS_THAN,le:bO.LESS_THAN_OR_EQUALS,gt:bO.GREATER_THAN,ge:bO.GREATER_THAN_OR_EQUALS,sa:bO.STARTS_AFTER,eb:bO.ENDS_BEFORE,ap:bO.APPROXIMATELY,sw:bO.STARTS_WITH},bR=[bO.MISSING,bO.PRESENT];function bS(a){let b=a.split(":");if(b.includes("*"))throw new w(s("'*' is not supported as a value for search inclusion parameters"));if(1===b.length)throw new w(s(`Invalid include value '${a}': must be of the form ResourceType:search-parameter`));if(2===b.length)return{resourceType:b[0],searchParam:b[1]};if(3===b.length)return{resourceType:b[0],searchParam:b[1],targetType:b[2]};throw new w(s(`Invalid include value '${a}'`))}function bT(a,b){return"date"!==a.type||ad(b)}function bU(a){let b=[],c="",d=!1;for(let e of a)d?(c+=e,d=!1):"\\"===e?d=!0:","===e?(b.push(c),c=""):c+=e;return b.push(c),b}function bV(a){return a===bO.NOT_EQUALS||a===bO.NOT}var bW={resourceType:"*"},bX=["UserSecurityRequest","Project","ProjectMembership","User"],bY={READ:"read",VREAD:"vread",UPDATE:"update",DELETE:"delete",HISTORY:"history",CREATE:"create",SEARCH:"search"},bZ=[bY.READ,bY.VREAD,bY.HISTORY,bY.SEARCH];function b$(a,b,c){return c?c.resource?.find(c=>{var d,e,f,g,h,i;let j;return d=a,e=b,f=c,j=d.resourceType,g=f,h=j,i=e,!!(!(g.resourceType!==h&&("*"!==g.resourceType||bX.includes(h)))&&(g.interaction?g.interaction.includes(i):!g.readonly||bZ.includes(i)))&&("Binary"===j||!(f.compartment&&!d.meta?.compartment?.some(a=>a.reference===f.compartment?.reference)||f.criteria&&!function(a,b){if(b.resourceType!==a.resourceType)return!1;if(b.filters){for(let c of b.filters)if(!function(a,b,c){let d=a5.types[b.resourceType]?.searchParams?.[c.code];if(!d)return!1;let e=function(a,b,c={},d){let e;if("string"==typeof a){var f;let b;e=b??new bd(f=a,bL.construct(new bD(f,bE,bF).tokenize()).consumeAndParse())}else e=a;return e.eval({variables:c},b).map(a=>{let b={type:a.type,value:a.value?.valueOf()};return"path"in a&&(b.path=a.path),b})}(d.expression,[U(a)]);if(c.operator===bO.MISSING||c.operator===bO.PRESENT)return function(a,b){let c=a.length>0;return(b.operator===bO.MISSING&&"false"===b.value||b.operator===bO.PRESENT&&"true"===b.value)===c}(e,c);switch(d.type){case"reference":return function(a,b){let c=bV(b.operator);if(""===b.value&&0===a.length)return b.operator===bO.EQUALS;let d=function(a){let b=new Set;for(let c of a){let{value:a}=c;a&&("string"==typeof a?b.add(a):a4(a)?b.add(a.reference):am(a)?b.add(ao(a)):"object"==typeof a.identifier&&b.add(`identifier:${a.identifier.system}|${a.identifier.value}`))}return Array.from(b)}(a);for(let a of bU(b.value)){let e=d.includes(a);if(e||"_compartment"!==b.code||(e=d.some(b=>b?.endsWith("/"+a))),e)return!c}return c}(e,c);case"string":case"uri":return function(a,b){let c=function(a){let b=new Set;for(let c of a){let a=function(a){if(!a)return"";switch(a.type){case"Address":return aJ(a.value);case"CodeableConcept":return aV(a.value);case"Coding":return aW(a.value);case"ContactPoint":return a.value.value;case"HumanName":return aK(a.value);case"Quantity":return aT(a.value);case"Reference":var b;return(b=a.value)?b.display??b.reference??au(b):"";default:return a.value?.toString()??""}}(c);a&&b.add(a)}return Array.from(b)}(a),d=bU(b.value),e=bV(b.operator);for(let a of c)for(let b of d){var f,g;if(f=a,g=b,f.toLowerCase().includes(g.toLowerCase()))return!e}return e}(e,c);case"token":return function(a,b){let c=function(a,b={}){let c=[];for(let d of a)!function(a,b,c){let{type:d,value:e}=c;switch(d){case aZ.Identifier:f=b,g=a,h=e,h?.type?.text&&bN(f,g,g.textSearchSystem,h.type.text),bN(f,g,h?.system,h?.value);break;case aZ.CodeableConcept:var f,g,h,i,j,k,l=b,m=a,n=e;if(n?.text&&bN(l,m,m.textSearchSystem,n.text),n?.coding)for(let a of n.coding)bM(l,m,a);break;case aZ.Coding:bM(b,a,e);break;case aZ.ContactPoint:i=b,j=a,(k=e)&&bN(i,j,k.system,k.value?.toLocaleLowerCase());break;default:bN(b,a,void 0,e?.toString())}}(b,c,d);return c}(a),d=bU(b.value),e=bV(b.operator);for(let a of c)for(let b of d)if(function(a,b){if(b.includes("|")){let[c,d]=b.split("|").map(a=>a.toLowerCase());return(!!c||!!d)&&(c?a.system?.toLowerCase()===c&&(!d||a.value?.toLowerCase()===d):!a.system&&a.value?.toLowerCase()===d)}return a.value?.toLowerCase()===b.toLowerCase()}(a,b))return!e;return e}(e,c);case"date":return function(a,b){let c=function(a){let b=[];for(let c of a){let a=af(c.value);a&&b.push(a)}return b}(a),d=bU(b.value),e=bV(b.operator);for(let a of c)for(let c of d)if(function(a,b,c){if(!a)return!1;let d=af(c);if(!d)return!1;let e=a.start??"0000",f=a.end??"9999",g=d.start,h=d.end;switch(b){case bO.APPROXIMATELY:case bO.EQUALS:case bO.NOT_EQUALS:return e<h&&f>g;case bO.LESS_THAN:return e<g;case bO.GREATER_THAN:return f>h;case bO.LESS_THAN_OR_EQUALS:return e<=h;case bO.GREATER_THAN_OR_EQUALS:return f>=g;case bO.STARTS_AFTER:return e>h;case bO.ENDS_BEFORE:return f<g;default:return!1}}(a,b.operator,c))return!e;return e}(e,c);default:return!1}}(a,b,c))return!1}return!0}(d,function(a,b){let c;if(!a)throw Error("Invalid search URL");let d="",e;if("string"==typeof a)if(a.includes("?")){let[b,c]=a.split("?");d=b,e=new URLSearchParams(c)}else d=a;else"object"==typeof a&&(d=a.pathname,e=a.searchParams);c=d.includes("/")?d.split("/").filter(Boolean).pop():d;let f=[];e&&f.push(...e.entries());var g=c,h=f;let i={resourceType:g};for(let[a,b]of h)!function(a,b,c){let d,e,f=b.indexOf(":");if(f>=0?(d=b.substring(0,f),e=b.substring(f+1)):(d=b,e=""),"_"!==d){if("_has"===d||b.includes(".")){a.filters=aG(a.filters,{code:b,operator:bO.EQUALS,value:c});return}switch(d){case"_sort":var g=a,h=c;for(let a of h.split(",")){let b,c=!1;a.startsWith("-")?(b=a.substring(1),c=!0):b=a,g.sortRules||(g.sortRules=[]),g.sortRules.push({code:b,descending:c})}break;case"_cursor":a.cursor=c;break;case"_count":a.count=Number.parseInt(c,10);break;case"_offset":a.offset=Number.parseInt(c,10);break;case"_total":a.total=c;break;case"_summary":"count"===c?(a.total="accurate",a.count=0):("true"===c||"data"===c||"text"===c)&&(a.summary=c);break;case"_include":{let b=bS(c);"iterate"===e&&(b.modifier=bO.ITERATE),a.include=aG(a.include,b);break}case"_revinclude":{let b=bS(c);"iterate"===e&&(b.modifier=bO.ITERATE),a.revInclude=aG(a.revInclude,b);break}case"_fields":case"_elements":a.fields=c.split(",");break;case"_type":a.types=c.split(",");break;case"_format":a.format=c;break;case"_pretty":a.pretty="true"===c;break;default:{let b=a5.types[a.resourceType]?.searchParams?.[d];b?a.filters=aG(a.filters,function(a,b,c){if(bR.includes(b))return{code:a.code,operator:b,value:c};switch(a.type){case"number":case"date":case"quantity":{let{operator:d,value:e}=function(a,b){let c=bQ[a.substring(0,2)];return c?{operator:c,value:a.substring(2)}:{operator:b,value:a}}(c,b||bO.EQUALS);if(!bT(a,e))throw new w(s(`Invalid format for ${a.type} search parameter: ${e}`));return{code:a.code,operator:d,value:e}}case"reference":case"string":case"token":case"uri":if(!bT(a,c))throw new w(s(`Invalid format for ${a.type} search parameter: ${c}`));return{code:a.code,operator:bP[b]??bO.EQUALS,value:c};default:throw Error("Unrecognized search parameter type: "+a.type)}}(b,e,c)):a.filters=aG(a.filters,function(a,b,c){let d=bO.EQUALS;if(b)d=b;else if(c.length>=2){let a=c.substring(0,2);a in bQ&&(2===c.length||c.at(2)?.match(/\d/))&&(d=a,c=c.substring(a.length))}return{code:a,operator:d,value:c}}(d,e,c))}}}}(i,a,b);return i}(f.criteria))))}):bW}function b_(){return"u">typeof Buffer?Buffer:void 0}var b0={assign(a){},reload(){},getSearch:()=>"",getPathname:()=>"",getLocation:()=>"",getOrigin:()=>""};function b1(a){let b=b_();if(b)return b.from(a,"utf8").toString("base64");throw Error("Unable to encode base64")}function b2(){let a=new Uint32Array(28);return crypto.getRandomValues(a),function(a){let b=new Uint8Array(aC(a)),c=Array(b.length);for(let a=0;a<b.length;a++)c[a]=aB[b[a]];return c.join("")}(a.buffer)}async function b3(a){return crypto.subtle.digest("SHA-256",new TextEncoder().encode(a))}var b4={CSS:"text/css",DICOM:"application/dicom",FAVICON:"image/vnd.microsoft.icon",FHIR_JSON:"application/fhir+json",FORM_URL_ENCODED:"application/x-www-form-urlencoded",HL7_V2:"x-application/hl7-v2+er7",HTML:"text/html",JAVASCRIPT:"text/javascript",JSON:"application/json",JSON_PATCH:"application/json-patch+json",JWT:"application/jwt",MULTIPART_FORM_DATA:"multipart/form-data",PNG:"image/png",SCIM_JSON:"application/scim+json",SVG:"image/svg+xml",TEXT:"text/plain",TYPESCRIPT:"text/typescript",PING:"x-application/ping",XML:"text/xml",CDA_XML:"application/cda+xml",OCTET_STREAM:"application/octet-stream"},b5=class{constructor(){f(this,"listeners"),this.listeners={}}addEventListener(a,b){this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)}removeEventListener(a,b){let c=this.listeners[a];if(c){for(let a=0;a<c.length;a++)if(c[a]===b)return void c.splice(a,1)}}dispatchEvent(a){let b=this.listeners[a.type];if(b)for(let c of b)c.call(this,a);return!a.defaultPrevented}removeAllListeners(){this.listeners={}}listenerCount(a){return this.listeners[a]?.length??0}},b6=class{constructor(){f(this,"emitter",new b5)}dispatchEvent(a){this.emitter.dispatchEvent(a)}addEventListener(a,b){this.emitter.addEventListener(a,b)}removeEventListener(a,b){this.emitter.removeEventListener(a,b)}removeAllListeners(){this.emitter.removeAllListeners()}listenerCount(a){return this.emitter.listenerCount(a)}},b7={"Patient-open":"Patient-open","Patient-close":"Patient-close","ImagingStudy-open":"ImagingStudy-open","ImagingStudy-close":"ImagingStudy-close","Encounter-open":"Encounter-open","Encounter-close":"Encounter-close","DiagnosticReport-open":"DiagnosticReport-open","DiagnosticReport-close":"DiagnosticReport-close","DiagnosticReport-select":"DiagnosticReport-select","DiagnosticReport-update":"DiagnosticReport-update",syncerror:"syncerror"},b8=["Patient","Encounter","ImagingStudy","DiagnosticReport","OperationOutcome","Bundle"],b9=["DiagnosticReport-update"],ca={"Patient-open":{patient:{resourceType:"Patient"},encounter:{resourceType:"Encounter",optional:!0}},"Patient-close":{patient:{resourceType:"Patient"},encounter:{resourceType:"Encounter",optional:!0}},"ImagingStudy-open":{study:{resourceType:"ImagingStudy"},encounter:{resourceType:"Encounter",optional:!0},patient:{resourceType:"Patient",optional:!0}},"ImagingStudy-close":{study:{resourceType:"ImagingStudy"},encounter:{resourceType:"Encounter",optional:!0},patient:{resourceType:"Patient",optional:!0}},"Encounter-open":{encounter:{resourceType:"Encounter"},patient:{resourceType:"Patient"}},"Encounter-close":{encounter:{resourceType:"Encounter"},patient:{resourceType:"Patient"}},"DiagnosticReport-open":{report:{resourceType:"DiagnosticReport"},encounter:{resourceType:"Encounter",optional:!0},study:{resourceType:"ImagingStudy",optional:!0,manyAllowed:!0},patient:{resourceType:"Patient"}},"DiagnosticReport-close":{report:{resourceType:"DiagnosticReport"},encounter:{resourceType:"Encounter",optional:!0},study:{resourceType:"ImagingStudy",optional:!0,manyAllowed:!0},patient:{resourceType:"Patient"}},"DiagnosticReport-select":{report:{resourceType:"DiagnosticReport",reference:!0},patient:{resourceType:"Patient",optional:!0,reference:!0},select:{resourceType:"*",reference:!0,manyAllowed:!0}},"DiagnosticReport-update":{report:{resourceType:"DiagnosticReport",reference:!0},patient:{resourceType:"Patient",optional:!0,reference:!0},updates:{resourceType:"Bundle"}},syncerror:{operationoutcome:{resourceType:"OperationOutcome"}}};function cb(a){return!!a.endpoint}function cc(a){if(!cd(a))throw new w(t("subscriptionRequest must be an object conforming to SubscriptionRequest type."));let{channelType:b,mode:c,topic:d,events:e}=a,f={"hub.channel.type":b,"hub.mode":c,"hub.topic":d,"hub.events":e.join(",")};return cb(a)&&(f.endpoint=a.endpoint),new URLSearchParams(f).toString()}function cd(a){if("object"!=typeof a)return!1;let{channelType:b,mode:c,topic:d,events:e}=a;if(!(b&&c&&d&&e)||"string"!=typeof d||"object"!=typeof e||!Array.isArray(e)||e.length<1||"websocket"!==b||"subscribe"!==c&&"unsubscribe"!==c)return!1;for(let a of e)if(!b7[a])return!1;return!(cb(a)&&!("string"==typeof a.endpoint&&a.endpoint.startsWith("ws")))}function ce(a,b,c,d){if(!(a&&"string"==typeof a))throw new w(t("Must provide a topic."));if(!b7[b])throw new w(t(`Must provide a valid FHIRcast event name. Supported events: ${Object.keys(b7).join(", ")}`));if("object"!=typeof c)throw new w(t("context must be a context object or array of context objects."));if(b9.includes(b)&&!d)throw new w(t(`The '${b}' event must contain a 'context.versionId'.`));let e=Array.isArray(c)?c:[c];return function(a,b){let c=new Map,d=ca[a];for(let e=0;e<b.length;e++){let f=b[e].key;if(!d[f])throw new w(t(`Key '${f}' not found for event '${a}'. Make sure to add only valid keys.`));!function(a,b,c,d,e){if(e.set(b.key,(e.get(b.key)??0)+1),d.reference){if(!a4(b.reference))throw new w(t(`context[${c}] is invalid. Expected key '${b.key}' to be a reference.`))}else{var f,g=b.resource;if("object"!=typeof g)throw new w(t(`context[${c}] is invalid. Context must contain a single valid FHIR resource! Resource is not an object.`));if(!(g.id&&"string"==typeof g.id))throw new w(t(`context[${c}] is invalid. Resource must contain a valid string ID.`));if(!g.resourceType)throw new w(t(`context[${c}] is invalid. Resource must contain a resource type. No resource type found.`));let e=d.resourceType;if("*"!==e){if(f=g.resourceType,!b8.includes(f))throw new w(t(`context[${c}] is invalid. Resource must contain a valid FHIRcast resource type. Resource type is not a known resource type.`));if(e&&g.resourceType!==e)throw new w(t(`context[${c}] is invalid. context[${c}] for the '${a}' event should contain resource of type ${e}.`))}}}(a,b[e],e,d[f],c)}for(let[b,e]of Object.entries(d)){if(!(e.optional||c.has(b)))throw new w(t(`Missing required key '${b}' on context for '${a}' event.`));if(!e.manyAllowed&&(c.get(b)??0)>1)throw new w(t(`${c.get(b)} context entries with key '${b}' found for the '${a}' event when schema only allows for 1.`))}}(b,e),{timestamp:new Date().toISOString(),id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replaceAll(/[xy]/g,a=>{let b=16*Math.random()|0;return("x"===a?b:3&b|8).toString(16)}),event:{"hub.topic":a,"hub.event":b,context:e,...d?{"context.versionId":d}:{}}}}var cf=class extends b6{constructor(a){if(super(),f(this,"subRequest"),f(this,"websocket"),this.subRequest=a,!a.endpoint)throw new w(t("Subscription request should contain an endpoint."));if(!cd(a))throw new w(t("Subscription request failed validation."));let b=new WebSocket(a.endpoint);b.addEventListener("open",()=>{this.dispatchEvent({type:"connect"}),b.addEventListener("message",a=>{let c=JSON.parse(a.data);c["hub.topic"]||"heartbeat"!==c.event["hub.event"]&&(this.dispatchEvent({type:"message",payload:c}),b.send(JSON.stringify({id:c?.id,timestamp:new Date().toISOString()})))}),b.addEventListener("close",()=>{this.dispatchEvent({type:"disconnect"})})}),this.websocket=b}disconnect(){this.websocket.close()}};function cg(a){let[b,c,d]=a.split(".");return JSON.parse(function(a){var b=(a=a.padEnd(a.length+(4-a.length%4)%4,"=")).replaceAll("-","+").replaceAll("_","/");let c=b_();if(c)return c.from(b,"base64").toString("utf-8");throw Error("Unable to decode base64")}(c))}var ch=class{constructor(a){f(this,"medplum"),this.medplum=a}async get(a){return this.medplum.get(`keyvalue/v1/${a}`)}async set(a,b){await this.medplum.put(`keyvalue/v1/${a}`,b,b4.TEXT)}async delete(a){await this.medplum.delete(`keyvalue/v1/${a}`)}};d=Symbol.toStringTag;var ci=class{constructor(a){f(this,d,"ReadablePromise"),f(this,"suspender"),f(this,"status","pending"),f(this,"response"),f(this,"error"),this.suspender=a.then(a=>(this.status="success",this.response=a,a),a=>{throw this.status="error",this.error=a,a})}isPending(){return"pending"===this.status}isOk(){return"success"===this.status}read(){switch(this.status){case"pending":throw this.suspender;case"error":throw this.error;default:return this.response}}then(a,b){return this.suspender.then(a,b)}catch(a){return this.suspender.catch(a)}finally(a){return this.suspender.finally(a)}},cj=class{constructor(a,b=""){f(this,"storage"),f(this,"prefix",""),this.storage=a??globalThis.localStorage??new ck,this.prefix=b}makeKey(a){return this.prefix+a}clear(){this.storage===globalThis.localStorage&&this.prefix?Object.keys(this.storage).filter(a=>a.startsWith(this.prefix)).forEach(a=>{this.storage.removeItem(a)}):this.storage.clear()}getString(a){return this.storage.getItem(this.makeKey(a))??void 0}setString(a,b){b?this.storage.setItem(this.makeKey(a),b):this.storage.removeItem(this.makeKey(a))}getObject(a){let b=this.getString(a);return b?JSON.parse(b):void 0}setObject(a,b){this.setString(a,b?au(b):void 0)}},ck=class{constructor(){f(this,"data"),this.data=new Map}get length(){return this.data.size}clear(){this.data.clear()}getItem(a){return this.data.get(a)??null}setItem(a,b){b?this.data.set(a,b):this.data.delete(a)}removeItem(a){this.data.delete(a)}key(a){return Array.from(this.data.keys())[a]}},cl={Event:"u">typeof globalThis.Event?globalThis.Event:void 0,ErrorEvent:void 0,CloseEvent:void 0},cm=!1;function cn(a){return new a.constructor(a.type,a)}var co={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0},cp=!1,cq=class a extends b6{constructor(a,b,c={}){cm||(function(){if(typeof globalThis.Event>"u")throw Error("Unable to lazy init events for ReconnectingWebSocket. globalThis.Event is not defined yet");cl.Event=globalThis.Event,cl.ErrorEvent=class extends Event{constructor(a,b){super("error",b),f(this,"message"),f(this,"error"),this.message=a.message,this.error=a}},cl.CloseEvent=class extends Event{constructor(a=1e3,b="",c){super("close",c),f(this,"code"),f(this,"reason"),f(this,"wasClean",!0),this.code=a,this.reason=b}}}(),cm=!0),super(),f(this,"_ws"),f(this,"_retryCount",-1),f(this,"_uptimeTimeout"),f(this,"_connectTimeout"),f(this,"_shouldReconnect",!0),f(this,"_connectLock",!1),f(this,"_binaryType"),f(this,"_closeCalled",!1),f(this,"_messageQueue",[]),f(this,"_debugLogger",console.log.bind(console)),f(this,"_url"),f(this,"_protocols"),f(this,"_options"),f(this,"onclose",null),f(this,"onerror",null),f(this,"onmessage",null),f(this,"onopen",null),f(this,"_handleOpen",a=>{this._debug("open event");let{minUptime:b=co.minUptime}=this._options;clearTimeout(this._connectTimeout),this._uptimeTimeout=setTimeout(()=>this._acceptOpen(),b),function(a,b){if(!a)throw Error(b)}(this._ws,"WebSocket is not defined"),this._ws.binaryType=this._binaryType,this._messageQueue.forEach(a=>this._ws?.send(a)),this._messageQueue=[],this.onopen&&this.onopen(a),this.dispatchEvent(cn(a))}),f(this,"_handleMessage",a=>{this._debug("message event"),this.onmessage&&this.onmessage(a),this.dispatchEvent(cn(a))}),f(this,"_handleError",a=>{this._debug("error event",a.message),this._disconnect(void 0,"TIMEOUT"===a.message?"timeout":void 0),this.onerror&&this.onerror(a),this._debug("exec error listeners"),this.dispatchEvent(cn(a)),this._connect()}),f(this,"_handleClose",a=>{this._debug("close event"),this._clearTimeouts(),this._shouldReconnect&&this._connect(),this.onclose&&this.onclose(a),this.dispatchEvent(cn(a))}),this._url=a,this._protocols=b,this._options=c,this._options.startClosed&&(this._shouldReconnect=!1),this._options.binaryType?this._binaryType=this._options.binaryType:this._binaryType="blob",this._options.debugLogger&&(this._debugLogger=this._options.debugLogger),this._connect()}static get CONNECTING(){return 0}static get OPEN(){return 1}static get CLOSING(){return 2}static get CLOSED(){return 3}get CONNECTING(){return a.CONNECTING}get OPEN(){return a.OPEN}get CLOSING(){return a.CLOSING}get CLOSED(){return a.CLOSED}get binaryType(){return this._ws?this._ws.binaryType:this._binaryType}set binaryType(a){this._binaryType=a,this._ws&&(this._ws.binaryType=a)}get retryCount(){return Math.max(this._retryCount,0)}get bufferedAmount(){return this._messageQueue.reduce((a,b)=>("string"==typeof b?a+=b.length:b instanceof Blob?a+=b.size:a+=b.byteLength,a),0)+(this._ws?.bufferedAmount??0)}get extensions(){return this._ws?.extensions??""}get protocol(){return this._ws?.protocol??""}get readyState(){return this._ws?this._ws.readyState:this._options.startClosed?a.CLOSED:a.CONNECTING}get url(){return this._ws?this._ws.url:""}get shouldReconnect(){return this._shouldReconnect}close(a=1e3,b){return(this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws)?this._ws.readyState===this.CLOSED?void this._debug("close: already closed"):void this._ws.close(a,b):void this._debug("close enqueued: no ws instance")}reconnect(a,b){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED&&this._disconnect(a,b),this._connect()}send(a){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",a),this._ws.send(a);else{let{maxEnqueuedMessages:b=co.maxEnqueuedMessages}=this._options;this._messageQueue.length<b&&(this._debug("enqueue",a),this._messageQueue.push(a))}}_debug(...a){this._options.debug&&this._debugLogger("RWS>",...a)}_getNextDelay(){let{reconnectionDelayGrowFactor:a=co.reconnectionDelayGrowFactor,minReconnectionDelay:b=co.minReconnectionDelay,maxReconnectionDelay:c=co.maxReconnectionDelay}=this._options,d=0;return this._retryCount>0&&(d=b*Math.pow(a,this._retryCount-1))>c&&(d=c),this._debug("next delay",d),d}_wait(){return new Promise(a=>{setTimeout(a,this._getNextDelay())})}_connect(){if(this._connectLock||!this._shouldReconnect)return;this._connectLock=!0;let{maxRetries:a=co.maxRetries,connectionTimeout:b=co.connectionTimeout}=this._options;if(this._retryCount>=a)return void this._debug("max retries reached",this._retryCount,">=",a);this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),this._wait().then(()=>{if(this._closeCalled){this._connectLock=!1;return}!this._options.WebSocket&&typeof WebSocket>"u"&&!cp&&(console.error("â€¼ï¸ No WebSocket implementation available. You should define options.WebSocket."),cp=!0);let a=this._options.WebSocket||WebSocket;this._debug("connect",{url:this._url,protocols:this._protocols}),this._ws=this._protocols?new a(this._url,this._protocols):new a(this._url),this._ws.binaryType=this._binaryType,this._connectLock=!1,this._addListeners(),this._connectTimeout=setTimeout(()=>this._handleTimeout(),b)}).catch(a=>{this._connectLock=!1,this._handleError(new cl.ErrorEvent(Error(a.message),this))})}_handleTimeout(){this._debug("timeout event"),this._handleError(new cl.ErrorEvent(Error("TIMEOUT"),this))}_disconnect(a=1e3,b){if(this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(a,b),this._handleClose(new cl.CloseEvent(a,b,this))}catch{}}}_acceptOpen(){this._debug("accept open"),this._retryCount=0}_removeListeners(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))}_addListeners(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))}_clearTimeouts(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)}},cr=class extends b6{constructor(...a){super(),f(this,"criteria"),this.criteria=new Set(a)}getCriteria(){return this.criteria}_addCriteria(a){this.criteria.add(a)}_removeCriteria(a){this.criteria.delete(a)}},cs=class{constructor(a,b){f(this,"criteria"),f(this,"emitter"),f(this,"refCount"),f(this,"subscriptionProps"),f(this,"subscriptionId"),f(this,"token"),f(this,"connecting",!1),this.criteria=a,this.emitter=new cr(a),this.refCount=1,this.subscriptionProps=b?{...b}:void 0}clearAttachedSubscription(){this.subscriptionId=void 0,this.token=void 0}},ct=class{constructor(a,b,c){let d;if(f(this,"medplum"),f(this,"ws"),f(this,"masterSubEmitter"),f(this,"criteriaEntries"),f(this,"criteriaEntriesBySubscriptionId"),f(this,"wsClosed"),f(this,"pingTimer"),f(this,"pingIntervalMs"),f(this,"waitingForPong",!1),f(this,"currentProfile"),!(a instanceof cz))throw new w(t("First arg of constructor should be a `MedplumClient`"));try{d=new URL(b).toString()}catch{throw new w(t("Not a valid URL"))}let e=c?.ReconnectingWebSocket?new c.ReconnectingWebSocket(d,void 0,{debug:c?.debug,debugLogger:c?.debugLogger}):new cq(d,void 0,{debug:c?.debug,debugLogger:c?.debugLogger});this.medplum=a,this.ws=e,this.masterSubEmitter=new cr,this.criteriaEntries=new Map,this.criteriaEntriesBySubscriptionId=new Map,this.wsClosed=!1,this.pingIntervalMs=c?.pingIntervalMs??5e3,this.currentProfile=a.getProfile(),this.setupListeners()}setupListeners(){let a=this.ws;a.addEventListener("message",a=>{try{let b=JSON.parse(a.data);if("pong"===b.type){this.waitingForPong=!1;return}let c=b?.entry?.[0]?.resource;if("heartbeat"===c.type)return void this.masterSubEmitter?.dispatchEvent({type:"heartbeat",payload:b});if("handshake"===c.type){let a=ap(c.subscription),b={type:"connect",payload:{subscriptionId:a}};this.masterSubEmitter?.dispatchEvent(b);let d=this.criteriaEntriesBySubscriptionId.get(a);if(!d)return void console.warn("Received handshake for criteria the SubscriptionManager is not listening for yet");d.connecting=!1,d.emitter.dispatchEvent({...b});return}this.masterSubEmitter?.dispatchEvent({type:"message",payload:b});let d=this.criteriaEntriesBySubscriptionId.get(ap(c.subscription));if(!d)return void console.warn("Received notification for criteria the SubscriptionManager is not listening for");d.emitter.dispatchEvent({type:"message",payload:b})}catch(b){console.error(b);let a={type:"error",payload:b};for(let b of(this.masterSubEmitter?.dispatchEvent(a),this.getAllCriteriaEmitters()))b.dispatchEvent({...a})}}),a.addEventListener("error",()=>{let a={type:"error",payload:new w({resourceType:"OperationOutcome",issue:[{severity:"error",code:"exception",details:{text:"Internal server error"},diagnostics:Error("WebSocket error").toString()}]})};for(let b of(this.masterSubEmitter?.dispatchEvent(a),this.getAllCriteriaEmitters()))b.dispatchEvent({...a})}),a.addEventListener("close",()=>{let a={type:"close"};for(let b of(this.masterSubEmitter?.dispatchEvent(a),this.getAllCriteriaEmitters()))b.dispatchEvent({...a});this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=void 0,this.waitingForPong=!1),this.wsClosed&&(this.criteriaEntries.clear(),this.criteriaEntriesBySubscriptionId.clear(),this.masterSubEmitter?.removeAllListeners())}),a.addEventListener("open",()=>{let b={type:"open"};for(let a of(this.masterSubEmitter?.dispatchEvent(b),this.getAllCriteriaEmitters()))a.dispatchEvent({...b});this.refreshAllSubscriptions().catch(console.error),this.pingTimer||(this.pingTimer=setInterval(()=>{if(this.waitingForPong){this.waitingForPong=!1,a.reconnect();return}a.send(JSON.stringify({type:"ping"})),this.waitingForPong=!0},this.pingIntervalMs))}),this.medplum.addEventListener("change",()=>{let a=this.medplum.getProfile();this.currentProfile&&void 0===a?this.ws.close():a&&this.currentProfile?.id!==a.id&&this.ws.reconnect(),this.currentProfile=a})}emitError(a,b){let c={type:"error",payload:b};this.masterSubEmitter?.dispatchEvent(c),a.emitter.dispatchEvent({...c})}maybeEmitDisconnect(a){let{subscriptionId:b}=a;if(b){let c={type:"disconnect",payload:{subscriptionId:b}};this.masterSubEmitter?.dispatchEvent(c),a.emitter.dispatchEvent({...c})}else console.warn("Called disconnect for `CriteriaEntry` before `subscriptionId` was present.")}async getTokenForCriteria(a){let b=a?.subscriptionId;b||(b=(await this.medplum.createResource({...a.subscriptionProps,resourceType:"Subscription",status:"active",reason:`WebSocket subscription for ${ao(this.medplum.getProfile())}`,channel:{type:"websocket"},criteria:a.criteria})).id);let{parameter:c}=await this.medplum.get(`fhir/R4/Subscription/${b}/$get-ws-binding-token`),d=c?.find(a=>"token"===a.name)?.valueString,e=c?.find(a=>"websocket-url"===a.name)?.valueUrl;if(!d)throw new w(t("Failed to get token"));if(!e)throw new w(t("Failed to get URL from $get-ws-binding-token"));return[b,d]}maybeGetCriteriaEntry(a,b){let c=this.criteriaEntries.get(a);if(c){if(!b)return c.bareCriteria;for(let a of c.criteriaWithProps)if(ax(b,a.subscriptionProps))return a}}getAllCriteriaEmitters(){let a=[];for(let b of this.criteriaEntries.values())for(let c of(b.bareCriteria&&a.push(b.bareCriteria.emitter),b.criteriaWithProps))a.push(c.emitter);return a}addCriteriaEntry(a){let{criteria:b,subscriptionProps:c}=a,d;this.criteriaEntries.has(b)?d=this.criteriaEntries.get(b):(d={criteriaWithProps:[]},this.criteriaEntries.set(b,d)),c?d.criteriaWithProps.push(a):d.bareCriteria=a}removeCriteriaEntry(a){let{criteria:b,subscriptionProps:c,subscriptionId:d,token:e}=a;if(!this.criteriaEntries.has(b))return;let f=this.criteriaEntries.get(b);c?f.criteriaWithProps=f.criteriaWithProps.filter(a=>!ax(c,a.subscriptionProps)):f.bareCriteria=void 0,f.bareCriteria||0!==f.criteriaWithProps.length||(this.criteriaEntries.delete(b),this.masterSubEmitter?._removeCriteria(b)),d&&this.criteriaEntriesBySubscriptionId.delete(d),e&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify({type:"unbind-from-token",payload:{token:e}}))}async subscribeToCriteria(a){if(!(this.ws.readyState!==WebSocket.OPEN||a.connecting)){a.connecting=!0;try{let[b,c]=await this.getTokenForCriteria(a);a.subscriptionId=b,a.token=c,this.criteriaEntriesBySubscriptionId.set(b,a),this.ws.send(JSON.stringify({type:"bind-with-token",payload:{token:c}}))}catch(b){console.error(y(b)),this.emitError(a,b),this.removeCriteriaEntry(a)}}}async refreshAllSubscriptions(){for(let a of(this.criteriaEntriesBySubscriptionId.clear(),this.criteriaEntries.values()))for(let b of[...a.bareCriteria?[a.bareCriteria]:[],...a.criteriaWithProps])b.clearAttachedSubscription(),await this.subscribeToCriteria(b)}addCriteria(a,b){this.masterSubEmitter&&this.masterSubEmitter._addCriteria(a);let c=this.maybeGetCriteriaEntry(a,b);if(c)return c.refCount+=1,c.emitter;let d=new cs(a,b);return this.addCriteriaEntry(d),this.subscribeToCriteria(d).catch(console.error),d.emitter}removeCriteria(a,b){let c=this.maybeGetCriteriaEntry(a,b);if(!c)return void console.warn("Criteria not known to `SubscriptionManager`. Possibly called remove too many times.");c.refCount-=1,c.refCount>0||(this.maybeEmitDisconnect(c),this.removeCriteriaEntry(c))}getWebSocket(){return this.ws}closeWebSocket(){this.wsClosed||(this.wsClosed=!0,this.ws.close())}reconnectWebSocket(){this.ws.reconnect(),this.wsClosed=!1}getCriteriaCount(){return this.getAllCriteriaEmitters().length}getMasterEmitter(){return this.masterSubEmitter||(this.masterSubEmitter=new cr(...Array.from(this.criteriaEntries.keys()))),this.masterSubEmitter}},cu=b4.FHIR_JSON+", */*; q=0.1",cv={resourceType:"Device",id:"system",deviceName:[{type:"model-name",name:"System"}]},cw={ClientCredentials:"client_credentials",AuthorizationCode:"authorization_code",RefreshToken:"refresh_token",JwtBearer:"urn:ietf:params:oauth:grant-type:jwt-bearer",TokenExchange:"urn:ietf:params:oauth:grant-type:token-exchange"},cx={AccessToken:"urn:ietf:params:oauth:token-type:access_token"},cy={JwtBearer:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer"},cz=class extends b6{constructor(a){if(super(),f(this,"options"),f(this,"fetch"),f(this,"createPdfImpl"),f(this,"storage"),f(this,"requestCache"),f(this,"cacheTime"),f(this,"baseUrl"),f(this,"fhirBaseUrl"),f(this,"authorizeUrl"),f(this,"tokenUrl"),f(this,"logoutUrl"),f(this,"fhircastHubUrl"),f(this,"defaultHeaders"),f(this,"onUnauthenticated"),f(this,"autoBatchTime"),f(this,"autoBatchQueue"),f(this,"refreshGracePeriod"),f(this,"subscriptionManager"),f(this,"medplumServer"),f(this,"clientId"),f(this,"clientSecret"),f(this,"credentialsInHeader"),f(this,"autoBatchTimerId"),f(this,"accessToken"),f(this,"accessTokenExpires"),f(this,"refreshToken"),f(this,"refreshPromise"),f(this,"profilePromise"),f(this,"sessionDetails"),f(this,"currentRateLimits"),f(this,"basicAuth"),f(this,"initPromise"),f(this,"initComplete",!0),f(this,"keyValueClient"),a?.baseUrl&&!a.baseUrl.startsWith("http"))throw Error("Base URL must start with http or https");this.options=a??{},this.fetch=a?.fetch??function(){if(!globalThis.fetch)throw Error("Fetch not available in this environment");return globalThis.fetch.bind(globalThis)}(),this.storage=a?.storage??new cj(void 0,a?.storagePrefix),this.createPdfImpl=a?.createPdf,this.baseUrl=aH(a?.baseUrl??"https://api.medplum.com/"),this.fhirBaseUrl=aI(this.baseUrl,a?.fhirUrlPath??"fhir/R4"),this.authorizeUrl=aI(this.baseUrl,a?.authorizeUrl??"oauth2/authorize"),this.tokenUrl=aI(this.baseUrl,a?.tokenUrl??"oauth2/token"),this.logoutUrl=aI(this.baseUrl,a?.logoutUrl??"oauth2/logout"),this.fhircastHubUrl=aI(this.baseUrl,a?.fhircastHubUrl??"fhircast/STU3"),this.clientId=a?.clientId??"",this.clientSecret=a?.clientSecret??"",this.credentialsInHeader=a?.authCredentialsMethod==="header",this.defaultHeaders=a?.defaultHeaders??{},this.onUnauthenticated=a?.onUnauthenticated,this.refreshGracePeriod=a?.refreshGracePeriod??3e5,this.cacheTime=a?.cacheTime??0,this.cacheTime>0?this.requestCache=new k(a?.resourceCacheSize??1e3):this.requestCache=void 0,a?.autoBatchTime?(this.autoBatchTime=a.autoBatchTime,this.autoBatchQueue=[]):(this.autoBatchTime=0,this.autoBatchQueue=void 0),a?.accessToken&&this.setAccessToken(a.accessToken),void 0===this.storage.getInitPromise?(a?.accessToken||this.attemptResumeActiveLogin().catch(console.error),this.initPromise=Promise.resolve(),this.dispatchEvent({type:"storageInitialized"})):(this.initComplete=!1,this.initPromise=this.storage.getInitPromise(),this.initPromise.then(()=>{a?.accessToken||this.attemptResumeActiveLogin().catch(console.error),this.initComplete=!0,this.dispatchEvent({type:"storageInitialized"})}).catch(a=>{console.error(a),this.initComplete=!0,this.dispatchEvent({type:"storageInitFailed",payload:{error:a}})})),this.setupStorageListener()}get isInitialized(){return this.initComplete}getInitPromise(){return this.initPromise}async attemptResumeActiveLogin(){let a=this.getActiveLogin();a&&(this.setAccessToken(a.accessToken,a.refreshToken),await this.refreshProfile())}getBaseUrl(){return this.baseUrl}getAuthorizeUrl(){return this.authorizeUrl}getTokenUrl(){return this.tokenUrl}getLogoutUrl(){return this.logoutUrl}getFhircastHubUrl(){return this.fhircastHubUrl}getDefaultHeaders(){return this.defaultHeaders}clear(){this.storage.clear(),this.clearActiveLogin()}clearActiveLogin(){this.storage.setString("activeLogin",void 0),this.requestCache?.clear(),this.accessToken=void 0,this.refreshToken=void 0,this.refreshPromise=void 0,this.accessTokenExpires=void 0,this.sessionDetails=void 0,this.medplumServer=void 0,this.dispatchEvent({type:"change"})}invalidateUrl(a){a=a.toString(),this.requestCache?.delete(a)}invalidateAll(){this.requestCache?.clear()}invalidateSearches(a){let b=aI(this.fhirBaseUrl,a);if(this.requestCache)for(let a of this.requestCache.keys())(a.endsWith(b)||a.includes(b+"?"))&&this.requestCache.delete(a)}get(a,b={}){a=a.toString();let c=this.getCacheEntry(a,b);if(c)return c.value;let d=new ci(a.startsWith(this.fhirBaseUrl)&&this.autoBatchQueue&&!b.disableAutoBatch?new Promise((c,d)=>{this.autoBatchQueue.push({method:"GET",url:a.replace(this.fhirBaseUrl,""),options:b,resolve:c,reject:d}),this.autoBatchTimerId||(this.autoBatchTimerId=setTimeout(()=>this.executeAutoBatch(),this.autoBatchTime))}):this.request("GET",a,b));return this.setCacheEntry(a,d),d}post(a,b,c,d={}){return a=a.toString(),this.setRequestBody(d,b),c&&this.setRequestContentType(d,c),this.invalidateUrl(a),this.request("POST",a,d)}put(a,b,c,d={}){return a=a.toString(),this.setRequestBody(d,b),c&&this.setRequestContentType(d,c),this.invalidateUrl(a),this.request("PUT",a,d)}patch(a,b,c={}){return a=a.toString(),this.setRequestBody(c,b),this.setRequestContentType(c,b4.JSON_PATCH),this.invalidateUrl(a),this.request("PATCH",a,c)}delete(a,b){return a=a.toString(),this.invalidateUrl(a),this.request("DELETE",a,b)}async startNewUser(a,b){let{codeChallengeMethod:c,codeChallenge:d}=await this.startPkce();return this.post("auth/newuser",{...a,clientId:a.clientId??this.clientId,codeChallengeMethod:c,codeChallenge:d},void 0,b)}async startNewProject(a,b){return this.post("auth/newproject",a,void 0,b)}async startNewPatient(a,b){return this.post("auth/newpatient",a,void 0,b)}async startLogin(a,b){return this.post("auth/login",{...await this.ensureCodeChallenge(a),clientId:a.clientId??this.clientId,scope:a.scope},void 0,b)}async startGoogleLogin(a,b){return this.post("auth/google",{...await this.ensureCodeChallenge(a),clientId:a.clientId??this.clientId,scope:a.scope},void 0,b)}async ensureCodeChallenge(a){return a.codeChallenge?a:{...a,...await this.startPkce()}}async signOut(){await this.post(this.logoutUrl,{}),this.clear()}async signInWithRedirect(a){let b=new URLSearchParams(b0.getSearch()).get("code");return b?this.processCode(b):void await this.requestAuthorization(a)}signOutWithRedirect(){b0.assign(this.logoutUrl)}async signInWithExternalAuth(a,b,c,d,e=!0){let f=d;e&&(f=await this.ensureCodeChallenge(d)),b0.assign(this.getExternalAuthRedirectUri(a,b,c,f,e))}async exchangeExternalAccessToken(a,b){if(!(b=b??this.clientId))throw Error("MedplumClient is missing clientId");return this.fetchTokens({grant_type:cw.TokenExchange,subject_token_type:cx.AccessToken,client_id:b,subject_token:a})}getExternalAuthRedirectUri(a,b,c,d,e=!0){let f=new URL(a);if(f.searchParams.set("response_type","code"),f.searchParams.set("client_id",b),f.searchParams.set("redirect_uri",c),f.searchParams.set("scope",d.scope??"openid profile email"),f.searchParams.set("state",JSON.stringify(d)),e){let{codeChallenge:a,codeChallengeMethod:b}=d;if(!b)throw Error("`LoginRequest` for external auth must include a `codeChallengeMethod`.");if(!a)throw Error("`LoginRequest` for external auth must include a `codeChallenge`.");f.searchParams.set("code_challenge_method",b),f.searchParams.set("code_challenge",a)}return f.toString()}fhirUrl(...a){return new URL(aI(this.fhirBaseUrl,a.join("/")))}fhirSearchUrl(a,b){var c;let d=this.fhirUrl(a);return b&&("object"!=typeof(c=b)||Array.isArray(c)||c instanceof URLSearchParams||(c=Object.fromEntries(Object.entries(c).filter(a=>void 0!==a[1]))),d.search=new URLSearchParams(c).toString()),d}search(a,b,c){let d=this.fhirSearchUrl(a,b),e="search-"+d.toString(),f=this.getCacheEntry(e,c);if(f)return f.value;let g=this.getBundle(d,c);return this.setCacheEntry(e,g),g}searchOne(a,b,c){let d=this.fhirSearchUrl(a,b);d.searchParams.set("_count","1"),d.searchParams.sort();let e="searchOne-"+d.toString(),f=this.getCacheEntry(e,c);if(f)return f.value;let g=new ci(this.search(a,d.searchParams,c).then(a=>a.entry?.[0]?.resource));return this.setCacheEntry(e,g),g}searchResources(a,b,c){let d="searchResources-"+this.fhirSearchUrl(a,b).toString(),e=this.getCacheEntry(d,c);if(e)return e.value;let f=new ci(this.search(a,b,c).then(cB));return this.setCacheEntry(d,f),f}async *searchResourcePages(a,b,c){let d=this.fhirSearchUrl(a,b);for(;d;){let b=new URL(d).searchParams;b.has("_count")||b.set("_count","1000");let e=await this.search(a,b,c),f=e.link?.find(a=>"next"===a.relation);if(!e.entry?.length&&!f)break;yield cB(e),d=f?.url?new URL(f.url):void 0}}valueSetExpand(a,b){let c=this.fhirUrl("ValueSet","$expand");return c.search=new URLSearchParams(a).toString(),this.get(c.toString(),b)}getCached(a,b){let c=this.requestCache?.get(this.fhirUrl(a,b).toString())?.value;return c?.isOk()?c.read():void 0}getCachedReference(a){let b=a.reference;if(!b)return;if("system"===b)return cv;let[c,d]=b.split("/");if(!(!c||!d))return this.getCached(c,d)}readResource(a,b,c){if(!b)throw Error('The "id" parameter cannot be null, undefined, or an empty string.');return this.get(this.fhirUrl(a,b),c)}readReference(a,b){let c=a.reference;if(!c)return new ci(Promise.reject(Error("Missing reference")));if("system"===c)return new ci(Promise.resolve(cv));let[d,e]=c.split("/");return d&&e?this.readResource(d,e,b):new ci(Promise.reject(Error("Invalid reference")))}requestSchema(a){if(B[a])return Promise.resolve();let b=a+"-requestSchema",c=this.getCacheEntry(b,void 0);if(c)return c.value;let d=new ci((async()=>{let b=`{
      StructureDefinitionList(_filter: "name eq ${a}") {
        resourceType,
        name,
        kind,
        description,
        type,
        url,
        snapshot {
          element {
            id,
            path,
            definition,
            min,
            max,
            base {
              path,
              min,
              max
            },
            contentReference,
            type {
              code,
              profile,
              targetProfile
            },
            binding {
              strength,
              valueSet
            }
          }
        }
      }
      SearchParameterList(base: "${a}", _count: 100) {
        base,
        code,
        type,
        expression,
        target
      }
    }`.replaceAll(/\s+/g," "),c=await this.graphql(b);for(let a of(G(c.data.StructureDefinitionList),c.data.SearchParameterList))for(let b of a.base??[]){let c=a$(b);c.searchParams||(c.searchParams={}),c.searchParams[a.code]=a}})());return this.setCacheEntry(b,d),d}requestProfileSchema(a,b){if(!b?.expandProfile&&K(a))return Promise.resolve();let c=a+"-requestSchema"+(b?.expandProfile?"-nested":""),d=this.getCacheEntry(c,void 0);if(d)return d.value;let e=new ci((async()=>{if(b?.expandProfile){let b=this.fhirUrl("StructureDefinition","$expand-profile");b.search=new URLSearchParams({url:a}).toString(),G(await this.post(b.toString(),{}))}else{let b=await this.searchOne("StructureDefinition",{url:a,_sort:"-_lastUpdated"});if(!b)return void console.warn(`No StructureDefinition found for ${a}!`);H(b)}})());return this.setCacheEntry(c,e),e}readHistory(a,b,c,d){let e=this.fhirUrl(a,b,"_history");return c?.count&&e.searchParams.set("_count",c.count.toString()),c?.offset&&e.searchParams.set("_offset",c.offset.toString()),this.get(e.toString(),d)}readVersion(a,b,c,d){return this.get(this.fhirUrl(a,b,"_history",c),d)}readPatientEverything(a,b){return this.getBundle(this.fhirUrl("Patient",a,"$everything"),b)}readPatientSummary(a,b){return this.getBundle(this.fhirUrl("Patient",a,"$summary"),b)}createResource(a,b){if(!a.resourceType)throw Error("Missing resourceType");return this.invalidateSearches(a.resourceType),this.post(this.fhirUrl(a.resourceType),a,void 0,b)}async createResourceIfNoneExist(a,b,c={}){let d=this.fhirUrl(a.resourceType);this.setRequestHeader(c,"If-None-Exist",b);let e=await this.post(d,a,void 0,c);return this.cacheResource(e),this.invalidateUrl(this.fhirUrl(a.resourceType,a.id,"_history")),this.invalidateSearches(a.resourceType),e}async upsertResource(a,b,c){let d=this.fhirSearchUrl(a.resourceType,b),e=await this.put(d,a,void 0,c);return e||(e=a),this.cacheResource(e),this.invalidateUrl(this.fhirUrl(a.resourceType,a.id,"_history")),this.invalidateSearches(a.resourceType),e}async createAttachment(a,b,c,d,e){let f=cC(a,b,c,d);if(f.contentType===b4.XML){let a=f.data,b;(b=a instanceof Blob?await new Promise((b,c)=>{let d=new FileReader;d.onload=()=>{if(!d.result)return void c(Error("Failed to load file"));b(d.result)},d.readAsText(a,"utf-8")}):ArrayBuffer.isView(a)?new TextDecoder().decode(a):a).includes("<ClinicalDocument")&&b.includes("urn:hl7-org:v3")&&(f={...f,contentType:b4.CDA_XML})}let g=e??("object"==typeof b?b:{}),h=await this.createBinary(f,g);return{contentType:f.contentType,url:h.url,title:f.filename}}createBinary(a,b,c,d,e){let f=cC(a,b,c,d),g=e??("object"==typeof b?b:{}),{data:h,contentType:i,filename:j,securityContext:k,onProgress:l}=f,m=this.fhirUrl("Binary");return j&&m.searchParams.set("_filename",j),k?.reference&&this.setRequestHeader(g,"X-Security-Context",k.reference),l?this.uploadwithProgress(m,h,i,l,g):this.post(m,h,i,g)}uploadwithProgress(a,b,c,d,e){return new Promise((f,g)=>{let h=new XMLHttpRequest,i=()=>h.abort();e?.signal?.addEventListener("abort",i);let j=a=>{e?.signal?.removeEventListener("abort",i),a instanceof Error?g(a):f(a)};if(h.responseType="json",h.onabort=()=>j(new DOMException("Request aborted","AbortError")),h.onerror=()=>j(Error("Request error")),d&&(h.upload.onprogress=a=>d(a),h.upload.onload=a=>d(a)),h.onload=()=>{h.status>=200&&h.status<300?j(h.response):j(new w(x(h.response||h.statusText)))},h.open("POST",a),h.withCredentials=!0,h.setRequestHeader("Authorization","Bearer "+this.accessToken),h.setRequestHeader("Cache-Control","no-cache, no-store, max-age=0"),h.setRequestHeader("Content-Type",c),!1!==this.options.extendedMode&&h.setRequestHeader("X-Medplum","extended"),e?.headers)for(let[a,b]of Object.entries(e.headers))h.setRequestHeader(a,b);h.send(b)})}async createPdf(a,b,c,d){if(!this.createPdfImpl)throw Error("PDF creation not enabled");let e=function(a,b,c,d){return ay(a)&&"docDefinition"in a?a:{docDefinition:a,filename:b,tableLayouts:c,fonts:d}}(a,b,c,d),f="object"==typeof b?b:{},{docDefinition:g,tableLayouts:h,fonts:i,...j}=e,k=await this.createPdfImpl(g,h,i),l={...j,data:k,contentType:"application/pdf"};return this.createBinary(l,f)}createComment(a,b,c){let d=this.getProfile(),e,f;return"Encounter"===a.resourceType&&(e=an(a),f=a.subject),"ServiceRequest"===a.resourceType&&(e=a.encounter,f=a.subject),"Patient"===a.resourceType&&(f=an(a)),this.createResource({resourceType:"Communication",status:"completed",basedOn:[an(a)],encounter:e,subject:f,sender:d?an(d):void 0,sent:new Date().toISOString(),payload:[{contentString:b}]},c)}async updateResource(a,b){if(!a.resourceType)throw Error("Missing resourceType");if(!a.id)throw Error("Missing id");let c=await this.put(this.fhirUrl(a.resourceType,a.id),a,void 0,b);return c||(c=a),this.cacheResource(c),this.invalidateUrl(this.fhirUrl(a.resourceType,a.id,"_history")),this.invalidateSearches(a.resourceType),c}async patchResource(a,b,c,d){let e=await this.patch(this.fhirUrl(a,b),c,d);return this.cacheResource(e),this.invalidateUrl(this.fhirUrl(a,b,"_history")),this.invalidateSearches(a),e}deleteResource(a,b,c){return this.deleteCacheEntry(this.fhirUrl(a,b).toString()),this.invalidateSearches(a),this.delete(this.fhirUrl(a,b),c)}validateResource(a,b){return this.post(this.fhirUrl(a.resourceType,"$validate"),a,void 0,b)}executeBot(a,b,c,d){let e;return"string"==typeof a?e=this.fhirUrl("Bot",a,"$execute"):(e=this.fhirUrl("Bot","$execute")).searchParams.set("identifier",a.system+"|"+a.value),this.post(e,b,c,d)}executeBatch(a,b){return this.post(this.fhirBaseUrl,a,void 0,b)}sendEmail(a,b){return this.post("email/v1/send",a,b4.JSON,b)}graphql(a,b,c,d){return this.post(this.fhirUrl("$graphql"),{query:a,operationName:b,variables:c},b4.JSON,d)}readResourceGraph(a,b,c,d){return this.get(`${this.fhirUrl(a,b)}/$graph?graph=${c}`,d)}pushToAgent(a,b,c,d,e,f){let{waitTimeout:g,...h}=f??{};return this.post(this.fhirUrl("Agent",ap(a),"$push"),{destination:"string"==typeof b?b:ao(b),body:c,contentType:d,waitForResponse:e,...void 0!==g?{waitTimeout:g}:void 0},b4.FHIR_JSON,h)}getActiveLogin(){return this.storage.getObject("activeLogin")}async setActiveLogin(a){this.sessionDetails?.profile&&ao(this.sessionDetails.profile)===a.profile?.reference||this.clearActiveLogin(),this.setAccessToken(a.accessToken,a.refreshToken),this.storage.setObject("activeLogin",a),this.addLogin(a),this.refreshPromise=void 0,await this.refreshProfile()}getAccessToken(){return this.accessToken}isAuthenticated(a){return void 0!==this.accessTokenExpires&&Date.now()<this.accessTokenExpires-(a??this.refreshGracePeriod)}setAccessToken(a,b){this.accessToken=a,this.refreshToken=b,this.accessTokenExpires=function(a){try{let b=cg(a).exp;return"number"==typeof b?1e3*b:void 0}catch{return}}(a),this.medplumServer=function(a){try{return"string"==typeof cg(a).login_id}catch{return!1}}(a)}getLogins(){return this.storage.getObject("logins")??[]}addLogin(a){let b=this.getLogins().filter(b=>b.profile?.reference!==a.profile?.reference);b.push(a),this.storage.setObject("logins",b)}async refreshProfile(){return this.medplumServer?(this.profilePromise=new Promise((a,b)=>{this.get("auth/me",{cache:"no-cache"}).then(b=>{this.profilePromise=void 0;let c=this.sessionDetails?.profile?.id!==b.profile.id;this.sessionDetails=b,c&&this.dispatchEvent({type:"change"}),a(b.profile),this.dispatchEvent({type:"profileRefreshed"})}).catch(b)}),this.dispatchEvent({type:"profileRefreshing"}),this.profilePromise):Promise.resolve(void 0)}isLoading(){return!this.isInitialized||!!this.profilePromise&&!this.sessionDetails?.profile}isSuperAdmin(){return!!this.sessionDetails?.project.superAdmin}isProjectAdmin(){return!!this.sessionDetails?.membership.admin}getProject(){return this.sessionDetails?.project}getProjectMembership(){return this.sessionDetails?.membership}getProfile(){return this.sessionDetails?.profile}async getProfileAsync(){return this.profilePromise?this.profilePromise:this.sessionDetails?this.sessionDetails.profile:this.refreshProfile()}getUserConfiguration(){return this.sessionDetails?.config}getAccessPolicy(){return this.sessionDetails?.accessPolicy}async download(a,b={}){this.refreshPromise&&await this.refreshPromise;let c=a.toString();c.startsWith("Binary/")&&(a=this.fhirUrl(c));let d=b.headers;return d||(b.headers=d={}),d.Accept||(d.Accept="*/*"),this.addFetchOptionsDefaults(b),(await this.fetchWithRetry(a.toString(),b)).blob()}async createMedia(a,b){let{additionalFields:c,...d}=a,e=await this.createResource({resourceType:"Media",status:"preparation",content:{contentType:a.contentType},...c});d.securityContext||(d.securityContext=an(e));let f=await this.createAttachment(d,b);return this.updateResource({...e,status:"completed",content:f})}async uploadMedia(a,b,c,d,e){return this.createMedia({data:a,contentType:b,filename:c,additionalFields:d},e)}async createDocumentReference(a,b){let{additionalFields:c,...d}=a,e=await this.createResource({resourceType:"DocumentReference",status:"current",content:[{attachment:{contentType:a.contentType}}],...c});d.securityContext||(d.securityContext=an(e));let f=await this.createAttachment(d,b);return this.updateResource({...e,content:[{attachment:f}]})}async bulkExport(a="",b,c,d){let e=a&&`${a}/`,f=this.fhirUrl(`${e}$export`);return b&&f.searchParams.set("_type",b),c&&f.searchParams.set("_since",c),this.startAsyncRequest(f.toString(),d)}async startAsyncRequest(a,b={}){return this.addFetchOptionsDefaults(b),b.headers.Prefer="respond-async",this.request("POST",a,b)}get keyValue(){return this.keyValueClient||(this.keyValueClient=new ch(this)),this.keyValueClient}getBundle(a,b){return new ci((async()=>{let c=await this.get(a,b);if(c.entry)for(let a of c.entry)this.cacheResource(a.resource);return c})())}getCacheEntry(a,b){if(!this.requestCache||b?.cache==="no-cache"||b?.cache==="reload")return;let c=this.requestCache.get(a);if(!(!c||c.requestTime+this.cacheTime<Date.now()))return c}setCacheEntry(a,b){this.requestCache&&this.requestCache.set(a,{requestTime:Date.now(),value:b})}cacheResource(a){a?.id&&!a.meta?.tag?.some(a=>"SUBSETTED"===a.code)&&this.setCacheEntry(this.fhirUrl(a.resourceType,a.id).toString(),new ci(Promise.resolve(a)))}deleteCacheEntry(a){this.requestCache&&this.requestCache.delete(a)}async request(a,b,c={},d={}){await this.refreshIfExpired(),c.method=a,this.addFetchOptionsDefaults(c);let e=await this.fetchWithRetry(b,c);if(401===e.status)return this.handleUnauthenticated(a,b,c);if(204===e.status||304===e.status)return;let f=e.headers.get("content-type")?.includes("json");if(404===e.status&&!f)throw new w(o);let g=await this.parseBody(e,f);if(200===e.status&&c.followRedirectOnOk||201===e.status&&c.followRedirectOnCreated){let a=await cA(e,g);if(a)return this.request("GET",a,{...c,body:void 0})}if(202===e.status&&c.pollStatusOnAccepted){let a=await cA(e,g)??d.statusUrl;if(a)return this.pollStatus(a,c,d)}if(e.status>=400)throw new w(x(g));return g}async parseBody(a,b){let c;if("0"!==a.headers.get("content-length")){if(b)try{c=await a.json()}catch(b){throw console.error("Error parsing response",a.status,b),b}else c=await a.text();return c}}async fetchWithRetry(a,b){a.startsWith("http")||(a=aI(this.baseUrl,a));let c=b?.maxRetries??2;for(let e=0;e<=c;e++)try{var d;this.options.verbose&&this.logRequest(a,b);let f=await this.fetch(a,b);if(this.options.verbose&&this.logResponse(f),this.setCurrentRateLimit(f),e>=c||(d=f,429!==d.status&&!(d.status>=500)))return f;let g=this.getRetryDelay(e),h=b.maxRetryTime??2e3;if(g>h)return f;await aE(g)}catch(a){if("Failed to fetch"===a.message&&0===e&&this.dispatchEvent({type:"offline"}),"AbortError"===a.name||e===c)throw a}throw Error("Unreachable")}logRequest(a,b){if(console.log(`> ${b.method} ${a}`),b.headers){let a=b.headers;for(let b of Object.keys(a).sort((a,b)=>a.localeCompare(b)))console.log(`> ${b}: ${a[b]}`)}}logResponse(a){console.log(`< ${a.status} ${a.statusText}`),a.headers&&a.headers.forEach((a,b)=>console.log(`< ${b}: ${a}`))}setCurrentRateLimit(a){if(!a?.headers||"function"!=typeof a.headers.get)return;let b=a.headers.get("ratelimit");b&&(this.currentRateLimits=b)}rateLimitStatus(){if(!this.currentRateLimits)return[];let a=this.currentRateLimits;return a.split(/\s*;\s*/g).map(b=>{let c=b.split(/\s*,\s*/g);if(3!==c.length)throw Error("Could not parse RateLimit header: "+a);let d=c[0].substring(1,c[0].length-1),e=c.find(a=>a.startsWith("r=")),f=e?Number.parseInt(e.substring(2),10):NaN,g=c.find(a=>a.startsWith("t=")),h=g?Number.parseInt(g.substring(2),10):NaN;if(!d||Number.isNaN(f)||Number.isNaN(h))throw Error("Could not parse RateLimit header: "+a);return{name:d,remainingUnits:f,secondsUntilReset:h}})}getRetryDelay(a){let b=this.rateLimitStatus(),c=500*Math.pow(1.5,a);for(let a of b)a.remainingUnits||(c=Math.max(c,1e3*a.secondsUntilReset));return c}async pollStatus(a,b,c){let d={...b,method:"GET",body:void 0,redirect:"follow"};if(void 0===c.pollCount)b.headers&&"object"==typeof b.headers&&"Prefer"in b.headers&&(d.headers={...b.headers},delete d.headers.Prefer),c.statusUrl=a,c.pollCount=1;else{let a=b.pollStatusPeriod??1e3;await aE(a),c.pollCount++}return this.request("GET",a,d,c)}async executeAutoBatch(){if(void 0===this.autoBatchQueue)return;let a=[...this.autoBatchQueue];if(this.autoBatchQueue.length=0,this.autoBatchTimerId=void 0,1===a.length){let b=a[0];try{b.resolve(await this.request(b.method,aI(this.fhirBaseUrl,b.url),b.options))}catch(a){b.reject(new w(x(a)))}return}let b={resourceType:"Bundle",type:"batch",entry:a.map(a=>({request:{method:a.method,url:a.url},resource:a.options.body?JSON.parse(a.options.body):void 0}))},c=await this.post(this.fhirBaseUrl,b);for(let b=0;b<a.length;b++){let d=a[b],e=c.entry?.[b];e?.response?.outcome&&!v(e.response.outcome)?d.reject(new w(e.response.outcome)):d.resolve(e?.resource)}}addFetchOptionsDefaults(a){Object.entries(this.defaultHeaders).forEach(([b,c])=>{this.setRequestHeader(a,b,c)}),this.setRequestHeader(a,"Accept",cu,!0),!1!==this.options.extendedMode&&this.setRequestHeader(a,"X-Medplum","extended"),a.body&&this.setRequestHeader(a,"Content-Type",b4.FHIR_JSON,!0),this.accessToken?this.setRequestHeader(a,"Authorization","Bearer "+this.accessToken):this.basicAuth&&this.setRequestHeader(a,"Authorization","Basic "+this.basicAuth),a.cache||(a.cache="no-cache"),a.credentials||(a.credentials="include")}setRequestContentType(a,b){this.setRequestHeader(a,"Content-Type",b)}setRequestHeader(a,b,c,d=!1){let e=a.headers;e?Array.isArray(e)?d&&e.some(([a])=>a.toLowerCase()===b.toLowerCase())||e.push([b,c]):e instanceof Headers?d&&e.has(b)||e.set(b,c):!ay(e)||d&&e[b]||(e[b]=c):a.headers={[b]:c}}setRequestBody(a,b){"string"==typeof b||"u">typeof Blob&&(b instanceof Blob||b?.constructor.name==="Blob")||"u">typeof File&&(b instanceof File||b?.constructor.name==="File")||"u">typeof Uint8Array&&(b instanceof Uint8Array||b?.constructor.name==="Uint8Array")?a.body=b:b&&(a.body=JSON.stringify(b))}handleUnauthenticated(a,b,c){return this.refresh()?this.request(a,b,c):(this.clear(),this.onUnauthenticated&&this.onUnauthenticated(),Promise.reject(new w(p)))}async startPkce(){let a=b2();sessionStorage.setItem("pkceState",a);let b=b2().slice(0,128);sessionStorage.setItem("codeVerifier",b);try{let a=await b3(b);return{codeChallengeMethod:"S256",codeChallenge:(function(a){let b=new Uint8Array(aC(a)),c=Array(b.length);for(let a=0;a<b.length;a++)c[a]=String.fromCharCode(b[a]);return window.btoa(c.join(""))})(a).replaceAll("+","-").replaceAll("/","_").replaceAll("=","")}}catch(a){return console.warn("Failed to hash code verifier. Falling back to 'plain' code challenge method",a),{codeChallengeMethod:"plain",codeChallenge:b}}}async requestAuthorization(a){let b=await this.ensureCodeChallenge(a??{}),c=new URL(this.authorizeUrl);c.searchParams.set("response_type","code"),c.searchParams.set("state",sessionStorage.getItem("pkceState")),c.searchParams.set("client_id",b.clientId??this.clientId),c.searchParams.set("redirect_uri",b.redirectUri??b0.getOrigin()),c.searchParams.set("code_challenge_method",b.codeChallengeMethod),c.searchParams.set("code_challenge",b.codeChallenge),c.searchParams.set("scope",b.scope??"openid profile"),b0.assign(c.toString())}processCode(a,b){let c={grant_type:cw.AuthorizationCode,code:a,client_id:b?.clientId??this.clientId??"",redirect_uri:b?.redirectUri??b0.getOrigin()};if("u">typeof sessionStorage){let a=sessionStorage.getItem("codeVerifier");a&&(c.code_verifier=a)}return this.fetchTokens(c)}refreshIfExpired(a){return this.refreshPromise||void 0===this.accessTokenExpires||this.isAuthenticated(a)||this.refresh(),this.refreshPromise??Promise.resolve()}refresh(){return this.refreshPromise?this.refreshPromise:this.refreshToken?(this.refreshPromise=this.fetchTokens({grant_type:cw.RefreshToken,client_id:this.clientId??"",refresh_token:this.refreshToken}),this.refreshPromise):this.clientId&&this.clientSecret?(this.refreshPromise=this.startClientLogin(this.clientId,this.clientSecret),this.refreshPromise):void 0}async startClientLogin(a,b){return this.clientId=a,this.clientSecret=b,this.fetchTokens({grant_type:cw.ClientCredentials,client_id:a,client_secret:b})}async startJwtBearerLogin(a,b,c){return this.clientId=a,this.fetchTokens({grant_type:cw.JwtBearer,client_id:a,assertion:b,scope:c})}async startJwtAssertionLogin(a){return this.fetchTokens({grant_type:cw.ClientCredentials,client_assertion_type:cy.JwtBearer,client_assertion:a})}setBasicAuth(a,b){this.clientId=a,this.clientSecret=b,this.basicAuth=b1(a+":"+b)}setVerbose(a){this.options.verbose=a}async fhircastSubscribe(a,b){if("string"!=typeof a||""===a)throw new w(t("Invalid topic provided. Topic must be a valid string."));if(!("object"==typeof b&&Array.isArray(b)&&b.length>0))throw new w(t("Invalid events provided. Events must be an array of event names containing at least one event."));let c={channelType:"websocket",mode:"subscribe",topic:a,events:b},d=(await this.post(this.fhircastHubUrl,cc(c),b4.FORM_URL_ENCODED))["hub.channel.endpoint"];if(!d)throw Error("Invalid response!");return c.endpoint=d,c}async fhircastUnsubscribe(a){if(!cd(a))throw new w(t("Invalid topic or subscriptionRequest. SubscriptionRequest must be an object."));if(!(a.endpoint&&"string"==typeof a.endpoint&&a.endpoint.startsWith("ws")))throw new w(t("Provided subscription request must have an endpoint in order to unsubscribe."));a.mode="unsubscribe",await this.post(this.fhircastHubUrl,cc(a),b4.FORM_URL_ENCODED)}fhircastConnect(a){return new cf(a)}async fhircastPublish(a,b,c,d){return b9.includes(b)?this.post(this.fhircastHubUrl,ce(a,b,c,d),b4.JSON):(function(a){if(b9.includes(a))throw new w(t(`'context.version' is required for '${a}'.`))}(b),this.post(this.fhircastHubUrl,ce(a,b,c),b4.JSON))}async fhircastGetContext(a){return this.get(`${this.fhircastHubUrl}/${a}`,{cache:"no-cache"})}async invite(a,b){return this.post("admin/projects/"+a+"/invite",b)}async fetchTokens(a){let b=new URLSearchParams(a),c={...this.defaultHeaders,"Content-Type":b4.FORM_URL_ENCODED};this.basicAuth&&(c.Authorization=`Basic ${this.basicAuth}`),this.credentialsInHeader&&(b.delete("client_id"),b.delete("client_secret"),!this.basicAuth&&a.client_id&&a.client_secret&&(c.Authorization=`Basic ${b1(a.client_id+":"+a.client_secret)}`));let d={method:"POST",headers:c,body:b.toString(),credentials:"include"},e;try{e=await this.fetchWithRetry(this.tokenUrl,d)}catch(a){throw this.refreshPromise=void 0,a}if(!e.ok){this.clearActiveLogin();try{let a=await e.json();throw new w(s(a.error_description))}catch(a){throw new w(s("Failed to fetch tokens"),{cause:a})}}let f=await e.json();return await this.verifyTokens(f),this.getProfile()}async verifyTokens(a){let b=a.access_token;if(3===b.split(".").length){let a=cg(b);if(Date.now()>=1e3*a.exp)throw this.clearActiveLogin(),new w(q);if(a.cid){if(a.cid!==this.clientId)throw this.clearActiveLogin(),new w(r)}else if(this.clientId&&a.client_id!==this.clientId)throw this.clearActiveLogin(),new w(r)}return this.setActiveLogin({accessToken:b,refreshToken:a.refresh_token,project:a.project,profile:a.profile})}checkSessionDetailsMatchLogin(a){return!this.sessionDetails||!a||(a.profile?.reference?.endsWith(this.sessionDetails.profile.id)??!1)}setupStorageListener(){try{window.addEventListener("storage",a=>{if(null===a.key)b0.reload();else if(a.key===this.storage.makeKey("activeLogin")){let b=a.oldValue?JSON.parse(a.oldValue):void 0,c=a.newValue?JSON.parse(a.newValue):void 0;b?.profile.reference===c?.profile.reference&&this.checkSessionDetailsMatchLogin(c)?c?this.setAccessToken(c.accessToken,c.refreshToken):this.clear():b0.reload()}})}catch{}}getSubscriptionManager(){return this.subscriptionManager||(this.subscriptionManager=new ct(this,aI(this.baseUrl,"/ws/subscriptions-r4").toString().replace("http://","ws://").replace("https://","wss://"))),this.subscriptionManager}subscribeToCriteria(a,b){return this.getSubscriptionManager().addCriteria(a,b)}unsubscribeFromCriteria(a,b){this.subscriptionManager&&(this.subscriptionManager.removeCriteria(a,b),0===this.subscriptionManager.getCriteriaCount()&&this.subscriptionManager.closeWebSocket())}getMasterSubscriptionEmitter(){return this.getSubscriptionManager().getMasterEmitter()}};async function cA(a,b){let c=a.headers.get("content-location");if(c)return c;let d=a.headers.get("location");return d||(u(b)&&b.issue?.[0]?.diagnostics?b.issue[0].diagnostics:void 0)}function cB(a){return Object.assign(a.entry?.map(a=>a.resource)??[],{bundle:a})}function cC(a,b,c,d){return ay(a)&&"data"in a&&"contentType"in a?a:{data:a,filename:b,contentType:c,onProgress:d}}function cD({parentContext:a,path:b,elements:c,profileUrl:d,debugMode:e,accessPolicyResource:f}){let g;if(b===a?.path)return;e??=a?.debugMode??!1,f??=a?.accessPolicyResource;let h=function(a,b,c,d){let e=Object.create(null);if(c)for(let[b,d]of Object.entries(c.elementsByPath)){let c=function(a,b){let c=a+".";if(b.startsWith(c))return b.slice(c.length)}(a,b);void 0!==c&&(e[c]=d)}let f=!1;if(b)for(let[a,c]of Object.entries(b))a in e||(e[a]=c,f=!0);return d&&console.assert(f,"Unnecessary ElementsContext; not using any newly provided elements"),e}(b,c,a,!!e),i=aF(b,".",2)[1];h=function(a,b,c){if(!b?.readonlyFields?.length)return a;let d=Object.create(null),e=c?c+".":"";for(let[c,f]of Object.entries(a))cE(e+c,b.readonlyFields)?d[c]={...f,readonly:!0}:d[c]=f;return d}(h=function(a,b,c){if(!b?.hiddenFields?.length)return a;let d=c?c+".":"";return Object.fromEntries(Object.entries(a).filter(([a])=>!cE(d+a,b.hiddenFields)))}(h,f,i),f,i);let j=Object.create(null);for(let[a,c]of Object.entries(h))j[b+"."+a]=c;if(a&&!a.isDefaultContext)g=a.getExtendedProps;else{let a=Object.create(null);g=b=>{let c=aF(b,".",2)[1];if(c){if(!a[c]){let b=cE(c,f?.hiddenFields);a[c]={hidden:b,readonly:b||cE(c,f?.readonlyFields)}}return a[c]}}}return{path:b,elements:h,elementsByPath:j,profileUrl:d??a?.profileUrl,debugMode:e,getExtendedProps:g,accessPolicyResource:f}}function cE(a,b){if(!b?.length)return!1;let c=a.split(".");for(let a=1;a<=c.length;a++){let d=c.slice(0,a).join(".");if(b.includes(d))return!0}return!1}function cF(a){return void 0!==a.type&&a.type.length>0}function cG(a,b,c,d){if(a)for(let e of b){let b={value:a,type:e.typeSchema?.type??e.type?.[0].code};if(c.every(a=>(function(a,b,c,d){let e=function(a,b,c){if(void 0===a)return[void 0];if("$this"===b)return[a];let d=c?.withPath?R:X,[e,...f]=b.split("."),g=[d(a,e,c)];for(let a of f){let b=[];for(let e of g)if(Array.isArray(e))for(let f of e)b.push(d(f,a,c));else(c?.withPath&&e?.value!==void 0||!c?.withPath&&void 0!==e)&&b.push(d(e,a,c));g=b}return g}(a,b.path,{profileUrl:d});if(e){let a=c.typeSchema?.elements??c.elements;return e.some(d=>(function(a,b,c,d){let e;if(Array.isArray(a))return!1;e="$this"===b.path?c:(d??c.elements)[b.path];let f=c.type;switch(b.type){case"value":case"pattern":if(!a||!e)break;if(e.pattern)return function a(b,c){var d,e;return!!av(b)||!av(c)&&(Array.isArray(b)&&Array.isArray(c)?(d=b,c.every(b=>d.some(c=>a(c,b)))):!(Array.isArray(b)||Array.isArray(c))&&(ay(b)&&ay(c)?(e=b,Object.entries(c).every(([b,c])=>b in e&&a(e[b],c))):!(ay(b)||ay(c))&&b===c))}(a,e.pattern);if(e.fixed)return ax(a,e.fixed);if(e.binding?.strength==="required"&&e.binding.valueSet)return!0;break;case"type":return!!a&&!!f?.length&&f.some(b=>b.code===a.type)}return!1})(d,b,c,a))??!1}return console.assert(!1,"getNestedProperty[%s] in isDiscriminatorComponentMatch missed",b.path),!1})(b,a,e,e.typeSchema?.url??d)))return e.name}}[...bF],bK().registerInfix("->",{precedence:bG.Arrow}).registerInfix(";",{precedence:bG.Semicolon})," ".repeat(2),[...bF],bO.EXACT,bO.NOT_EQUALS,bO.CONTAINS,bO.STARTS_WITH,bO.GREATER_THAN,bO.LESS_THAN,bO.GREATER_THAN_OR_EQUALS,bO.LESS_THAN_OR_EQUALS,bO.APPROXIMATELY,bO.STARTS_AFTER,bO.ENDS_BEFORE,bO.PRESENT,bO.IN,bO.NOT_IN,bO.EQUALS,bO.IDENTIFIER,bK()},51042:(a,b,c)=>{Promise.resolve().then(c.bind(c,57861)),Promise.resolve().then(c.bind(c,54670)),Promise.resolve().then(c.bind(c,39281)),Promise.resolve().then(c.bind(c,4466)),Promise.resolve().then(c.bind(c,25942)),Promise.resolve().then(c.bind(c,29726)),Promise.resolve().then(c.bind(c,77064)),Promise.resolve().then(c.bind(c,20201)),Promise.resolve().then(c.bind(c,86993)),Promise.resolve().then(c.bind(c,78081)),Promise.resolve().then(c.bind(c,72297)),Promise.resolve().then(c.bind(c,44113)),Promise.resolve().then(c.bind(c,27525)),Promise.resolve().then(c.bind(c,18613)),Promise.resolve().then(c.bind(c,94105)),Promise.resolve().then(c.bind(c,13413)),Promise.resolve().then(c.bind(c,74935)),Promise.resolve().then(c.bind(c,13855)),Promise.resolve().then(c.bind(c,33647)),Promise.resolve().then(c.bind(c,29509)),Promise.resolve().then(c.bind(c,11209)),Promise.resolve().then(c.bind(c,43305)),Promise.resolve().then(c.bind(c,49655)),Promise.resolve().then(c.bind(c,93437)),Promise.resolve().then(c.bind(c,68183)),Promise.resolve().then(c.bind(c,60953)),Promise.resolve().then(c.bind(c,42153)),Promise.resolve().then(c.bind(c,95289)),Promise.resolve().then(c.bind(c,18977)),Promise.resolve().then(c.bind(c,87981)),Promise.resolve().then(c.bind(c,56771)),Promise.resolve().then(c.bind(c,70684)),Promise.resolve().then(c.bind(c,14242)),Promise.resolve().then(c.bind(c,46611)),Promise.resolve().then(c.bind(c,13926)),Promise.resolve().then(c.bind(c,68209)),Promise.resolve().then(c.bind(c,59745)),Promise.resolve().then(c.bind(c,53700)),Promise.resolve().then(c.bind(c,53347)),Promise.resolve().then(c.bind(c,21629)),Promise.resolve().then(c.bind(c,53279)),Promise.resolve().then(c.bind(c,43623)),Promise.resolve().then(c.bind(c,37897)),Promise.resolve().then(c.bind(c,91571)),Promise.resolve().then(c.bind(c,9934)),Promise.resolve().then(c.bind(c,96589)),Promise.resolve().then(c.bind(c,81010)),Promise.resolve().then(c.bind(c,37317)),Promise.resolve().then(c.bind(c,29825)),Promise.resolve().then(c.bind(c,96417)),Promise.resolve().then(c.bind(c,26987)),Promise.resolve().then(c.bind(c,78077)),Promise.resolve().then(c.bind(c,15635)),Promise.resolve().then(c.bind(c,1376)),Promise.resolve().then(c.bind(c,78467)),Promise.resolve().then(c.bind(c,85897)),Promise.resolve().then(c.bind(c,67649)),Promise.resolve().then(c.bind(c,31813)),Promise.resolve().then(c.bind(c,61517)),Promise.resolve().then(c.bind(c,1343)),Promise.resolve().then(c.bind(c,42949)),Promise.resolve().then(c.bind(c,62281)),Promise.resolve().then(c.bind(c,10805)),Promise.resolve().then(c.bind(c,42291)),Promise.resolve().then(c.bind(c,58865)),Promise.resolve().then(c.bind(c,8039)),Promise.resolve().then(c.bind(c,21085)),Promise.resolve().then(c.bind(c,64799)),Promise.resolve().then(c.bind(c,11429)),Promise.resolve().then(c.bind(c,51445)),Promise.resolve().then(c.bind(c,12159)),Promise.resolve().then(c.bind(c,54155)),Promise.resolve().then(c.bind(c,87437)),Promise.resolve().then(c.bind(c,80069)),Promise.resolve().then(c.bind(c,14607)),Promise.resolve().then(c.bind(c,80437)),Promise.resolve().then(c.bind(c,16009)),Promise.resolve().then(c.bind(c,66861)),Promise.resolve().then(c.bind(c,78233)),Promise.resolve().then(c.bind(c,92809)),Promise.resolve().then(c.bind(c,20857)),Promise.resolve().then(c.bind(c,66391)),Promise.resolve().then(c.bind(c,94057)),Promise.resolve().then(c.bind(c,82633)),Promise.resolve().then(c.bind(c,83225)),Promise.resolve().then(c.bind(c,26723)),Promise.resolve().then(c.bind(c,58320)),Promise.resolve().then(c.bind(c,7626)),Promise.resolve().then(c.bind(c,2955)),Promise.resolve().then(c.bind(c,7881)),Promise.resolve().then(c.bind(c,60151)),Promise.resolve().then(c.bind(c,55053)),Promise.resolve().then(c.bind(c,59247)),Promise.resolve().then(c.bind(c,58471)),Promise.resolve().then(c.bind(c,58817)),Promise.resolve().then(c.bind(c,6764)),Promise.resolve().then(c.bind(c,30457)),Promise.resolve().then(c.bind(c,81737)),Promise.resolve().then(c.bind(c,28617)),Promise.resolve().then(c.bind(c,62823)),Promise.resolve().then(c.bind(c,79008)),Promise.resolve().then(c.bind(c,10913)),Promise.resolve().then(c.bind(c,95241)),Promise.resolve().then(c.bind(c,64857)),Promise.resolve().then(c.bind(c,85348)),Promise.resolve().then(c.bind(c,45768)),Promise.resolve().then(c.bind(c,1400)),Promise.resolve().then(c.bind(c,93973)),Promise.resolve().then(c.bind(c,89417)),Promise.resolve().then(c.bind(c,91417)),Promise.resolve().then(c.bind(c,57232)),Promise.resolve().then(c.bind(c,55474)),Promise.resolve().then(c.bind(c,53794)),Promise.resolve().then(c.bind(c,26986)),Promise.resolve().then(c.bind(c,85984)),Promise.resolve().then(c.bind(c,29533)),Promise.resolve().then(c.bind(c,58908)),Promise.resolve().then(c.bind(c,75862)),Promise.resolve().then(c.bind(c,76245)),Promise.resolve().then(c.bind(c,73401)),Promise.resolve().then(c.bind(c,71777)),Promise.resolve().then(c.bind(c,85167)),Promise.resolve().then(c.bind(c,44064)),Promise.resolve().then(c.bind(c,79761)),Promise.resolve().then(c.bind(c,54983)),Promise.resolve().then(c.bind(c,72821)),Promise.resolve().then(c.bind(c,89969)),Promise.resolve().then(c.bind(c,51633)),Promise.resolve().then(c.bind(c,80251)),Promise.resolve().then(c.bind(c,66371)),Promise.resolve().then(c.bind(c,98013)),Promise.resolve().then(c.bind(c,83005)),Promise.resolve().then(c.bind(c,7073)),Promise.resolve().then(c.bind(c,4825)),Promise.resolve().then(c.bind(c,58717)),Promise.resolve().then(c.bind(c,2395)),Promise.resolve().then(c.bind(c,37421)),Promise.resolve().then(c.bind(c,9917)),Promise.resolve().then(c.bind(c,81759)),Promise.resolve().then(c.bind(c,63228)),Promise.resolve().then(c.bind(c,23542)),Promise.resolve().then(c.bind(c,38935)),Promise.resolve().then(c.bind(c,78501)),Promise.resolve().then(c.bind(c,95275)),Promise.resolve().then(c.bind(c,4009)),Promise.resolve().then(c.bind(c,35805)),Promise.resolve().then(c.bind(c,17033)),Promise.resolve().then(c.bind(c,33145)),Promise.resolve().then(c.bind(c,11363)),Promise.resolve().then(c.bind(c,65904)),Promise.resolve().then(c.bind(c,93738)),Promise.resolve().then(c.bind(c,76427)),Promise.resolve().then(c.bind(c,11117)),Promise.resolve().then(c.bind(c,19926)),Promise.resolve().then(c.bind(c,96201)),Promise.resolve().then(c.bind(c,33041)),Promise.resolve().then(c.bind(c,313)),Promise.resolve().then(c.bind(c,56329)),Promise.resolve().then(c.bind(c,83685)),Promise.resolve().then(c.bind(c,20657)),Promise.resolve().then(c.bind(c,11181)),Promise.resolve().then(c.bind(c,96055)),Promise.resolve().then(c.bind(c,360)),Promise.resolve().then(c.bind(c,15578)),Promise.resolve().then(c.bind(c,96500)),Promise.resolve().then(c.bind(c,32692)),Promise.resolve().then(c.bind(c,54046)),Promise.resolve().then(c.bind(c,77157)),Promise.resolve().then(c.bind(c,48041)),Promise.resolve().then(c.bind(c,23617)),Promise.resolve().then(c.bind(c,92277)),Promise.resolve().then(c.bind(c,56843)),Promise.resolve().then(c.bind(c,16844)),Promise.resolve().then(c.bind(c,86813)),Promise.resolve().then(c.bind(c,91033)),Promise.resolve().then(c.bind(c,90339)),Promise.resolve().then(c.bind(c,59395)),Promise.resolve().then(c.bind(c,43011)),Promise.resolve().then(c.bind(c,42319)),Promise.resolve().then(c.bind(c,49737)),Promise.resolve().then(c.bind(c,94341)),Promise.resolve().then(c.bind(c,91165)),Promise.resolve().then(c.bind(c,59841)),Promise.resolve().then(c.bind(c,82761)),Promise.resolve().then(c.bind(c,11634)),Promise.resolve().then(c.bind(c,23529)),Promise.resolve().then(c.bind(c,25483)),Promise.resolve().then(c.bind(c,75930)),Promise.resolve().then(c.bind(c,37515)),Promise.resolve().then(c.bind(c,76041)),Promise.resolve().then(c.bind(c,761)),Promise.resolve().then(c.bind(c,11579)),Promise.resolve().then(c.bind(c,43669)),Promise.resolve().then(c.bind(c,80195)),Promise.resolve().then(c.bind(c,54397)),Promise.resolve().then(c.bind(c,90255)),Promise.resolve().then(c.bind(c,65305)),Promise.resolve().then(c.bind(c,33047)),Promise.resolve().then(c.bind(c,33743)),Promise.resolve().then(c.bind(c,95369)),Promise.resolve().then(c.bind(c,78445)),Promise.resolve().then(c.bind(c,8521)),Promise.resolve().then(c.bind(c,51913)),Promise.resolve().then(c.bind(c,95297)),Promise.resolve().then(c.bind(c,59299)),Promise.resolve().then(c.bind(c,97459)),Promise.resolve().then(c.bind(c,6012)),Promise.resolve().then(c.bind(c,35453)),Promise.resolve().then(c.bind(c,10941)),Promise.resolve().then(c.bind(c,41991)),Promise.resolve().then(c.bind(c,25417)),Promise.resolve().then(c.bind(c,40471)),Promise.resolve().then(c.bind(c,9806)),Promise.resolve().then(c.bind(c,80696)),Promise.resolve().then(c.bind(c,19384)),Promise.resolve().then(c.bind(c,28585)),Promise.resolve().then(c.bind(c,16873)),Promise.resolve().then(c.bind(c,53671)),Promise.resolve().then(c.bind(c,48101)),Promise.resolve().then(c.bind(c,19193)),Promise.resolve().then(c.bind(c,17801)),Promise.resolve().then(c.bind(c,52535)),Promise.resolve().then(c.bind(c,97597)),Promise.resolve().then(c.bind(c,27145)),Promise.resolve().then(c.bind(c,76537)),Promise.resolve().then(c.bind(c,10511)),Promise.resolve().then(c.bind(c,33881)),Promise.resolve().then(c.bind(c,30473)),Promise.resolve().then(c.bind(c,16912)),Promise.resolve().then(c.bind(c,62611)),Promise.resolve().then(c.bind(c,33333)),Promise.resolve().then(c.bind(c,42302)),Promise.resolve().then(c.bind(c,83729)),Promise.resolve().then(c.bind(c,79)),Promise.resolve().then(c.bind(c,6761)),Promise.resolve().then(c.bind(c,94240)),Promise.resolve().then(c.bind(c,81936)),Promise.resolve().then(c.bind(c,35121)),Promise.resolve().then(c.bind(c,59625)),Promise.resolve().then(c.bind(c,335)),Promise.resolve().then(c.bind(c,71006)),Promise.resolve().then(c.bind(c,74680)),Promise.resolve().then(c.bind(c,97792)),Promise.resolve().then(c.bind(c,56503)),Promise.resolve().then(c.bind(c,14724)),Promise.resolve().then(c.bind(c,13592)),Promise.resolve().then(c.bind(c,56352)),Promise.resolve().then(c.bind(c,47280)),Promise.resolve().then(c.bind(c,47380)),Promise.resolve().then(c.bind(c,87900)),Promise.resolve().then(c.bind(c,32376)),Promise.resolve().then(c.bind(c,21276)),Promise.resolve().then(c.bind(c,11056)),Promise.resolve().then(c.bind(c,63197)),Promise.resolve().then(c.bind(c,11719)),Promise.resolve().then(c.bind(c,94072)),Promise.resolve().then(c.bind(c,62904)),Promise.resolve().then(c.bind(c,93244)),Promise.resolve().then(c.bind(c,32158)),Promise.resolve().then(c.bind(c,38674)),Promise.resolve().then(c.bind(c,98348)),Promise.resolve().then(c.bind(c,34384)),Promise.resolve().then(c.bind(c,27434)),Promise.resolve().then(c.bind(c,78736)),Promise.resolve().then(c.bind(c,45883)),Promise.resolve().then(c.bind(c,92418)),Promise.resolve().then(c.bind(c,39641)),Promise.resolve().then(c.bind(c,30968)),Promise.resolve().then(c.bind(c,31448)),Promise.resolve().then(c.bind(c,48376)),Promise.resolve().then(c.bind(c,41706)),Promise.resolve().then(c.bind(c,76983)),Promise.resolve().then(c.bind(c,82781)),Promise.resolve().then(c.bind(c,16944)),Promise.resolve().then(c.bind(c,50416)),Promise.resolve().then(c.bind(c,66458)),Promise.resolve().then(c.bind(c,50690)),Promise.resolve().then(c.bind(c,50080)),Promise.resolve().then(c.bind(c,15042)),Promise.resolve().then(c.bind(c,69158)),Promise.resolve().then(c.bind(c,18758)),Promise.resolve().then(c.bind(c,50312)),Promise.resolve().then(c.bind(c,61186)),Promise.resolve().then(c.bind(c,50150)),Promise.resolve().then(c.bind(c,2838)),Promise.resolve().then(c.bind(c,1952)),Promise.resolve().then(c.bind(c,47860)),Promise.resolve().then(c.bind(c,49650)),Promise.resolve().then(c.bind(c,28258)),Promise.resolve().then(c.bind(c,34994)),Promise.resolve().then(c.bind(c,17452)),Promise.resolve().then(c.bind(c,95518)),Promise.resolve().then(c.bind(c,84472)),Promise.resolve().then(c.bind(c,7214)),Promise.resolve().then(c.bind(c,45002)),Promise.resolve().then(c.bind(c,81968)),Promise.resolve().then(c.bind(c,79728)),Promise.resolve().then(c.bind(c,30498)),Promise.resolve().then(c.bind(c,81504)),Promise.resolve().then(c.bind(c,6962)),Promise.resolve().then(c.bind(c,55417)),Promise.resolve().then(c.bind(c,92137)),Promise.resolve().then(c.bind(c,8385)),Promise.resolve().then(c.bind(c,24545)),Promise.resolve().then(c.bind(c,56629)),Promise.resolve().then(c.bind(c,11861)),Promise.resolve().then(c.bind(c,25869)),Promise.resolve().then(c.bind(c,26917)),Promise.resolve().then(c.bind(c,29133)),Promise.resolve().then(c.bind(c,40797)),Promise.resolve().then(c.bind(c,80709)),Promise.resolve().then(c.bind(c,71373)),Promise.resolve().then(c.bind(c,95687)),Promise.resolve().then(c.bind(c,52229)),Promise.resolve().then(c.bind(c,13889)),Promise.resolve().then(c.bind(c,81049)),Promise.resolve().then(c.bind(c,91721)),Promise.resolve().then(c.bind(c,43873)),Promise.resolve().then(c.bind(c,24341)),Promise.resolve().then(c.bind(c,27661)),Promise.resolve().then(c.bind(c,40051)),Promise.resolve().then(c.bind(c,29723)),Promise.resolve().then(c.bind(c,58173)),Promise.resolve().then(c.bind(c,64589)),Promise.resolve().then(c.bind(c,51219)),Promise.resolve().then(c.bind(c,19661)),Promise.resolve().then(c.bind(c,97358)),Promise.resolve().then(c.bind(c,40389)),Promise.resolve().then(c.bind(c,97101)),Promise.resolve().then(c.bind(c,165)),Promise.resolve().then(c.bind(c,55199)),Promise.resolve().then(c.bind(c,52889)),Promise.resolve().then(c.bind(c,1161)),Promise.resolve().then(c.bind(c,79221)),Promise.resolve().then(c.bind(c,35549)),Promise.resolve().then(c.bind(c,2901)),Promise.resolve().then(c.bind(c,11245)),Promise.resolve().then(c.bind(c,82503)),Promise.resolve().then(c.bind(c,98113)),Promise.resolve().then(c.bind(c,58975)),Promise.resolve().then(c.bind(c,89887)),Promise.resolve().then(c.bind(c,39437)),Promise.resolve().then(c.bind(c,3709)),Promise.resolve().then(c.bind(c,21591)),Promise.resolve().then(c.bind(c,69925)),Promise.resolve().then(c.bind(c,65137)),Promise.resolve().then(c.bind(c,96365)),Promise.resolve().then(c.bind(c,22613)),Promise.resolve().then(c.bind(c,82273)),Promise.resolve().then(c.bind(c,58217)),Promise.resolve().then(c.bind(c,8043)),Promise.resolve().then(c.bind(c,91501)),Promise.resolve().then(c.bind(c,84959)),Promise.resolve().then(c.bind(c,47261)),Promise.resolve().then(c.bind(c,34537)),Promise.resolve().then(c.bind(c,43477)),Promise.resolve().then(c.bind(c,14321)),Promise.resolve().then(c.bind(c,74445)),Promise.resolve().then(c.bind(c,15391)),Promise.resolve().then(c.bind(c,6479)),Promise.resolve().then(c.bind(c,77097)),Promise.resolve().then(c.bind(c,31821)),Promise.resolve().then(c.bind(c,81469)),Promise.resolve().then(c.bind(c,3453)),Promise.resolve().then(c.bind(c,87967)),Promise.resolve().then(c.bind(c,45137)),Promise.resolve().then(c.bind(c,13415)),Promise.resolve().then(c.bind(c,76667)),Promise.resolve().then(c.bind(c,60377)),Promise.resolve().then(c.bind(c,32793)),Promise.resolve().then(c.bind(c,86605)),Promise.resolve().then(c.bind(c,32491)),Promise.resolve().then(c.bind(c,83565)),Promise.resolve().then(c.bind(c,98061)),Promise.resolve().then(c.bind(c,62293)),Promise.resolve().then(c.bind(c,51885)),Promise.resolve().then(c.bind(c,85993)),Promise.resolve().then(c.bind(c,96439)),Promise.resolve().then(c.bind(c,10723)),Promise.resolve().then(c.bind(c,33287)),Promise.resolve().then(c.bind(c,5123)),Promise.resolve().then(c.bind(c,18443)),Promise.resolve().then(c.bind(c,19191)),Promise.resolve().then(c.bind(c,83103))},54670:(a,b,c)=>{"use strict";c.d(b,{theme:()=>d});let d=(0,c(25459).registerClientReference)(function(){throw Error("Attempted to call theme() from the server but theme is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/david/Projects/medplum/examples/medplum-nextjs-demo/app/theme.ts","theme")},56035:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>j,metadata:()=>i});var d=c(5939),e=c(94072),f=c(34384),g=c(57861),h=c(54670);let i={title:"Medplum Next.js Demo",icons:{icon:"/favicon.svg"}};function j(a){let{children:b}=a;return(0,d.jsxs)("html",{lang:"en",children:[(0,d.jsxs)("head",{children:[(0,d.jsx)(e.ColorSchemeScript,{}),(0,d.jsx)("link",{rel:"shortcut icon",href:"/favicon.svg"}),(0,d.jsx)("meta",{name:"viewport",content:"minimum-scale=1, initial-scale=1, width=device-width, user-scalable=no"})]}),(0,d.jsx)("body",{children:(0,d.jsx)(f.MantineProvider,{theme:h.theme,children:(0,d.jsx)(g.default,{children:b})})})]})}},57861:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(25459).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/david/Projects/medplum/examples/medplum-nextjs-demo/app/root.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/david/Projects/medplum/examples/medplum-nextjs-demo/app/root.tsx","default")},61197:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,58671,23)),Promise.resolve().then(c.t.bind(c,56542,23)),Promise.resolve().then(c.t.bind(c,88248,23)),Promise.resolve().then(c.t.bind(c,49743,23)),Promise.resolve().then(c.t.bind(c,96231,23)),Promise.resolve().then(c.t.bind(c,10959,23)),Promise.resolve().then(c.t.bind(c,72041,23)),Promise.resolve().then(c.t.bind(c,95094,23)),Promise.resolve().then(c.t.bind(c,67487,23))},66553:()=>{},68575:(a,b,c)=>{"use strict";c.d(b,{default:()=>h});var d=c(78157);c(16070);var e=c(10128),f=c(2792);c(66553);let g=new e.SQA({onUnauthenticated:()=>window.location.href="/",fetch:(a,b)=>fetch(a,b),cacheTime:1e4});function h(a){return(0,d.jsx)(f.OpF,{medplum:g,children:a.children})}},85546:(a,b,c)=>{Promise.resolve().then(c.bind(c,68575)),Promise.resolve().then(c.bind(c,97740)),Promise.resolve().then(c.bind(c,54391)),Promise.resolve().then(c.bind(c,34776)),Promise.resolve().then(c.bind(c,17872)),Promise.resolve().then(c.bind(c,82664)),Promise.resolve().then(c.bind(c,10570)),Promise.resolve().then(c.bind(c,35423)),Promise.resolve().then(c.bind(c,32679)),Promise.resolve().then(c.bind(c,96367)),Promise.resolve().then(c.bind(c,58620)),Promise.resolve().then(c.bind(c,54569)),Promise.resolve().then(c.bind(c,37353)),Promise.resolve().then(c.bind(c,59394)),Promise.resolve().then(c.bind(c,64898)),Promise.resolve().then(c.bind(c,18751)),Promise.resolve().then(c.bind(c,99953)),Promise.resolve().then(c.bind(c,38633)),Promise.resolve().then(c.bind(c,37337)),Promise.resolve().then(c.bind(c,43263)),Promise.resolve().then(c.bind(c,64603)),Promise.resolve().then(c.bind(c,22051)),Promise.resolve().then(c.bind(c,57333)),Promise.resolve().then(c.bind(c,68816)),Promise.resolve().then(c.bind(c,67821)),Promise.resolve().then(c.bind(c,50889)),Promise.resolve().then(c.bind(c,87564)),Promise.resolve().then(c.bind(c,94997)),Promise.resolve().then(c.bind(c,41792)),Promise.resolve().then(c.bind(c,27141)),Promise.resolve().then(c.bind(c,30825)),Promise.resolve().then(c.bind(c,60614)),Promise.resolve().then(c.bind(c,80716)),Promise.resolve().then(c.bind(c,60809)),Promise.resolve().then(c.bind(c,46076)),Promise.resolve().then(c.bind(c,10524)),Promise.resolve().then(c.bind(c,31954)),Promise.resolve().then(c.bind(c,63430)),Promise.resolve().then(c.bind(c,74690)),Promise.resolve().then(c.bind(c,24275)),Promise.resolve().then(c.bind(c,2297)),Promise.resolve().then(c.bind(c,75149)),Promise.resolve().then(c.bind(c,67447)),Promise.resolve().then(c.bind(c,16606)),Promise.resolve().then(c.bind(c,28504)),Promise.resolve().then(c.bind(c,13967)),Promise.resolve().then(c.bind(c,26376)),Promise.resolve().then(c.bind(c,59197)),Promise.resolve().then(c.bind(c,34934)),Promise.resolve().then(c.bind(c,54202)),Promise.resolve().then(c.bind(c,82321)),Promise.resolve().then(c.bind(c,1393)),Promise.resolve().then(c.bind(c,55081)),Promise.resolve().then(c.bind(c,32974)),Promise.resolve().then(c.bind(c,12545)),Promise.resolve().then(c.bind(c,69527)),Promise.resolve().then(c.bind(c,61863)),Promise.resolve().then(c.bind(c,25019)),Promise.resolve().then(c.bind(c,49891)),Promise.resolve().then(c.bind(c,12565)),Promise.resolve().then(c.bind(c,18587)),Promise.resolve().then(c.bind(c,13615)),Promise.resolve().then(c.bind(c,24387)),Promise.resolve().then(c.bind(c,53089)),Promise.resolve().then(c.bind(c,32287)),Promise.resolve().then(c.bind(c,16845)),Promise.resolve().then(c.bind(c,75227)),Promise.resolve().then(c.bind(c,53741)),Promise.resolve().then(c.bind(c,92419)),Promise.resolve().then(c.bind(c,75843)),Promise.resolve().then(c.bind(c,99285)),Promise.resolve().then(c.bind(c,18681)),Promise.resolve().then(c.bind(c,60955)),Promise.resolve().then(c.bind(c,48647)),Promise.resolve().then(c.bind(c,74365)),Promise.resolve().then(c.bind(c,2645)),Promise.resolve().then(c.bind(c,82799)),Promise.resolve().then(c.bind(c,24657)),Promise.resolve().then(c.bind(c,2204)),Promise.resolve().then(c.bind(c,49682)),Promise.resolve().then(c.bind(c,68591)),Promise.resolve().then(c.bind(c,163)),Promise.resolve().then(c.bind(c,79635)),Promise.resolve().then(c.bind(c,21935)),Promise.resolve().then(c.bind(c,66039)),Promise.resolve().then(c.bind(c,65669)),Promise.resolve().then(c.bind(c,49226)),Promise.resolve().then(c.bind(c,54676)),Promise.resolve().then(c.bind(c,11785)),Promise.resolve().then(c.bind(c,93379)),Promise.resolve().then(c.bind(c,97541)),Promise.resolve().then(c.bind(c,92535)),Promise.resolve().then(c.bind(c,68505)),Promise.resolve().then(c.bind(c,22757)),Promise.resolve().then(c.bind(c,53783)),Promise.resolve().then(c.bind(c,7246)),Promise.resolve().then(c.bind(c,8009)),Promise.resolve().then(c.bind(c,53727)),Promise.resolve().then(c.bind(c,40799)),Promise.resolve().then(c.bind(c,80153)),Promise.resolve().then(c.bind(c,14412)),Promise.resolve().then(c.bind(c,60691)),Promise.resolve().then(c.bind(c,93127)),Promise.resolve().then(c.bind(c,54837)),Promise.resolve().then(c.bind(c,21634)),Promise.resolve().then(c.bind(c,67950)),Promise.resolve().then(c.bind(c,45438)),Promise.resolve().then(c.bind(c,28706)),Promise.resolve().then(c.bind(c,20709)),Promise.resolve().then(c.bind(c,44600)),Promise.resolve().then(c.bind(c,25958)),Promise.resolve().then(c.bind(c,91320)),Promise.resolve().then(c.bind(c,62232)),Promise.resolve().then(c.bind(c,78928)),Promise.resolve().then(c.bind(c,73654)),Promise.resolve().then(c.bind(c,73715)),Promise.resolve().then(c.bind(c,77195)),Promise.resolve().then(c.bind(c,26452)),Promise.resolve().then(c.bind(c,85027)),Promise.resolve().then(c.bind(c,70532)),Promise.resolve().then(c.bind(c,12921)),Promise.resolve().then(c.bind(c,10373)),Promise.resolve().then(c.bind(c,74834)),Promise.resolve().then(c.bind(c,41547)),Promise.resolve().then(c.bind(c,50645)),Promise.resolve().then(c.bind(c,91539)),Promise.resolve().then(c.bind(c,12735)),Promise.resolve().then(c.bind(c,61339)),Promise.resolve().then(c.bind(c,5381)),Promise.resolve().then(c.bind(c,24357)),Promise.resolve().then(c.bind(c,85527)),Promise.resolve().then(c.bind(c,53247)),Promise.resolve().then(c.bind(c,85483)),Promise.resolve().then(c.bind(c,22027)),Promise.resolve().then(c.bind(c,27343)),Promise.resolve().then(c.bind(c,83957)),Promise.resolve().then(c.bind(c,16619)),Promise.resolve().then(c.bind(c,82243)),Promise.resolve().then(c.bind(c,73561)),Promise.resolve().then(c.bind(c,7486)),Promise.resolve().then(c.bind(c,26360)),Promise.resolve().then(c.bind(c,66877)),Promise.resolve().then(c.bind(c,5047)),Promise.resolve().then(c.bind(c,58369)),Promise.resolve().then(c.bind(c,50251)),Promise.resolve().then(c.bind(c,23323)),Promise.resolve().then(c.bind(c,71086)),Promise.resolve().then(c.bind(c,32836)),Promise.resolve().then(c.bind(c,98213)),Promise.resolve().then(c.bind(c,6858)),Promise.resolve().then(c.bind(c,96628)),Promise.resolve().then(c.bind(c,18592)),Promise.resolve().then(c.bind(c,15993)),Promise.resolve().then(c.bind(c,43128)),Promise.resolve().then(c.bind(c,72960)),Promise.resolve().then(c.bind(c,78079)),Promise.resolve().then(c.bind(c,16168)),Promise.resolve().then(c.bind(c,51494)),Promise.resolve().then(c.bind(c,21315)),Promise.resolve().then(c.bind(c,47764)),Promise.resolve().then(c.bind(c,59109)),Promise.resolve().then(c.bind(c,18861)),Promise.resolve().then(c.bind(c,85302)),Promise.resolve().then(c.bind(c,80744)),Promise.resolve().then(c.bind(c,47754)),Promise.resolve().then(c.bind(c,93978)),Promise.resolve().then(c.bind(c,11212)),Promise.resolve().then(c.bind(c,79809)),Promise.resolve().then(c.bind(c,44731)),Promise.resolve().then(c.bind(c,52871)),Promise.resolve().then(c.bind(c,61115)),Promise.resolve().then(c.bind(c,55537)),Promise.resolve().then(c.bind(c,73310)),Promise.resolve().then(c.bind(c,15796)),Promise.resolve().then(c.bind(c,59013)),Promise.resolve().then(c.bind(c,77645)),Promise.resolve().then(c.bind(c,48405)),Promise.resolve().then(c.bind(c,79757)),Promise.resolve().then(c.bind(c,11341)),Promise.resolve().then(c.bind(c,47855)),Promise.resolve().then(c.bind(c,14019)),Promise.resolve().then(c.bind(c,88403)),Promise.resolve().then(c.bind(c,64999)),Promise.resolve().then(c.bind(c,47499)),Promise.resolve().then(c.bind(c,36492)),Promise.resolve().then(c.bind(c,65852)),Promise.resolve().then(c.bind(c,45189)),Promise.resolve().then(c.bind(c,17644)),Promise.resolve().then(c.bind(c,52168)),Promise.resolve().then(c.bind(c,99977)),Promise.resolve().then(c.bind(c,265)),Promise.resolve().then(c.bind(c,99019)),Promise.resolve().then(c.bind(c,68408)),Promise.resolve().then(c.bind(c,48273)),Promise.resolve().then(c.bind(c,45320)),Promise.resolve().then(c.bind(c,35939)),Promise.resolve().then(c.bind(c,58741)),Promise.resolve().then(c.bind(c,78533)),Promise.resolve().then(c.bind(c,86501)),Promise.resolve().then(c.bind(c,98151)),Promise.resolve().then(c.bind(c,77680)),Promise.resolve().then(c.bind(c,56774)),Promise.resolve().then(c.bind(c,86175)),Promise.resolve().then(c.bind(c,16115)),Promise.resolve().then(c.bind(c,70701)),Promise.resolve().then(c.bind(c,48200)),Promise.resolve().then(c.bind(c,52958)),Promise.resolve().then(c.bind(c,35019)),Promise.resolve().then(c.bind(c,49575)),Promise.resolve().then(c.bind(c,80565)),Promise.resolve().then(c.bind(c,61449)),Promise.resolve().then(c.bind(c,41541)),Promise.resolve().then(c.bind(c,19852)),Promise.resolve().then(c.bind(c,61982)),Promise.resolve().then(c.bind(c,64086)),Promise.resolve().then(c.bind(c,77926)),Promise.resolve().then(c.bind(c,85600)),Promise.resolve().then(c.bind(c,71387)),Promise.resolve().then(c.bind(c,53475)),Promise.resolve().then(c.bind(c,94796)),Promise.resolve().then(c.bind(c,14679)),Promise.resolve().then(c.bind(c,84129)),Promise.resolve().then(c.bind(c,26939)),Promise.resolve().then(c.bind(c,66588)),Promise.resolve().then(c.bind(c,9544)),Promise.resolve().then(c.bind(c,25497)),Promise.resolve().then(c.bind(c,92947)),Promise.resolve().then(c.bind(c,18004)),Promise.resolve().then(c.bind(c,43494)),Promise.resolve().then(c.bind(c,75204)),Promise.resolve().then(c.bind(c,72306)),Promise.resolve().then(c.bind(c,11648)),Promise.resolve().then(c.bind(c,91092)),Promise.resolve().then(c.bind(c,4851)),Promise.resolve().then(c.bind(c,62317)),Promise.resolve().then(c.bind(c,87226)),Promise.resolve().then(c.bind(c,86846)),Promise.resolve().then(c.bind(c,40739)),Promise.resolve().then(c.bind(c,62911)),Promise.resolve().then(c.bind(c,36937)),Promise.resolve().then(c.bind(c,53044)),Promise.resolve().then(c.bind(c,92858)),Promise.resolve().then(c.bind(c,55250)),Promise.resolve().then(c.bind(c,1617)),Promise.resolve().then(c.bind(c,25966)),Promise.resolve().then(c.bind(c,36549)),Promise.resolve().then(c.bind(c,57834)),Promise.resolve().then(c.bind(c,82322)),Promise.resolve().then(c.bind(c,5094)),Promise.resolve().then(c.bind(c,534)),Promise.resolve().then(c.bind(c,33194)),Promise.resolve().then(c.bind(c,95894)),Promise.resolve().then(c.bind(c,36994)),Promise.resolve().then(c.bind(c,2303)),Promise.resolve().then(c.bind(c,75289)),Promise.resolve().then(c.bind(c,11782)),Promise.resolve().then(c.bind(c,32011)),Promise.resolve().then(c.bind(c,88246)),Promise.resolve().then(c.bind(c,42377)),Promise.resolve().then(c.bind(c,52548)),Promise.resolve().then(c.bind(c,30134)),Promise.resolve().then(c.bind(c,58931)),Promise.resolve().then(c.bind(c,23556)),Promise.resolve().then(c.bind(c,77118)),Promise.resolve().then(c.bind(c,77597)),Promise.resolve().then(c.bind(c,19608)),Promise.resolve().then(c.bind(c,1339)),Promise.resolve().then(c.bind(c,35446)),Promise.resolve().then(c.bind(c,91662)),Promise.resolve().then(c.bind(c,19786)),Promise.resolve().then(c.bind(c,58460)),Promise.resolve().then(c.bind(c,42225)),Promise.resolve().then(c.bind(c,34103)),Promise.resolve().then(c.bind(c,81338)),Promise.resolve().then(c.bind(c,30711)),Promise.resolve().then(c.bind(c,53876)),Promise.resolve().then(c.bind(c,37364)),Promise.resolve().then(c.bind(c,94834)),Promise.resolve().then(c.bind(c,5644)),Promise.resolve().then(c.bind(c,9880)),Promise.resolve().then(c.bind(c,55152)),Promise.resolve().then(c.bind(c,98362)),Promise.resolve().then(c.bind(c,34228)),Promise.resolve().then(c.bind(c,50336)),Promise.resolve().then(c.bind(c,41112)),Promise.resolve().then(c.bind(c,73842)),Promise.resolve().then(c.bind(c,2782)),Promise.resolve().then(c.bind(c,33244)),Promise.resolve().then(c.bind(c,1732)),Promise.resolve().then(c.bind(c,98172)),Promise.resolve().then(c.bind(c,96966)),Promise.resolve().then(c.bind(c,60624)),Promise.resolve().then(c.bind(c,14138)),Promise.resolve().then(c.bind(c,9216)),Promise.resolve().then(c.bind(c,40676)),Promise.resolve().then(c.bind(c,79530)),Promise.resolve().then(c.bind(c,74898)),Promise.resolve().then(c.bind(c,82004)),Promise.resolve().then(c.bind(c,33098)),Promise.resolve().then(c.bind(c,54348)),Promise.resolve().then(c.bind(c,89114)),Promise.resolve().then(c.bind(c,99367)),Promise.resolve().then(c.bind(c,89267)),Promise.resolve().then(c.bind(c,36487)),Promise.resolve().then(c.bind(c,78827)),Promise.resolve().then(c.bind(c,52611)),Promise.resolve().then(c.bind(c,18243)),Promise.resolve().then(c.bind(c,20107)),Promise.resolve().then(c.bind(c,14819)),Promise.resolve().then(c.bind(c,65947)),Promise.resolve().then(c.bind(c,63043)),Promise.resolve().then(c.bind(c,52851)),Promise.resolve().then(c.bind(c,74461)),Promise.resolve().then(c.bind(c,54011)),Promise.resolve().then(c.bind(c,57879)),Promise.resolve().then(c.bind(c,94743)),Promise.resolve().then(c.bind(c,40223)),Promise.resolve().then(c.bind(c,66399)),Promise.resolve().then(c.bind(c,94147)),Promise.resolve().then(c.bind(c,43555)),Promise.resolve().then(c.bind(c,59268)),Promise.resolve().then(c.bind(c,36017)),Promise.resolve().then(c.bind(c,67955)),Promise.resolve().then(c.bind(c,32579)),Promise.resolve().then(c.bind(c,60161)),Promise.resolve().then(c.bind(c,66339)),Promise.resolve().then(c.bind(c,41544)),Promise.resolve().then(c.bind(c,88603)),Promise.resolve().then(c.bind(c,18507)),Promise.resolve().then(c.bind(c,67245)),Promise.resolve().then(c.bind(c,19437)),Promise.resolve().then(c.bind(c,54623)),Promise.resolve().then(c.bind(c,58951)),Promise.resolve().then(c.bind(c,36179)),Promise.resolve().then(c.bind(c,74083)),Promise.resolve().then(c.bind(c,75883)),Promise.resolve().then(c.bind(c,27651)),Promise.resolve().then(c.bind(c,51957)),Promise.resolve().then(c.bind(c,64372)),Promise.resolve().then(c.bind(c,35709)),Promise.resolve().then(c.bind(c,30389)),Promise.resolve().then(c.bind(c,10643)),Promise.resolve().then(c.bind(c,51211)),Promise.resolve().then(c.bind(c,7093)),Promise.resolve().then(c.bind(c,92795)),Promise.resolve().then(c.bind(c,29991)),Promise.resolve().then(c.bind(c,37635)),Promise.resolve().then(c.bind(c,58947)),Promise.resolve().then(c.bind(c,47303)),Promise.resolve().then(c.bind(c,21023)),Promise.resolve().then(c.bind(c,78897)),Promise.resolve().then(c.bind(c,25851)),Promise.resolve().then(c.bind(c,36005)),Promise.resolve().then(c.bind(c,72611)),Promise.resolve().then(c.bind(c,91903)),Promise.resolve().then(c.bind(c,99739)),Promise.resolve().then(c.bind(c,76295)),Promise.resolve().then(c.bind(c,67811)),Promise.resolve().then(c.bind(c,96421)),Promise.resolve().then(c.bind(c,50029)),Promise.resolve().then(c.bind(c,85671)),Promise.resolve().then(c.bind(c,39323)),Promise.resolve().then(c.bind(c,22787)),Promise.resolve().then(c.bind(c,19883)),Promise.resolve().then(c.bind(c,99269)),Promise.resolve().then(c.bind(c,42415)),Promise.resolve().then(c.bind(c,93477)),Promise.resolve().then(c.bind(c,74937)),Promise.resolve().then(c.bind(c,84407)),Promise.resolve().then(c.bind(c,56431)),Promise.resolve().then(c.bind(c,2819)),Promise.resolve().then(c.bind(c,9105)),Promise.resolve().then(c.bind(c,24739)),Promise.resolve().then(c.bind(c,90627)),Promise.resolve().then(c.bind(c,29131)),Promise.resolve().then(c.bind(c,99291)),Promise.resolve().then(c.bind(c,58639)),Promise.resolve().then(c.bind(c,3285)),Promise.resolve().then(c.bind(c,78265)),Promise.resolve().then(c.bind(c,86997)),Promise.resolve().then(c.bind(c,39377)),Promise.resolve().then(c.bind(c,90849)),Promise.resolve().then(c.bind(c,56109)),Promise.resolve().then(c.bind(c,63293))},97740:(a,b,c)=>{"use strict";c.d(b,{theme:()=>d});let d=(0,c(796).a)({})}};