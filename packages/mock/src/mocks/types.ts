import { SearchParameter } from '@medplum/fhirtypes';
import StructureDefinitionList from './structuredefinitions.json';

export const PatientSearchParameters: SearchParameter[] = [
  {
    resourceType: 'SearchParameter',
    id: 'Patient-name',
    base: ['Patient'],
    code: 'name',
    name: 'name',
    type: 'string',
    expression: 'Patient.name',
  },
  {
    resourceType: 'SearchParameter',
    id: 'Patient-birthdate',
    base: ['Patient'],
    code: 'birthdate',
    name: 'birthdate',
    type: 'date',
    expression: 'Patient.birthDate',
  },
  {
    resourceType: 'SearchParameter',
    id: 'Patient-organization',
    base: ['Patient'],
    code: 'organization',
    name: 'organization',
    type: 'reference',
    expression: 'Patient.managingOrganization',
    target: ['Organization'],
  },
  {
    resourceType: 'SearchParameter',
    id: 'Patient-active',
    base: ['Patient'],
    code: 'active',
    name: 'active',
    type: 'token',
    expression: 'Patient.active',
  },
  {
    resourceType: 'SearchParameter',
    id: 'individual-telecom',
    base: ['Patient', 'Practitioner'],
    code: 'telecom',
    name: 'telecom',
    type: 'token',
    expression: 'Patient.telecom | Practitioner.telecom',
  },
  {
    resourceType: 'SearchParameter',
    id: 'individual-email',
    base: ['Patient', 'Practitioner'],
    code: 'email',
    name: 'email',
    type: 'token',
    expression: "Patient.telecom.where(system='email') | Practitioner.telecom.where(system='email')",
  },
  {
    resourceType: 'SearchParameter',
    id: 'individual-phone',
    base: ['Patient', 'Practitioner'],
    code: 'phone',
    name: 'phone',
    type: 'token',
    expression: "Patient.telecom.where(system='phone') | Practitioner.telecom.where(system='phone')",
  },
  {
    resourceType: 'SearchParameter',
    id: 'individual-address-city',
    base: ['Patient', 'Practitioner'],
    code: 'address-city',
    name: 'address-city',
    type: 'string',
    expression: 'Patient.address.city | Practitioner.address.city',
  },
  {
    resourceType: 'SearchParameter',
    id: 'individual-address-state',
    base: ['Patient', 'Practitioner'],
    code: 'address-state',
    name: 'address-state',
    type: 'token',
    expression: 'Patient.address.state | Practitioner.address.state',
  },
  {
    resourceType: 'SearchParameter',
    id: 'ServiceRequest-subject',
    code: 'subject',
    base: ['ServiceRequest'],
    type: 'reference',
    expression: 'ServiceRequest.subject',
    target: ['Group', 'Device', 'Patient', 'Location'],
  },
  {
    resourceType: 'SearchParameter',
    id: 'ServiceRequest-authored',
    code: 'authored',
    base: ['ServiceRequest'],
    type: 'date',
    expression: 'ServiceRequest.authoredOn',
  },
  {
    resourceType: 'SearchParameter',
    id: 'Observation-value-quantity',
    code: 'value-quantity',
    base: ['Observation'],
    type: 'quantity',
    expression: '(Observation.value as Quantity) | (Observation.value as SampledData)',
  },
  {
    resourceType: 'SearchParameter',
    id: 'Encounter-length',
    code: 'length',
    base: ['Encounter'],
    type: 'quantity',
    expression: 'Encounter.length',
  },
];

export const GraphQLSchemaResponse = {
  data: {
    StructureDefinitionList,
    SearchParameterList: [...PatientSearchParameters],
  },
};
